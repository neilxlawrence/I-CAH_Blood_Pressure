
summary statistics

```{r, load packages}
rm(list = ls())

#we first establish the location of the working directory where we keep everything, depending on whether it exists (i.e. which computer we are using)
#check C drive
if(file.exists("C:/Users/User/Documents/NRL_R_work/iCAH_Blood_pressure")){
location_of_main_folder <-
  "C:/Users/User/Documents/NRL_R_work/iCAH_Blood_pressure"
}
#take the working directory otherwise, which should work every time?
if(!exists("location_of_main_folder")){
  location_of_main_folder <- 
    getwd()
}
#paste the name of our functions folder into the path name
location_of_functions_folder <-
  paste0(location_of_main_folder, "/bp_functions_folder/")

#load the function that loads all the libraries and sources
source(paste0(location_of_functions_folder, "load_bp_libraries_and_sources_function.R"))

#paste together the location of the data files - we don't load in the first file, but we need this location for the end
location_of_data_files <-
  paste0(location_of_main_folder, "/bp_data_files_to_load/")

#run the function, pointing it towards the functions folder
load_bp_libraries_and_sources_function(
  location_of_functions_folder=location_of_functions_folder,
  location_of_data_files=location_of_data_files
)

load_bp_files_function(previous_file_name = "file_21",
  parent_directory = location_of_data_files,
  list_of_data_frames_to_load=list("number_of_imputations")
)

load_bp_files_function(previous_file_name = "file_22",
  parent_directory = location_of_data_files,
  list_of_data_frames_to_load=list("bp_data")
)


```

```{r, create a folder to save into}
dir.create("summary_statistics")
```

```{r, assess types of cah}
print("Type of CAH is incredibly poorly completed, and our analysis does include six patients defined as non-classic")
freq(bp_data$type_of_cah)
```


##############################################
Define whether blood pressure is above a particular centile for Jeremy
##############################################

Jeremy wants proportion "hypertensive", which to me is >95th centile, but want to create this as code where you can change the perecentile of interest.
We need to loop around every centile to create a column that is binary as to whether the reading is above that centile

```{r, define a blood pressure centile threshold and create binary columns with each imputation to help define proportion of patients hypertensive}
centile_threshold <- 95

#run through each imputation doing a binary column for both systolic and diastolic that are over threshold

for (imputation_number in 0:number_of_imputations){
  
  #establish the systolic imputation column we are using to create a binary threshold column
  column_name <- 
    paste0("systolic_imp_centile_", imputation_number)

  #name our binary threshold column for systolic
  new_column_name <- 
    paste0("systolic_imp_centile_above_", 
           centile_threshold, 
           "th_", 
           imputation_number)
  
  #populate a new column with the new systolic column name and the binary threshold calculation
  bp_data[,new_column_name] <-
    ifelse(bp_data[,column_name][[1]]>0.99, 1, 0)
  
  #now we do the same again for this imputation but for diastolic
  #establish the diastolic imputation column we are using to create a binary threshold column
  column_name <- 
    paste0("diastolic_imp_centile_", imputation_number)

  #name our binary threshold column for diastolic
  new_column_name <- 
    paste0("diastolic_imp_centile_above_", 
           centile_threshold, 
           "th_", 
           imputation_number)
  
  #populate a new column with the new diastolic column name and the binary threshold calculation
  bp_data[,new_column_name] <-
    ifelse(bp_data[,column_name][[1]]>0.99, 1, 0)
}
```



##############################################
Define sample population by age and separate categories to calculate (i.e. sex)
##############################################

```{r, establish who we are describing by taking those under twenty and under five}
#there is no use describing the whole data set
bp_data_under_twenty <- 
  subset(bp_data, age_to_use < 20)
bp_data_under_five <- 
  subset(bp_data, age_to_use < 5)
bp_data_five_to_twenty <- 
  subset(bp_data, age_to_use > 5 & age_to_use < 20)
```

```{r, separate those under twenty and under five and five to twenty by sex}
#we want to describe by sex so we need to separate also
freq(bp_data_under_twenty$Sex.at.birth...Birth)
freq(bp_data_under_five$Sex.at.birth...Birth)
freq(bp_data_five_to_twenty$Sex.at.birth...Birth)

bp_data_under_twenty_fema <-
  subset(bp_data_under_twenty, Sex.at.birth...Birth == "Female")
bp_data_under_five_fema <-
  subset(bp_data_under_five, Sex.at.birth...Birth == "Female")
bp_data_five_to_twenty_fema <-
  subset(bp_data_five_to_twenty, Sex.at.birth...Birth == "Female")

bp_data_under_twenty_male <-
  subset(bp_data_under_twenty, Sex.at.birth...Birth == "Male")
bp_data_under_five_male <-
  subset(bp_data_under_five, Sex.at.birth...Birth == "Male")
bp_data_five_to_twenty_male <-
  subset(bp_data_five_to_twenty, Sex.at.birth...Birth == "Male")

bp_data_under_twenty_not_assigned <-
  subset(bp_data_under_twenty, Sex.at.birth...Birth == "Not assigned")
bp_data_under_five_not_assigned <-
  subset(bp_data_under_five, Sex.at.birth...Birth == "Not assigned")
bp_data_five_to_twenty_not_assigned <-
  subset(bp_data_five_to_twenty, Sex.at.birth...Birth == "Not assigned")

cat("Check we're no losing anyone - this should be zero:\n")
nrow(bp_data_under_twenty) - 
  nrow(bp_data_under_twenty_fema) - 
  nrow(bp_data_under_twenty_male) - 
  nrow(bp_data_under_twenty_not_assigned)

nrow(bp_data_under_five) - 
  nrow(bp_data_under_five_fema) - 
  nrow(bp_data_under_five_male) - 
  nrow(bp_data_under_five_not_assigned)

nrow(bp_data_five_to_twenty) - 
  nrow(bp_data_five_to_twenty_fema) - 
  nrow(bp_data_five_to_twenty_male) - 
  nrow(bp_data_five_to_twenty_not_assigned)

```


##############################################
Number of countries summary statistics
##############################################

```{r, describe number of centres}
cat("Number of countries for all patients is:\n")
length(unique(bp_data_under_twenty$Country...Centre))

cat("Provided this number is zero indicating there are no missing country names:\n")
sum(is.na(bp_data_under_twenty$Country...Centre))


cat("Number of countries for Male patients is:\n")
length(unique(bp_data_under_twenty_male$Country...Centre))

cat("Number of countries for Female patients is:\n")
length(unique(bp_data_under_twenty_fema$Country...Centre))

cat("Number of countries for Sex 'Not assigned' patients is:\n")
length(unique(bp_data_under_twenty_not_assigned$Country...Centre))
```

##############################################
Number of centres summary statistics
##############################################

```{r, describe number of centres}
cat("Number of centres for all patients is:\n")
length(unique(bp_data_under_twenty$Centre.Name...Centre))

cat("Provided this number is zero indicating there are no missing centre names:\n")
sum(is.na(bp_data_under_twenty$Centre.Name...Centre))


cat("Number of centres for Male patients is:\n")
length(unique(bp_data_under_twenty_male$Centre.Name...Centre))

cat("Number of centres for Female patients is:\n")
length(unique(bp_data_under_twenty_fema$Centre.Name...Centre))

cat("Number of centres for Sex 'Not assigned' patients is:\n")
length(unique(bp_data_under_twenty_not_assigned$Centre.Name...Centre))
```

##############################################
Number of patients and visits summary statistics
##############################################

```{r, describe number of patients and number of visits}
cat("Number of all visits in this set including visits with perpetuating missing data:\n")
(nrow(bp_data_under_twenty))
cat("Comprising this many patients:\n")
length(unique(bp_data_under_twenty$id))
cat("Provided this number is zero indicating there are no missing ids:\n")
sum(is.na(bp_data_under_twenty$id))

cat("\n")

cat("Number of visits for Male patients is:\n")
nrow(bp_data_under_twenty_male)
cat("Comprising this many Male patients:\n")
length(unique(bp_data_under_twenty_male$id))

cat("\n")

cat("Number of visits for Female patients is:\n")
nrow(bp_data_under_twenty_fema)
cat("Comprising this many Female patients:\n")
length(unique(bp_data_under_twenty_fema$id))

cat("\n")

cat("Number of visits for Sex 'Not assigned' patients is:\n")
nrow(bp_data_under_twenty_not_assigned)
cat("Comprising this many patients not assigned a sex at birth:\n")
length(unique(bp_data_under_twenty_not_assigned$id))
```
```{r, summarise age at visit for main text}
cat("Simple description of age at visit in data set of visits under 20 years of age")
cat(paste0("Median ",
           round(median(bp_data_under_twenty$age_to_use), digits=2),
           " Q1:",
           round(as.numeric(quantile(bp_data_under_twenty$age_to_use, na.rm=T, 0.25)), digits=2),
           " Q3:",
           round(as.numeric(quantile(bp_data_under_twenty$age_to_use, na.rm=T, 0.75)), digits=2)))

descr(bp_data_under_twenty$age_to_use)
```


```{r, summarise aspects of each id to facilitate reporting within patient variability ie average number of patients per visit}
#to be able to report things like number of visits per patient, we must first summarise our frames by grouping within id
bp_data_under_twenty_summary_by_id <-
  bp_data_under_twenty %>%
  group_by(id) %>%
  dplyr::summarise(
    number_of_visits = length(id),
    minimum_age_at_visit = min(age_to_use),
    maximum_age_at_visit = max(age_to_use),
    age_range_of_visits = maximum_age_at_visit - minimum_age_at_visit
  )

bp_data_under_twenty_male_summary_by_id <-
  bp_data_under_twenty_male %>%
  group_by(id) %>%
  dplyr::summarise(
    number_of_visits = length(id),
    minimum_age_at_visit = min(age_to_use),
    maximum_age_at_visit = max(age_to_use),
    age_range_of_visits = maximum_age_at_visit - minimum_age_at_visit
  )

bp_data_under_twenty_fema_summary_by_id <-
  bp_data_under_twenty_fema %>%
  group_by(id) %>%
  dplyr::summarise(
    number_of_visits = length(id),
    minimum_age_at_visit = min(age_to_use),
    maximum_age_at_visit = max(age_to_use),
    age_range_of_visits = maximum_age_at_visit - minimum_age_at_visit
  )

bp_data_under_twenty_not_assigned_summary_by_id <-
  bp_data_under_twenty_not_assigned %>%
  group_by(id) %>%
  dplyr::summarise(
    number_of_visits = length(id),
    minimum_age_at_visit = min(age_to_use),
    maximum_age_at_visit = max(age_to_use),
    age_range_of_visits = maximum_age_at_visit - minimum_age_at_visit
  )

```

```{r, describe number of visits per patient}
cat("Description of visits by all patients under twenty is:\n")
descr(bp_data_under_twenty_summary_by_id$number_of_visits)

cat("")


cat("Description of visits by patient males under twenty is:\n")
descr(bp_data_under_twenty_male_summary_by_id$number_of_visits)

cat("")


cat("Description of visits by patient females under twenty is:\n")
descr(bp_data_under_twenty_fema_summary_by_id$number_of_visits)

cat("")

cat("Description of visits by patient not assigned sex at birth under twenty is:\n")
descr(bp_data_under_twenty_not_assigned_summary_by_id$number_of_visits)
```

```{r, describe age range of visits per patient}
cat("Description of age_range_of_visits by all patients under twenty is:\n")
descr(bp_data_under_twenty_summary_by_id$age_range_of_visits)

cat("")


cat("Description of age_range_of_visits by patient males under twenty is:\n")
descr(bp_data_under_twenty_male_summary_by_id$age_range_of_visits)

cat("")


cat("Description of age_range_of_visits by patient females under twenty is:\n")
descr(bp_data_under_twenty_fema_summary_by_id$age_range_of_visits)

cat("")

cat("Description of age_range_of_visits by patient not assigned sex at birth under twenty is:\n")
descr(bp_data_under_twenty_not_assigned_summary_by_id$age_range_of_visits)
```

##############################################
Age summary statistics
##############################################

```{r, describe maximum and minimum ages per patient}
cat("Description of minimum and maximum age by all patients under twenty is:\n")
descr(bp_data_under_twenty_summary_by_id$minimum_age_at_visit)
descr(bp_data_under_twenty_summary_by_id$maximum_age_at_visit)

cat("")


cat("Description of minimum and maximum age by patient males under twenty is:\n")
descr(bp_data_under_twenty_male_summary_by_id$minimum_age_at_visit)
descr(bp_data_under_twenty_male_summary_by_id$maximum_age_at_visit)

cat("")


cat("Description of minimum and maximum age by patient females under twenty is:\n")
descr(bp_data_under_twenty_fema_summary_by_id$minimum_age_at_visit)
descr(bp_data_under_twenty_fema_summary_by_id$maximum_age_at_visit)

cat("")

cat("Description of minimum and maximum age by patient not assigned sex at birth under twenty is:\n")
descr(bp_data_under_twenty_not_assigned_summary_by_id$minimum_age_at_visit)
descr(bp_data_under_twenty_not_assigned_summary_by_id$maximum_age_at_visit)
```


##############################################
Height and BMI SDS summary statistics
##############################################

```{r, describe height SDS at visit}
cat("Description of height and BMI SDS in all patients under twenty is:\n")
descr(bp_data_under_twenty$who_z_height_for_age)
descr(bp_data_under_twenty$who_z_bmi_for_age)

cat("")


cat("Description of height and BMI SDS in males under twenty is:\n")
descr(bp_data_under_twenty_male$who_z_height_for_age)
descr(bp_data_under_twenty_male$who_z_bmi_for_age)

cat("")


cat("Description of height and BMI SDS in females under twenty is:\n")
descr(bp_data_under_twenty_fema$who_z_height_for_age)
descr(bp_data_under_twenty_fema$who_z_bmi_for_age)


cat("")

cat("Description of height and BMI SDS in not assigned sex at birth under twenty is:\n")
descr(bp_data_under_twenty_not_assigned$who_z_height_for_age)
descr(bp_data_under_twenty_not_assigned$who_z_bmi_for_age)

```

##############################################
Systolic blood pressure mean and variance statistics
##############################################

```{r, describe systolic blood pressure across all imputations for all patients}
#define decimal places as zero for this one as we're reporting numbers of visits:
visit_decimal_places <- 0
proportion_decimal_places <- 1

cat("Systolic blood pressure in all patients summary statistics from imputed values and original")
#now things get slightly trickier as we have to calculate pooled estimates across our imputations
#create a frame to bind to

means_of_systolic_imputations <- 
  data.frame(systolic_mean = NULL)

variance_of_systolic_imputations <- 
  data.frame(systolic_mean = NULL)

#1) Calculate the mean of the systolic for each of the 10 imputed datasets

#cat("All of the means of the systolic blood pressure imputation sets are:\n")

for (imputation_number in 1:number_of_imputations){

  column_name <- paste0("systolic_imputation_", imputation_number)

  mean_of_this_imputation <- 
  mean(bp_data_under_twenty[,column_name][[1]], na.rm=T)

  variance_of_this_imputation <- 
  var(bp_data_under_twenty[,column_name][[1]], na.rm=T)


  #take the mean and variance and bind it to a frame outside the loop

  means_of_systolic_imputations <-
  rbind(means_of_systolic_imputations,
        mean_of_this_imputation)

  variance_of_systolic_imputations <-
  rbind(variance_of_systolic_imputations,
        variance_of_this_imputation)
  
}

#rename the column so that it makes sense

names(means_of_systolic_imputations)[1] <- 
  "means_of_systolic_imputations"

names(variance_of_systolic_imputations)[1] <- 
  "variance_of_systolic_imputations"

cat("Number of readings of all imputed systolics is:\n")
sum(!is.na(bp_data_under_twenty$systolic_imputation_1))

cat("The pooled mean of the systolics is simply the mean of the means:\n")
mean(means_of_systolic_imputations$means_of_systolic_imputations)

cat("The within imputation variance of the systolics is simply the mean of the variances from each dataset:\n")
within_imputation_variance <-
  mean(variance_of_systolic_imputations$variance_of_systolic_imputations)
within_imputation_variance

cat("The between imputation variance of the systolics is the variance of the means from each dataset:\n")

between_imputation_variance <-
  var(variance_of_systolic_imputations$variance_of_systolic_imputations)

cat("The total variance is calculated by combining the within imputation and between imputation variances by adding the within imputation to the (between imputation variance multiplied by 1 + reciprocal of the number of imputations)")

total_variance <-
  within_imputation_variance +
  ( 1 + 1/number_of_imputations ) * between_imputation_variance

total_variance

cat("The pooled standard deviation is then the square root of the total variance")

pooled_sd <-
  total_variance ^ 0.5
pooled_sd
cat("***Original Data***")
cat("Number of readings of original systolics is:\n")
sum(!is.na(bp_data_under_twenty$systolic_imputation_0))
cat("We then compare this to the mean of the original values:\n")
mean(bp_data_under_twenty$systolic_imputation_0, na.rm=T)
cat("And the standard deviation of the original values:\n")
sd(bp_data_under_twenty$systolic_imputation_0, na.rm=T)
cat("********************")
cat("*********Overall systolic summary statistics all patients******")
cat("********************")
cat("Original patient data:\n")
cat(paste0("n = ", 
             sum(!is.na(bp_data_under_twenty$systolic_imputation_0))))
cat(paste0("mean = ",
             round(mean(bp_data_under_twenty$systolic_imputation_0, na.rm=T), digits=2)))
cat(paste0("confidence_interval = ",
             round(
               mean(bp_data_under_twenty$systolic_imputation_0, na.rm=T) - 
                 1.96 * sd(bp_data_under_twenty$systolic_imputation_0, na.rm=T) , 
               digits=2), 
             " to ", 
             round(
               mean(bp_data_under_twenty$systolic_imputation_0, na.rm=T) +
                 1.96 * sd(bp_data_under_twenty$systolic_imputation_0, na.rm=T) , 
               digits=2)))
cat("********************")
cat("Imputed patient data:\n")
cat(paste0("n = ", 
             sum(!is.na(bp_data_under_twenty$systolic_imputation_1))))
cat(paste0("mean = ",
             round(mean(means_of_systolic_imputations$means_of_systolic_imputations), 
                   digits=2)))
cat(paste0("confidence_interval = ",
             round(
               mean(means_of_systolic_imputations$means_of_systolic_imputations) - 
                 1.96 * pooled_sd , 
               digits=2), 
             " to ", 
             round(
               mean(means_of_systolic_imputations$means_of_systolic_imputations) +
                 1.96 * pooled_sd , 
               digits=2)))
```

```{r, describe systolic blood pressure across all imputations for male patients}
cat("Systolic blood pressure in male patients summary statistics from imputed values and original")
#now things get slightly trickier as we have to calculate pooled estimates across our imputations
#create a frame to bind to
means_of_systolic_imputations <- 
  data.frame(systolic_mean = NULL)
variance_of_systolic_imputations <- 
  data.frame(systolic_mean = NULL)
#1) Calculate the mean of the systolic for each of the 10 imputed datasets
#cat("All of the means of the systolic blood pressure imputation sets are:\n")
for (imputation_number in 1:number_of_imputations){
column_name <- paste0("systolic_imputation_", imputation_number)
mean_of_this_imputation <- 
  mean(bp_data_under_twenty_male[,column_name][[1]], na.rm=T)
variance_of_this_imputation <- 
  var(bp_data_under_twenty_male[,column_name][[1]], na.rm=T)
#cat(mean_of_this_imputation)
#cat(variance_of_this_imputation)
#take the mean and variance and bind it to a frame outside the loop
means_of_systolic_imputations <-
  rbind(means_of_systolic_imputations,
        mean_of_this_imputation)
variance_of_systolic_imputations <-
  rbind(variance_of_systolic_imputations,
        variance_of_this_imputation)
  
}
#rename the column so that it makes sense
names(means_of_systolic_imputations)[1] <- 
  "means_of_systolic_imputations"
names(variance_of_systolic_imputations)[1] <- 
  "variance_of_systolic_imputations"

cat("Number of readings of all imputed systolics is:\n")
sum(!is.na(bp_data_under_twenty_male$systolic_imputation_1))
cat("The pooled mean of the systolics is simply the mean of the means:\n")
mean(means_of_systolic_imputations$means_of_systolic_imputations)
cat("The within imputation variance of the systolics is simply the mean of the variances from each dataset:\n")
within_imputation_variance <-
  mean(variance_of_systolic_imputations$variance_of_systolic_imputations)
within_imputation_variance
cat("The between imputation variance of the systolics is the variance of the means from each dataset:\n")
between_imputation_variance <-
  var(variance_of_systolic_imputations$variance_of_systolic_imputations)
cat("The total variance is calculated by combining the within imputation and between imputation variances by adding the within imputation to the (between imputation variance multiplied by 1 + reciprocal of the number of imputations)")
total_variance <-
  within_imputation_variance +
  ( 1 + 1/number_of_imputations ) * between_imputation_variance
total_variance
cat("The pooled standard deviation is then the square root of the total variance")
pooled_sd <-
  total_variance ^ 0.5
pooled_sd
cat("***Original Data***")
cat("Number of readings of original systolics is:\n")
sum(!is.na(bp_data_under_twenty_male$systolic_imputation_0))
cat("We then compare this to the mean of the original values:\n")
mean(bp_data_under_twenty_male$systolic_imputation_0, na.rm=T)
cat("And the standard deviation of the original values:\n")
sd(bp_data_under_twenty_male$systolic_imputation_0, na.rm=T)
cat("********************")
cat("*********Overall systolic summary statistics male patients******")
cat("********************")
cat("Original patient data:\n")
cat(paste0("n = ", 
             sum(!is.na(bp_data_under_twenty_male$systolic_imputation_0))))
cat(paste0("mean = ",
             round(mean(bp_data_under_twenty_male$systolic_imputation_0, na.rm=T), digits=2)))
cat(paste0("confidence_interval = ",
             round(
               mean(bp_data_under_twenty_male$systolic_imputation_0, na.rm=T) - 
                 1.96 * sd(bp_data_under_twenty_male$systolic_imputation_0, na.rm=T) , 
               digits=2), 
             " to ", 
             round(
               mean(bp_data_under_twenty_male$systolic_imputation_0, na.rm=T) +
                 1.96 * sd(bp_data_under_twenty_male$systolic_imputation_0, na.rm=T) , 
               digits=2)))
cat("********************")
cat("Imputed patient data:\n")
cat(paste0("n = ", 
             sum(!is.na(bp_data_under_twenty_male$systolic_imputation_1))))
cat(paste0("mean = ",
             round(mean(means_of_systolic_imputations$means_of_systolic_imputations), 
                   digits=2)))
cat(paste0("confidence_interval = ",
             round(
               mean(means_of_systolic_imputations$means_of_systolic_imputations) - 
                 1.96 * pooled_sd , 
               digits=2), 
             " to ", 
             round(
               mean(means_of_systolic_imputations$means_of_systolic_imputations) +
                 1.96 * pooled_sd , 
               digits=2)))
```

```{r, describe systolic blood pressure across all imputations for fema patients}
cat("Systolic blood pressure in fema patients summary statistics from imputed values and original")
#now things get slightly trickier as we have to calculate pooled estimates across our imputations
#create a frame to bind to
means_of_systolic_imputations <- 
  data.frame(systolic_mean = NULL)
variance_of_systolic_imputations <- 
  data.frame(systolic_mean = NULL)
#1) Calculate the mean of the systolic for each of the 10 imputed datasets
#cat("All of the means of the systolic blood pressure imputation sets are:\n")
for (imputation_number in 1:number_of_imputations){
column_name <- paste0("systolic_imputation_", imputation_number)
mean_of_this_imputation <- 
  mean(bp_data_under_twenty_fema[,column_name][[1]], na.rm=T)
variance_of_this_imputation <- 
  var(bp_data_under_twenty_fema[,column_name][[1]], na.rm=T)
#cat(mean_of_this_imputation)
#cat(variance_of_this_imputation)
#take the mean and variance and bind it to a frame outside the loop
means_of_systolic_imputations <-
  rbind(means_of_systolic_imputations,
        mean_of_this_imputation)
variance_of_systolic_imputations <-
  rbind(variance_of_systolic_imputations,
        variance_of_this_imputation)
  
}
#rename the column so that it makes sense
names(means_of_systolic_imputations)[1] <- 
  "means_of_systolic_imputations"
names(variance_of_systolic_imputations)[1] <- 
  "variance_of_systolic_imputations"

cat("Number of readings of all imputed systolics is:\n")
sum(!is.na(bp_data_under_twenty_fema$systolic_imputation_1))
cat("The pooled mean of the systolics is simply the mean of the means:\n")
mean(means_of_systolic_imputations$means_of_systolic_imputations)
cat("The within imputation variance of the systolics is simply the mean of the variances from each dataset:\n")
within_imputation_variance <-
  mean(variance_of_systolic_imputations$variance_of_systolic_imputations)
within_imputation_variance
cat("The between imputation variance of the systolics is the variance of the means from each dataset:\n")
between_imputation_variance <-
  var(variance_of_systolic_imputations$variance_of_systolic_imputations)
cat("The total variance is calculated by combining the within imputation and between imputation variances by adding the within imputation to the (between imputation variance multiplied by 1 + reciprocal of the number of imputations)")
total_variance <-
  within_imputation_variance +
  ( 1 + 1/number_of_imputations ) * between_imputation_variance
total_variance
cat("The pooled standard deviation is then the square root of the total variance")
pooled_sd <-
  total_variance ^ 0.5
pooled_sd
cat("***Original Data***")
cat("Number of readings of original systolics is:\n")
sum(!is.na(bp_data_under_twenty_fema$systolic_imputation_0))
cat("We then compare this to the mean of the original values:\n")
mean(bp_data_under_twenty_fema$systolic_imputation_0, na.rm=T)
cat("And the standard deviation of the original values:\n")
sd(bp_data_under_twenty_fema$systolic_imputation_0, na.rm=T)
cat("********************")
cat("*********Overall systolic summary statistics fema patients******")
cat("********************")
cat("Original patient data:\n")
cat(paste0("n = ", 
             sum(!is.na(bp_data_under_twenty_fema$systolic_imputation_0))))
cat(paste0("mean = ",
             round(mean(bp_data_under_twenty_fema$systolic_imputation_0, na.rm=T), digits=2)))
cat(paste0("confidence_interval = ",
             round(
               mean(bp_data_under_twenty_fema$systolic_imputation_0, na.rm=T) - 
                 1.96 * sd(bp_data_under_twenty_fema$systolic_imputation_0, na.rm=T) , 
               digits=2), 
             " to ", 
             round(
               mean(bp_data_under_twenty_fema$systolic_imputation_0, na.rm=T) +
                 1.96 * sd(bp_data_under_twenty_fema$systolic_imputation_0, na.rm=T) , 
               digits=2)))
cat("********************")
cat("Imputed patient data:\n")
cat(paste0("n = ", 
             sum(!is.na(bp_data_under_twenty_fema$systolic_imputation_1))))
cat(paste0("mean = ",
             round(mean(means_of_systolic_imputations$means_of_systolic_imputations), 
                   digits=2)))
cat(paste0("confidence_interval = ",
             round(
               mean(means_of_systolic_imputations$means_of_systolic_imputations) - 
                 1.96 * pooled_sd , 
               digits=2), 
             " to ", 
             round(
               mean(means_of_systolic_imputations$means_of_systolic_imputations) +
                 1.96 * pooled_sd , 
               digits=2)))
```

```{r, describe systolic blood pressure across all imputations for not assigned patients}
cat("Systolic blood pressure in not assigned patients summary statistics from imputed values and original")
#now things get slightly trickier as we have to calculate pooled estimates across our imputations
#create a frame to bind to
means_of_systolic_imputations <- 
  data.frame(systolic_mean = NULL)
variance_of_systolic_imputations <- 
  data.frame(systolic_mean = NULL)
#1) Calculate the mean of the systolic for each of the 10 imputed datasets
#cat("All of the means of the systolic blood pressure imputation sets are:\n")
for (imputation_number in 1:number_of_imputations){
column_name <- paste0("systolic_imputation_", imputation_number)
mean_of_this_imputation <- 
  mean(bp_data_under_twenty_not_assigned[,column_name][[1]], na.rm=T)
variance_of_this_imputation <- 
  var(bp_data_under_twenty_not_assigned[,column_name][[1]], na.rm=T)
#cat(mean_of_this_imputation)
#cat(variance_of_this_imputation)
#take the mean and variance and bind it to a frame outside the loop
means_of_systolic_imputations <-
  rbind(means_of_systolic_imputations,
        mean_of_this_imputation)
variance_of_systolic_imputations <-
  rbind(variance_of_systolic_imputations,
        variance_of_this_imputation)
  
}
#rename the column so that it makes sense
names(means_of_systolic_imputations)[1] <- 
  "means_of_systolic_imputations"
names(variance_of_systolic_imputations)[1] <- 
  "variance_of_systolic_imputations"
cat("Number of readings of all imputed systolics is:\n")
sum(!is.na(bp_data_under_twenty_not_assigned$systolic_imputation_1))
cat("The pooled mean of the systolics is simply the mean of the means:\n")
mean(means_of_systolic_imputations$means_of_systolic_imputations)
cat("The within imputation variance of the systolics is simply the mean of the variances from each dataset:\n")
within_imputation_variance <-
  mean(variance_of_systolic_imputations$variance_of_systolic_imputations)
within_imputation_variance
cat("The between imputation variance of the systolics is the variance of the means from each dataset:\n")
between_imputation_variance <-
  var(variance_of_systolic_imputations$variance_of_systolic_imputations)
cat("The total variance is calculated by combining the within imputation and between imputation variances by adding the within imputation to the (between imputation variance multiplied by 1 + reciprocal of the number of imputations)")
total_variance <-
  within_imputation_variance +
  ( 1 + 1/number_of_imputations ) * between_imputation_variance
total_variance
cat("The pooled standard deviation is then the square root of the total variance")
pooled_sd <-
  total_variance ^ 0.5
pooled_sd
cat("***Original Data***")
cat("Number of readings of original systolics is:\n")
sum(!is.na(bp_data_under_twenty_not_assigned$systolic_imputation_0))
cat("We then compare this to the mean of the original values:\n")
mean(bp_data_under_twenty_not_assigned$systolic_imputation_0, na.rm=T)
cat("And the standard deviation of the original values:\n")
sd(bp_data_under_twenty_not_assigned$systolic_imputation_0, na.rm=T)
cat("********************")
cat("*********Overall systolic summary statistics not_assigned patients******")
cat("********************")
cat("Original patient data:\n")
cat(paste0("n = ", 
             sum(!is.na(bp_data_under_twenty_not_assigned$systolic_imputation_0))))
cat(paste0("mean = ",
             round(mean(bp_data_under_twenty_not_assigned$systolic_imputation_0, na.rm=T), digits=2)))
cat(paste0("confidence_interval = ",
             round(
               mean(bp_data_under_twenty_not_assigned$systolic_imputation_0, na.rm=T) - 
                 1.96 * sd(bp_data_under_twenty_not_assigned$systolic_imputation_0, na.rm=T) , 
               digits=2), 
             " to ", 
             round(
               mean(bp_data_under_twenty_not_assigned$systolic_imputation_0, na.rm=T) +
                 1.96 * sd(bp_data_under_twenty_not_assigned$systolic_imputation_0, na.rm=T) , 
               digits=2)))
cat("********************")
cat("Imputed patient data:\n")
cat(paste0("n = ", 
             sum(!is.na(bp_data_under_twenty_not_assigned$systolic_imputation_1))))
cat(paste0("mean = ",
             round(mean(means_of_systolic_imputations$means_of_systolic_imputations), 
                   digits=2)))
cat(paste0("confidence_interval = ",
             round(
               mean(means_of_systolic_imputations$means_of_systolic_imputations) - 
                 1.96 * pooled_sd , 
               digits=2), 
             " to ", 
             round(
               mean(means_of_systolic_imputations$means_of_systolic_imputations) +
                 1.96 * pooled_sd , 
               digits=2)))
```


##############################################
Diastolic blood pressure mean and variance statistics
##############################################


```{r, describe diastolic blood pressure across all imputations for all patients}
cat("diastolic blood pressure in all patients summary statistics from imputed values and original")
#now things get slightly trickier as we have to calculate pooled estimates across our imputations
#create a frame to bind to

means_of_diastolic_imputations <- 
  data.frame(diastolic_mean = NULL)

variance_of_diastolic_imputations <- 
  data.frame(diastolic_mean = NULL)

#1) Calculate the mean of the diastolic for each of the 10 imputed datasets

#cat("All of the means of the diastolic blood pressure imputation sets are:\n")

for (imputation_number in 1:number_of_imputations){

  column_name <- paste0("diastolic_imputation_", imputation_number)

  mean_of_this_imputation <- 
  mean(bp_data_under_twenty[,column_name][[1]], na.rm=T)

  variance_of_this_imputation <- 
  var(bp_data_under_twenty[,column_name][[1]], na.rm=T)


  #take the mean and variance and bind it to a frame outside the loop

  means_of_diastolic_imputations <-
  rbind(means_of_diastolic_imputations,
        mean_of_this_imputation)

  variance_of_diastolic_imputations <-
  rbind(variance_of_diastolic_imputations,
        variance_of_this_imputation)
  
}

#rename the column so that it makes sense

names(means_of_diastolic_imputations)[1] <- 
  "means_of_diastolic_imputations"

names(variance_of_diastolic_imputations)[1] <- 
  "variance_of_diastolic_imputations"

cat("Number of readings of all imputed diastolics is:\n")
sum(!is.na(bp_data_under_twenty$diastolic_imputation_1))

cat("The pooled mean of the diastolics is simply the mean of the means:\n")
mean(means_of_diastolic_imputations$means_of_diastolic_imputations)

cat("The within imputation variance of the diastolics is simply the mean of the variances from each dataset:\n")
within_imputation_variance <-
  mean(variance_of_diastolic_imputations$variance_of_diastolic_imputations)
within_imputation_variance

cat("The between imputation variance of the diastolics is the variance of the means from each dataset:\n")

between_imputation_variance <-
  var(variance_of_diastolic_imputations$variance_of_diastolic_imputations)

cat("The total variance is calculated by combining the within imputation and between imputation variances by adding the within imputation to the (between imputation variance multiplied by 1 + reciprocal of the number of imputations)")

total_variance <-
  within_imputation_variance +
  ( 1 + 1/number_of_imputations ) * between_imputation_variance

total_variance

cat("The pooled standard deviation is then the square root of the total variance")

pooled_sd <-
  total_variance ^ 0.5
pooled_sd
cat("***Original Data***")
cat("Number of readings of original diastolics is:\n")
sum(!is.na(bp_data_under_twenty$diastolic_imputation_0))
cat("We then compare this to the mean of the original values:\n")
mean(bp_data_under_twenty$diastolic_imputation_0, na.rm=T)
cat("And the standard deviation of the original values:\n")
sd(bp_data_under_twenty$diastolic_imputation_0, na.rm=T)
cat("********************")
cat("*********Overall diastolic summary statistics all patients******")
cat("********************")
cat("Original patient data:\n")
cat(paste0("n = ", 
             sum(!is.na(bp_data_under_twenty$diastolic_imputation_0))))
cat(paste0("mean = ",
             round(mean(bp_data_under_twenty$diastolic_imputation_0, na.rm=T), digits=2)))
cat(paste0("confidence_interval = ",
             round(
               mean(bp_data_under_twenty$diastolic_imputation_0, na.rm=T) - 
                 1.96 * sd(bp_data_under_twenty$diastolic_imputation_0, na.rm=T) , 
               digits=2), 
             " to ", 
             round(
               mean(bp_data_under_twenty$diastolic_imputation_0, na.rm=T) +
                 1.96 * sd(bp_data_under_twenty$diastolic_imputation_0, na.rm=T) , 
               digits=2)))
cat("********************")
cat("Imputed patient data:\n")
cat(paste0("n = ", 
             sum(!is.na(bp_data_under_twenty$diastolic_imputation_1))))
cat(paste0("mean = ",
             round(mean(means_of_diastolic_imputations$means_of_diastolic_imputations), 
                   digits=2)))
cat(paste0("confidence_interval = ",
             round(
               mean(means_of_diastolic_imputations$means_of_diastolic_imputations) - 
                 1.96 * pooled_sd , 
               digits=2), 
             " to ", 
             round(
               mean(means_of_diastolic_imputations$means_of_diastolic_imputations) +
                 1.96 * pooled_sd , 
               digits=2)))
```

```{r, describe diastolic blood pressure across all imputations for male patients}
cat("diastolic blood pressure in male patients summary statistics from imputed values and original")
#now things get slightly trickier as we have to calculate pooled estimates across our imputations
#create a frame to bind to
means_of_diastolic_imputations <- 
  data.frame(diastolic_mean = NULL)
variance_of_diastolic_imputations <- 
  data.frame(diastolic_mean = NULL)
#1) Calculate the mean of the diastolic for each of the 10 imputed datasets
#cat("All of the means of the diastolic blood pressure imputation sets are:\n")
for (imputation_number in 1:number_of_imputations){
column_name <- paste0("diastolic_imputation_", imputation_number)
mean_of_this_imputation <- 
  mean(bp_data_under_twenty_male[,column_name][[1]], na.rm=T)
variance_of_this_imputation <- 
  var(bp_data_under_twenty_male[,column_name][[1]], na.rm=T)
#cat(mean_of_this_imputation)
#cat(variance_of_this_imputation)
#take the mean and variance and bind it to a frame outside the loop
means_of_diastolic_imputations <-
  rbind(means_of_diastolic_imputations,
        mean_of_this_imputation)
variance_of_diastolic_imputations <-
  rbind(variance_of_diastolic_imputations,
        variance_of_this_imputation)
  
}
#rename the column so that it makes sense
names(means_of_diastolic_imputations)[1] <- 
  "means_of_diastolic_imputations"
names(variance_of_diastolic_imputations)[1] <- 
  "variance_of_diastolic_imputations"

cat("Number of readings of all imputed diastolics is:\n")
sum(!is.na(bp_data_under_twenty_male$diastolic_imputation_1))
cat("The pooled mean of the diastolics is simply the mean of the means:\n")
mean(means_of_diastolic_imputations$means_of_diastolic_imputations)
cat("The within imputation variance of the diastolics is simply the mean of the variances from each dataset:\n")
within_imputation_variance <-
  mean(variance_of_diastolic_imputations$variance_of_diastolic_imputations)
within_imputation_variance
cat("The between imputation variance of the diastolics is the variance of the means from each dataset:\n")
between_imputation_variance <-
  var(variance_of_diastolic_imputations$variance_of_diastolic_imputations)
cat("The total variance is calculated by combining the within imputation and between imputation variances by adding the within imputation to the (between imputation variance multiplied by 1 + reciprocal of the number of imputations)")
total_variance <-
  within_imputation_variance +
  ( 1 + 1/number_of_imputations ) * between_imputation_variance
total_variance
cat("The pooled standard deviation is then the square root of the total variance")
pooled_sd <-
  total_variance ^ 0.5
pooled_sd
cat("***Original Data***")
cat("Number of readings of original diastolics is:\n")
sum(!is.na(bp_data_under_twenty_male$diastolic_imputation_0))
cat("We then compare this to the mean of the original values:\n")
mean(bp_data_under_twenty_male$diastolic_imputation_0, na.rm=T)
cat("And the standard deviation of the original values:\n")
sd(bp_data_under_twenty_male$diastolic_imputation_0, na.rm=T)
cat("********************")
cat("*********Overall diastolic summary statistics male patients******")
cat("********************")
cat("Original patient data:\n")
cat(paste0("n = ", 
             sum(!is.na(bp_data_under_twenty_male$diastolic_imputation_0))))
cat(paste0("mean = ",
             round(mean(bp_data_under_twenty_male$diastolic_imputation_0, na.rm=T), digits=2)))
cat(paste0("confidence_interval = ",
             round(
               mean(bp_data_under_twenty_male$diastolic_imputation_0, na.rm=T) - 
                 1.96 * sd(bp_data_under_twenty_male$diastolic_imputation_0, na.rm=T) , 
               digits=2), 
             " to ", 
             round(
               mean(bp_data_under_twenty_male$diastolic_imputation_0, na.rm=T) +
                 1.96 * sd(bp_data_under_twenty_male$diastolic_imputation_0, na.rm=T) , 
               digits=2)))
cat("********************")
cat("Imputed patient data:\n")
cat(paste0("n = ", 
             sum(!is.na(bp_data_under_twenty_male$diastolic_imputation_1))))
cat(paste0("mean = ",
             round(mean(means_of_diastolic_imputations$means_of_diastolic_imputations), 
                   digits=2)))
cat(paste0("confidence_interval = ",
             round(
               mean(means_of_diastolic_imputations$means_of_diastolic_imputations) - 
                 1.96 * pooled_sd , 
               digits=2), 
             " to ", 
             round(
               mean(means_of_diastolic_imputations$means_of_diastolic_imputations) +
                 1.96 * pooled_sd , 
               digits=2)))
```

```{r, describe diastolic blood pressure across all imputations for fema patients}
cat("diastolic blood pressure in fema patients summary statistics from imputed values and original")
#now things get slightly trickier as we have to calculate pooled estimates across our imputations
#create a frame to bind to
means_of_diastolic_imputations <- 
  data.frame(diastolic_mean = NULL)
variance_of_diastolic_imputations <- 
  data.frame(diastolic_mean = NULL)
#1) Calculate the mean of the diastolic for each of the 10 imputed datasets
#cat("All of the means of the diastolic blood pressure imputation sets are:\n")
for (imputation_number in 1:number_of_imputations){
column_name <- paste0("diastolic_imputation_", imputation_number)
mean_of_this_imputation <- 
  mean(bp_data_under_twenty_fema[,column_name][[1]], na.rm=T)
variance_of_this_imputation <- 
  var(bp_data_under_twenty_fema[,column_name][[1]], na.rm=T)
#cat(mean_of_this_imputation)
#cat(variance_of_this_imputation)
#take the mean and variance and bind it to a frame outside the loop
means_of_diastolic_imputations <-
  rbind(means_of_diastolic_imputations,
        mean_of_this_imputation)
variance_of_diastolic_imputations <-
  rbind(variance_of_diastolic_imputations,
        variance_of_this_imputation)
  
}
#rename the column so that it makes sense
names(means_of_diastolic_imputations)[1] <- 
  "means_of_diastolic_imputations"
names(variance_of_diastolic_imputations)[1] <- 
  "variance_of_diastolic_imputations"

cat("Number of readings of all imputed diastolics is:\n")
sum(!is.na(bp_data_under_twenty_fema$diastolic_imputation_1))
cat("The pooled mean of the diastolics is simply the mean of the means:\n")
mean(means_of_diastolic_imputations$means_of_diastolic_imputations)
cat("The within imputation variance of the diastolics is simply the mean of the variances from each dataset:\n")
within_imputation_variance <-
  mean(variance_of_diastolic_imputations$variance_of_diastolic_imputations)
within_imputation_variance
cat("The between imputation variance of the diastolics is the variance of the means from each dataset:\n")
between_imputation_variance <-
  var(variance_of_diastolic_imputations$variance_of_diastolic_imputations)
cat("The total variance is calculated by combining the within imputation and between imputation variances by adding the within imputation to the (between imputation variance multiplied by 1 + reciprocal of the number of imputations)")
total_variance <-
  within_imputation_variance +
  ( 1 + 1/number_of_imputations ) * between_imputation_variance
total_variance
cat("The pooled standard deviation is then the square root of the total variance")
pooled_sd <-
  total_variance ^ 0.5
pooled_sd
cat("***Original Data***")
cat("Number of readings of original diastolics is:\n")
sum(!is.na(bp_data_under_twenty_fema$diastolic_imputation_0))
cat("We then compare this to the mean of the original values:\n")
mean(bp_data_under_twenty_fema$diastolic_imputation_0, na.rm=T)
cat("And the standard deviation of the original values:\n")
sd(bp_data_under_twenty_fema$diastolic_imputation_0, na.rm=T)
cat("********************")
cat("*********Overall diastolic summary statistics fema patients******")
cat("********************")
cat("Original patient data:\n")
cat(paste0("n = ", 
             sum(!is.na(bp_data_under_twenty_fema$diastolic_imputation_0))))
cat(paste0("mean = ",
             round(mean(bp_data_under_twenty_fema$diastolic_imputation_0, na.rm=T), digits=2)))
cat(paste0("confidence_interval = ",
             round(
               mean(bp_data_under_twenty_fema$diastolic_imputation_0, na.rm=T) - 
                 1.96 * sd(bp_data_under_twenty_fema$diastolic_imputation_0, na.rm=T) , 
               digits=2), 
             " to ", 
             round(
               mean(bp_data_under_twenty_fema$diastolic_imputation_0, na.rm=T) +
                 1.96 * sd(bp_data_under_twenty_fema$diastolic_imputation_0, na.rm=T) , 
               digits=2)))
cat("********************")
cat("Imputed patient data:\n")
cat(paste0("n = ", 
             sum(!is.na(bp_data_under_twenty_fema$diastolic_imputation_1))))
cat(paste0("mean = ",
             round(mean(means_of_diastolic_imputations$means_of_diastolic_imputations), 
                   digits=2)))
cat(paste0("confidence_interval = ",
             round(
               mean(means_of_diastolic_imputations$means_of_diastolic_imputations) - 
                 1.96 * pooled_sd , 
               digits=2), 
             " to ", 
             round(
               mean(means_of_diastolic_imputations$means_of_diastolic_imputations) +
                 1.96 * pooled_sd , 
               digits=2)))
```

```{r, describe diastolic blood pressure across all imputations for not assigned patients}
cat("diastolic blood pressure in not assigned patients summary statistics from imputed values and original")
#now things get slightly trickier as we have to calculate pooled estimates across our imputations
#create a frame to bind to
means_of_diastolic_imputations <- 
  data.frame(diastolic_mean = NULL)
variance_of_diastolic_imputations <- 
  data.frame(diastolic_mean = NULL)
#1) Calculate the mean of the diastolic for each of the 10 imputed datasets
#cat("All of the means of the diastolic blood pressure imputation sets are:\n")
for (imputation_number in 1:number_of_imputations){
column_name <- paste0("diastolic_imputation_", imputation_number)
mean_of_this_imputation <- 
  mean(bp_data_under_twenty_not_assigned[,column_name][[1]], na.rm=T)
variance_of_this_imputation <- 
  var(bp_data_under_twenty_not_assigned[,column_name][[1]], na.rm=T)
#cat(mean_of_this_imputation)
#cat(variance_of_this_imputation)
#take the mean and variance and bind it to a frame outside the loop
means_of_diastolic_imputations <-
  rbind(means_of_diastolic_imputations,
        mean_of_this_imputation)
variance_of_diastolic_imputations <-
  rbind(variance_of_diastolic_imputations,
        variance_of_this_imputation)
  
}
#rename the column so that it makes sense
names(means_of_diastolic_imputations)[1] <- 
  "means_of_diastolic_imputations"
names(variance_of_diastolic_imputations)[1] <- 
  "variance_of_diastolic_imputations"

cat("Number of readings of all imputed diastolics is:\n")
sum(!is.na(bp_data_under_twenty_not_assigned$diastolic_imputation_1))
cat("The pooled mean of the diastolics is simply the mean of the means:\n")
mean(means_of_diastolic_imputations$means_of_diastolic_imputations)
cat("The within imputation variance of the diastolics is simply the mean of the variances from each dataset:\n")
within_imputation_variance <-
  mean(variance_of_diastolic_imputations$variance_of_diastolic_imputations)
within_imputation_variance
cat("The between imputation variance of the diastolics is the variance of the means from each dataset:\n")
between_imputation_variance <-
  var(variance_of_diastolic_imputations$variance_of_diastolic_imputations)
cat("The total variance is calculated by combining the within imputation and between imputation variances by adding the within imputation to the (between imputation variance multiplied by 1 + reciprocal of the number of imputations)")
total_variance <-
  within_imputation_variance +
  ( 1 + 1/number_of_imputations ) * between_imputation_variance
total_variance
cat("The pooled standard deviation is then the square root of the total variance")
pooled_sd <-
  total_variance ^ 0.5
pooled_sd
cat("***Original Data***")
cat("Number of readings of original diastolics is:\n")
sum(!is.na(bp_data_under_twenty_not_assigned$diastolic_imputation_0))
cat("We then compare this to the mean of the original values:\n")
mean(bp_data_under_twenty_not_assigned$diastolic_imputation_0, na.rm=T)
cat("And the standard deviation of the original values:\n")
sd(bp_data_under_twenty_not_assigned$diastolic_imputation_0, na.rm=T)
cat("********************")
cat("*********Overall diastolic summary statistics not_assigned patients******")
cat("********************")
cat("Original patient data:\n")
cat(paste0("n = ", 
             sum(!is.na(bp_data_under_twenty_not_assigned$diastolic_imputation_0))))
cat(paste0("mean = ",
             round(mean(bp_data_under_twenty_not_assigned$diastolic_imputation_0, na.rm=T), digits=2)))
cat(paste0("confidence_interval = ",
             round(
               mean(bp_data_under_twenty_not_assigned$diastolic_imputation_0, na.rm=T) - 
                 1.96 * sd(bp_data_under_twenty_not_assigned$diastolic_imputation_0, na.rm=T) , 
               digits=2), 
             " to ", 
             round(
               mean(bp_data_under_twenty_not_assigned$diastolic_imputation_0, na.rm=T) +
                 1.96 * sd(bp_data_under_twenty_not_assigned$diastolic_imputation_0, na.rm=T) , 
               digits=2)))
cat("********************")
cat("Imputed patient data:\n")
cat(paste0("n = ", 
             sum(!is.na(bp_data_under_twenty_not_assigned$diastolic_imputation_1))))
cat(paste0("mean = ",
             round(mean(means_of_diastolic_imputations$means_of_diastolic_imputations), 
                   digits=2)))
cat(paste0("confidence_interval = ",
             round(
               mean(means_of_diastolic_imputations$means_of_diastolic_imputations) - 
                 1.96 * pooled_sd , 
               digits=2), 
             " to ", 
             round(
               mean(means_of_diastolic_imputations$means_of_diastolic_imputations) +
                 1.96 * pooled_sd , 
               digits=2)))
```


##############################################
glucocorticoid dosing summary statistics
##############################################

```{r, frequency tables reporting those prescribed hydrocortisone}
for (decimal_places in c(1 , 2)){ #we do it for multiple decimal places just to help correct any rounding errors
#bp_data_under_twenty$
#note my carried to use get a bit weird in some cases so ensure you are using the correct carried to use and compare appropriately to the other to use in cases of preparation. This is because first off it is coded to carried to use the units. Then it is coded to carry again the actual values within limits
cat("Visits prescribed hydrocortisone:\n")
cat("*********************************")
cat("All patients:\n")
cat(freq(bp_data_under_twenty$daily_preparation_of_GC_to_use))
cat(freq(bp_data_under_twenty$daily_preparation_of_GC_to_use_carried_to_use))
cat("*********************************")
cat("Male patients:\n")
cat(freq(bp_data_under_twenty_male$daily_preparation_of_GC_to_use))
cat(freq(bp_data_under_twenty_male$daily_preparation_of_GC_to_use_carried_to_use))
cat("*********************************")
cat("Fema patients:\n")
cat(freq(bp_data_under_twenty_fema$daily_preparation_of_GC_to_use))
cat(freq(bp_data_under_twenty_fema$daily_preparation_of_GC_to_use_carried_to_use))
cat("*********************************")
cat("Not assigned patients:\n")
cat(freq(bp_data_under_twenty_not_assigned$daily_preparation_of_GC_to_use))
cat(freq(bp_data_under_twenty_not_assigned$daily_preparation_of_GC_to_use_carried_to_use))
cat("*********************************")

cat("We put all of those together in one frame")
as.data.frame(freq(bp_data_under_twenty$daily_preparation_of_GC_to_use_carried_to_use))
#we have to do the preparation frequency frames separately and then join them because not all categories will have one of all of the preparations in use
all_preparation_frequency_frame <-
  data.frame(Preparation =
             rownames(as.data.frame(freq(bp_data_under_twenty$daily_preparation_of_GC_to_use_carried_to_use))),
           All_visits = 
             paste0(
               as.data.frame(freq(bp_data_under_twenty$daily_preparation_of_GC_to_use_carried_to_use))$Freq,
               " (",
               round(
               as.data.frame(freq(bp_data_under_twenty$daily_preparation_of_GC_to_use_carried_to_use))$`% Total`,
               digits=decimal_places
               ),
               "%)"
             ))
male_preparation_frequency_frame <-
  data.frame(Preparation =
             rownames(as.data.frame(freq(bp_data_under_twenty_male$daily_preparation_of_GC_to_use_carried_to_use))),
           Male_visits = 
             paste0(
               as.data.frame(freq(bp_data_under_twenty_male$daily_preparation_of_GC_to_use_carried_to_use))$Freq,
               " (",
               round(
               as.data.frame(freq(bp_data_under_twenty_male$daily_preparation_of_GC_to_use_carried_to_use))$`% Total`,
               digits=decimal_places
               ),
               "%)"
             ))
fema_preparation_frequency_frame <-
  data.frame(Preparation =
             rownames(as.data.frame(freq(bp_data_under_twenty_fema$daily_preparation_of_GC_to_use_carried_to_use))),
           Female_visits = 
             paste0(
               as.data.frame(freq(bp_data_under_twenty_fema$daily_preparation_of_GC_to_use_carried_to_use))$Freq,
               " (",
               round(
               as.data.frame(freq(bp_data_under_twenty_fema$daily_preparation_of_GC_to_use_carried_to_use))$`% Total`,
               digits=decimal_places
               ),
               "%)"
             ))
not_assigned_preparation_frequency_frame <-
  data.frame(Preparation =
             rownames(as.data.frame(freq(bp_data_under_twenty_not_assigned$daily_preparation_of_GC_to_use_carried_to_use))),
           visits_not_assigned_sex = 
             paste0(
               as.data.frame(freq(bp_data_under_twenty_not_assigned$daily_preparation_of_GC_to_use_carried_to_use))$Freq,
               " (",
               round(
               as.data.frame(freq(bp_data_under_twenty_not_assigned$daily_preparation_of_GC_to_use_carried_to_use))$`% Total`,
               digits=decimal_places
               ),
               "%)"
             ))

#then we left join them together
joined_frame_a <-
  left_join(
    all_preparation_frequency_frame,
    male_preparation_frequency_frame,
    by = join_by(Preparation)
  )
joined_frame_b <-
  left_join(
    joined_frame_a,
    fema_preparation_frequency_frame,
    by = join_by(Preparation)
  )
complete_preparation_frequency_frame <-
  left_join(
    joined_frame_b,
    not_assigned_preparation_frequency_frame,
    by = join_by(Preparation)
  )

#replace <NA> preparation with 'unknown'
complete_preparation_frequency_frame$Preparation <-
  ifelse(
    complete_preparation_frequency_frame$Preparation=="<NA>",
    "unknown",
    complete_preparation_frequency_frame$Preparation)

#replace all NA values with 0(0.0%)
complete_preparation_frequency_frame[is.na(complete_preparation_frequency_frame)] <- "0 (0.0%)"

# Specify the custom order of the 'Preparation' column
custom_order <- 
  c('hydrocortisone', 
    'prednisolone', 
    'prednisone', 
    'dexamethasone', 
    'methylpreednisolone', 
    'cortisone_acetate',
    'mixed_dosing', 
    'none',
    'unknown',
    'Total')

# Convert 'Name' column to a factor with the specified level order
complete_preparation_frequency_frame$Preparation <- 
  factor(complete_preparation_frequency_frame$Preparation, 
         levels = custom_order)

# Order the dataframe by the 'Preparation' column
complete_preparation_frequency_frame <- 
  complete_preparation_frequency_frame[order(complete_preparation_frequency_frame$Preparation), ]

complete_preparation_frequency_frame
write.csv(paste0("summary_statistics/complete_preparation_frequency_frame_", decimal_places, "dp.csv"), 
          x=complete_preparation_frequency_frame, 
          row.names=F)
#close the loop to print multiple decimal places
}
```




##############################################
glucocrticoid dosing per bsa
##############################################

```{r, define decimal places}
#redefine the decimal places you want for the rest of the numbers 
decimal_places <- 1
```

```{r, hydrocortisone equivalent doses all patients}
#descr(bp_data_under_twenty$complete_case_total_daily_hydrocortisone_equivalent_per_bsa)
#descr(bp_data_under_twenty$imputed_total_daily_hydrocortisone_equivalent_per_bsa)

cat("Complete case total daily hydrocortisone equivalent per bsa\n")
cat("all patients\n")
cat(
  paste0(
  round(
    mean(bp_data_under_twenty$complete_case_total_daily_hydrocortisone_equivalent_per_bsa, na.rm=T) ,
  digits=2)
))
cat (" (n= ")
cat(sum(!is.na(bp_data_under_twenty$complete_case_total_daily_hydrocortisone_equivalent_per_bsa)))
cat(")\n")
cat("(")
cat(
  round(
    quantile(bp_data_under_twenty$complete_case_total_daily_hydrocortisone_equivalent_per_bsa, 0.25, na.rm=T),
  digits=2)
)
cat(" to ")
cat(
  round(
    quantile(bp_data_under_twenty$complete_case_total_daily_hydrocortisone_equivalent_per_bsa, 0.75, na.rm=T),
  digits=2)
)
cat(")")

cat("\n")
cat("\n")
cat("Imputed total daily hydrocortisone equivalent per bsa\n")
cat("all patients\n")
cat(
  paste0(
  round(
    mean(bp_data_under_twenty$imputed_total_daily_hydrocortisone_equivalent_per_bsa, na.rm=T) ,
  digits=2)
))
cat (" (n= ")
cat(sum(!is.na(bp_data_under_twenty$imputed_total_daily_hydrocortisone_equivalent_per_bsa)))
cat(")\n")
cat("(")
cat(
  round(
    quantile(bp_data_under_twenty$imputed_total_daily_hydrocortisone_equivalent_per_bsa, 0.25, na.rm=T),
  digits=2)
)
cat(" to ")
cat(
  round(
    quantile(bp_data_under_twenty$imputed_total_daily_hydrocortisone_equivalent_per_bsa, 0.75, na.rm=T),
  digits=2)
)
cat(")")
```

```{r, hydrocortisone equivalent doses male patients}
#descr(bp_data_under_twenty_male$complete_case_total_daily_hydrocortisone_equivalent_per_bsa)
#descr(bp_data_under_twenty_male$imputed_total_daily_hydrocortisone_equivalent_per_bsa)

cat("Complete case total daily hydrocortisone equivalent per bsa\n")
cat("male patients\n")
cat(
  paste0(
  round(
    mean(bp_data_under_twenty_male$complete_case_total_daily_hydrocortisone_equivalent_per_bsa, na.rm=T) ,
  digits=2)
))
cat (" (n= ")
cat(sum(!is.na(bp_data_under_twenty_male$complete_case_total_daily_hydrocortisone_equivalent_per_bsa)))
cat(")\n")
cat("(")
cat(
  round(
    quantile(bp_data_under_twenty_male$complete_case_total_daily_hydrocortisone_equivalent_per_bsa, 0.25, na.rm=T),
  digits=2)
)
cat(" to ")
cat(
  round(
    quantile(bp_data_under_twenty_male$complete_case_total_daily_hydrocortisone_equivalent_per_bsa, 0.75, na.rm=T),
  digits=2)
)
cat(")")

cat("\n")
cat("\n")
cat("Imputed total daily hydrocortisone equivalent per bsa\n")
cat("male patients\n")
cat(
  paste0(
  round(
    mean(bp_data_under_twenty_male$imputed_total_daily_hydrocortisone_equivalent_per_bsa, na.rm=T) ,
  digits=2)
))
cat (" (n= ")
cat(sum(!is.na(bp_data_under_twenty_male$imputed_total_daily_hydrocortisone_equivalent_per_bsa)))
cat(")\n")
cat("(")
cat(
  round(
    quantile(bp_data_under_twenty_male$imputed_total_daily_hydrocortisone_equivalent_per_bsa, 0.25, na.rm=T),
  digits=2)
)
cat(" to ")
cat(
  round(
    quantile(bp_data_under_twenty_male$imputed_total_daily_hydrocortisone_equivalent_per_bsa, 0.75, na.rm=T),
  digits=2)
)
cat(")")
```

```{r, hydrocortisone equivalent doses fema patients}
#descr(bp_data_under_twenty_fema$complete_case_total_daily_hydrocortisone_equivalent_per_bsa)
#descr(bp_data_under_twenty_fema$imputed_total_daily_hydrocortisone_equivalent_per_bsa)

cat("Complete case total daily hydrocortisone equivalent per bsa\n")
cat("fema patients\n")
cat(
  paste0(
  round(
    mean(bp_data_under_twenty_fema$complete_case_total_daily_hydrocortisone_equivalent_per_bsa, na.rm=T) ,
  digits=2)
))
cat (" (n= ")
cat(sum(!is.na(bp_data_under_twenty_fema$complete_case_total_daily_hydrocortisone_equivalent_per_bsa)))
cat(")\n")
cat("(")
cat(
  round(
    quantile(bp_data_under_twenty_fema$complete_case_total_daily_hydrocortisone_equivalent_per_bsa, 0.25, na.rm=T),
  digits=2)
)
cat(" to ")
cat(
  round(
    quantile(bp_data_under_twenty_fema$complete_case_total_daily_hydrocortisone_equivalent_per_bsa, 0.75, na.rm=T),
  digits=2)
)
cat(")")

cat("\n")
cat("\n")
cat("Imputed total daily hydrocortisone equivalent per bsa\n")
cat("fema patients\n")
cat(
  paste0(
  round(
    mean(bp_data_under_twenty_fema$imputed_total_daily_hydrocortisone_equivalent_per_bsa, na.rm=T) ,
  digits=2)
))
cat (" (n= ")
cat(sum(!is.na(bp_data_under_twenty_fema$imputed_total_daily_hydrocortisone_equivalent_per_bsa)))
cat(")\n")
cat("(")
cat(
  round(
    quantile(bp_data_under_twenty_fema$imputed_total_daily_hydrocortisone_equivalent_per_bsa, 0.25, na.rm=T),
  digits=2)
)
cat(" to ")
cat(
  round(
    quantile(bp_data_under_twenty_fema$imputed_total_daily_hydrocortisone_equivalent_per_bsa, 0.75, na.rm=T),
  digits=2)
)
cat(")")
```

```{r, hydrocortisone equivalent doses not_assigned patients}
cat("Complete case total daily hydrocortisone equivalent per bsa\n")
cat("not_assigned patients\n")
cat(
  paste0(
  round(
    mean(bp_data_under_twenty_not_assigned$complete_case_total_daily_hydrocortisone_equivalent_per_bsa, na.rm=T) ,
  digits=2)
))
cat (" (n= ")
cat(sum(!is.na(bp_data_under_twenty_not_assigned$complete_case_total_daily_hydrocortisone_equivalent_per_bsa)))
cat(")\n")
cat("(")
cat(
  round(
    quantile(bp_data_under_twenty_not_assigned$complete_case_total_daily_hydrocortisone_equivalent_per_bsa, 0.25, na.rm=T),
  digits=2)
)
cat(" to ")
cat(
  round(
    quantile(bp_data_under_twenty_not_assigned$complete_case_total_daily_hydrocortisone_equivalent_per_bsa, 0.75, na.rm=T),
  digits=2)
)
cat(")")

cat("\n")
cat("\n")
cat("Imputed total daily hydrocortisone equivalent per bsa\n")
cat("not_assigned patients\n")
cat(
  paste0(
  round(
    mean(bp_data_under_twenty_not_assigned$imputed_total_daily_hydrocortisone_equivalent_per_bsa, na.rm=T) ,
  digits=2)
))
cat (" (n= ")
cat(sum(!is.na(bp_data_under_twenty_not_assigned$imputed_total_daily_hydrocortisone_equivalent_per_bsa)))
cat(")\n")
cat("(")
cat(
  round(
    quantile(bp_data_under_twenty_not_assigned$imputed_total_daily_hydrocortisone_equivalent_per_bsa, 0.25, na.rm=T),
  digits=2)
)
cat(" to ")
cat(
  round(
    quantile(bp_data_under_twenty_not_assigned$imputed_total_daily_hydrocortisone_equivalent_per_bsa, 0.75, na.rm=T),
  digits=2)
)
cat(")")
```

##############################################
mineralocorticoid dosing summary statistics
##############################################

```{r, define decimal places}
#redefine the decimal places you want for the rest of the numbers 
decimal_places <- 1
```

```{r, frequency of visits prescribed fludrocortisone All patients}
cat("All patients\n")

cat("Complete case visits prescribed fludrocortisone:\n")

#absolute number prescribed
cat(sum(bp_data_under_twenty$total_daily_fludro_dose_with_zero>0, na.rm=T))
#percentage of those prescribed
cat(paste0(" (",
    round(
      100 *sum(bp_data_under_twenty$total_daily_fludro_dose_with_zero>0, na.rm=T) /
             nrow(bp_data_under_twenty),
      digits=2),
"%)\n"))

#absolute number unknown whether prescribed
cat("[")
cat(sum(is.na(bp_data_under_twenty$total_daily_fludro_dose_with_zero)))
#percentage unknown whether prescribed
cat(paste0(", ",
    round(
      100 * sum(is.na(bp_data_under_twenty$total_daily_fludro_dose_with_zero)) /
             nrow(bp_data_under_twenty),
      digits=2),
"%]\n"))

cat("Imputed visits prescribed fludrocortisone:\n")

#absolute number prescribed
cat(sum(bp_data_under_twenty$total_daily_fludro_dose_with_zero_carried_to_use>0, na.rm=T))
#percentage of those prescribed
cat(paste0(" (",
    round(
      100 *sum(bp_data_under_twenty$total_daily_fludro_dose_with_zero_carried_to_use>0, na.rm=T) /
             nrow(bp_data_under_twenty),
      digits=2),
"%)\n"))

#absolute number unknown whether prescribed
cat("[")
cat(sum(is.na(bp_data_under_twenty$total_daily_fludro_dose_with_zero_carried_to_use)))
#percentage unknown whether prescribed
cat(paste0(", ",
    round(
      100 * sum(is.na(bp_data_under_twenty$total_daily_fludro_dose_with_zero_carried_to_use)) /
             nrow(bp_data_under_twenty),
      digits=2),
"%]\n"))


```

```{r, frequency of visits prescribed fludrocortisone male}
cat("male\n")

cat("Complete case visits prescribed fludrocortisone:\n")

#absolute number prescribed
cat(sum(bp_data_under_twenty_male$total_daily_fludro_dose_with_zero>0, na.rm=T))
#percentage of those prescribed
cat(paste0(" (",
    round(
      100 *sum(bp_data_under_twenty_male$total_daily_fludro_dose_with_zero>0, na.rm=T) /
             nrow(bp_data_under_twenty_male),
      digits=2),
"%)\n"))

#absolute number unknown whether prescribed
cat("[")
cat(sum(is.na(bp_data_under_twenty_male$total_daily_fludro_dose_with_zero)))
#percentage unknown whether prescribed
cat(paste0(", ",
    round(
      100 * sum(is.na(bp_data_under_twenty_male$total_daily_fludro_dose_with_zero)) /
             nrow(bp_data_under_twenty_male),
      digits=2),
"%]\n"))

cat("Imputed visits prescribed fludrocortisone:\n")

#absolute number prescribed
cat(sum(bp_data_under_twenty_male$total_daily_fludro_dose_with_zero_carried_to_use>0, na.rm=T))
#percentage of those prescribed
cat(paste0(" (",
    round(
      100 *sum(bp_data_under_twenty_male$total_daily_fludro_dose_with_zero_carried_to_use>0, na.rm=T) /
             nrow(bp_data_under_twenty_male),
      digits=2),
"%)\n"))

#absolute number unknown whether prescribed
cat("[")
cat(sum(is.na(bp_data_under_twenty_male$total_daily_fludro_dose_with_zero_carried_to_use)))
#percentage unknown whether prescribed
cat(paste0(", ",
    round(
      100 * sum(is.na(bp_data_under_twenty_male$total_daily_fludro_dose_with_zero_carried_to_use)) /
             nrow(bp_data_under_twenty_male),
      digits=2),
"%]\n"))


```

```{r, frequency of visits prescribed fludrocortisone fema}
cat("fema\n")

cat("Complete case visits prescribed fludrocortisone:\n")

#absolute number prescribed
cat(sum(bp_data_under_twenty_fema$total_daily_fludro_dose_with_zero>0, na.rm=T))
#percentage of those prescribed
cat(paste0(" (",
    round(
      100 *sum(bp_data_under_twenty_fema$total_daily_fludro_dose_with_zero>0, na.rm=T) /
             nrow(bp_data_under_twenty_fema),
      digits=2),
"%)\n"))

#absolute number unknown whether prescribed
cat("[")
cat(sum(is.na(bp_data_under_twenty_fema$total_daily_fludro_dose_with_zero)))
#percentage unknown whether prescribed
cat(paste0(", ",
    round(
      100 * sum(is.na(bp_data_under_twenty_fema$total_daily_fludro_dose_with_zero)) /
             nrow(bp_data_under_twenty_fema),
      digits=2),
"%]\n"))

cat("Imputed visits prescribed fludrocortisone:\n")

#absolute number prescribed
cat(sum(bp_data_under_twenty_fema$total_daily_fludro_dose_with_zero_carried_to_use>0, na.rm=T))
#percentage of those prescribed
cat(paste0(" (",
    round(
      100 *sum(bp_data_under_twenty_fema$total_daily_fludro_dose_with_zero_carried_to_use>0, na.rm=T) /
             nrow(bp_data_under_twenty_fema),
      digits=2),
"%)\n"))

#absolute number unknown whether prescribed
cat("[")
cat(sum(is.na(bp_data_under_twenty_fema$total_daily_fludro_dose_with_zero_carried_to_use)))
#percentage unknown whether prescribed
cat(paste0(", ",
    round(
      100 * sum(is.na(bp_data_under_twenty_fema$total_daily_fludro_dose_with_zero_carried_to_use)) /
             nrow(bp_data_under_twenty_fema),
      digits=2),
"%]\n"))


```

```{r, frequency of visits prescribed fludrocortisone not_assigned}
cat("not_assigned\n")

cat("Complete case visits prescribed fludrocortisone:\n")

#absolute number prescribed
cat(sum(bp_data_under_twenty_not_assigned$total_daily_fludro_dose_with_zero>0, na.rm=T))
#percentage of those prescribed
cat(paste0(" (",
    round(
      100 *sum(bp_data_under_twenty_not_assigned$total_daily_fludro_dose_with_zero>0, na.rm=T) /
             nrow(bp_data_under_twenty_not_assigned),
      digits=2),
"%)\n"))

#absolute number unknown whether prescribed
cat("[")
cat(sum(is.na(bp_data_under_twenty_not_assigned$total_daily_fludro_dose_with_zero)))
#percentage unknown whether prescribed
cat(paste0(", ",
    round(
      100 * sum(is.na(bp_data_under_twenty_not_assigned$total_daily_fludro_dose_with_zero)) /
             nrow(bp_data_under_twenty_not_assigned),
      digits=2),
"%]\n"))

cat("Imputed visits prescribed fludrocortisone:\n")

#absolute number prescribed
cat(sum(bp_data_under_twenty_not_assigned$total_daily_fludro_dose_with_zero_carried_to_use>0, na.rm=T))
#percentage of those prescribed
cat(paste0(" (",
    round(
      100 *sum(bp_data_under_twenty_not_assigned$total_daily_fludro_dose_with_zero_carried_to_use>0, na.rm=T) /
             nrow(bp_data_under_twenty_not_assigned),
      digits=2),
"%)\n"))

#absolute number unknown whether prescribed
cat("[")
cat(sum(is.na(bp_data_under_twenty_not_assigned$total_daily_fludro_dose_with_zero_carried_to_use)))
#percentage unknown whether prescribed
cat(paste0(", ",
    round(
      100 * sum(is.na(bp_data_under_twenty_not_assigned$total_daily_fludro_dose_with_zero_carried_to_use)) /
             nrow(bp_data_under_twenty_not_assigned),
      digits=2),
"%]\n"))


```

##############################################
mineralocorticoid dosing absolute amounts prescribed
##############################################

```{r, define decimal places}
#redefine the decimal places you want for the rest of the numbers 
decimal_places <- 1
```

```{r, doses of fludrocortisone absolute in those prescribed it in all patients}

nrow(subset(bp_data_under_twenty, 
       total_daily_fludro_dose_with_zero>0))

cat("Complete case absolute total daily fludrocortisone in those taking it\n")
cat("all patient cohort\n")
cat(
  paste0(
  round(
    mean(subset(bp_data_under_twenty, 
       total_daily_fludro_dose_with_zero>0)$total_daily_fludro_dose_with_zero) ,
  digits=2)
))
cat (" (n= ")
cat(nrow(subset(bp_data_under_twenty, 
       total_daily_fludro_dose_with_zero>0)))
cat(")\n")
cat("(")
cat(
  round(
    quantile(subset(bp_data_under_twenty, 
       total_daily_fludro_dose_with_zero>0)$total_daily_fludro_dose_with_zero, 0.25, na.rm=T),
  digits=2)
)
cat(" to ")
cat(
  round(
    quantile(subset(bp_data_under_twenty, 
       total_daily_fludro_dose_with_zero>0)$total_daily_fludro_dose_with_zero, 0.75, na.rm=T),
  digits=2)
)
cat(")")

cat("\n")
cat("\n")
cat("Imputed absolute total daily fludrocortisone in those who are taking it\n")
cat("all patients\n")
cat(
  paste0(
  round(
    mean(subset(bp_data_under_twenty, 
       total_daily_fludro_dose_with_zero_carried_to_use>0)$total_daily_fludro_dose_with_zero_carried_to_use) ,
  digits=2)
))
cat (" (n= ")
cat(nrow(subset(bp_data_under_twenty, 
       total_daily_fludro_dose_with_zero_carried_to_use>0)))
cat(")\n")
cat("(")
cat(
  round(
    quantile(subset(bp_data_under_twenty, 
       total_daily_fludro_dose_with_zero_carried_to_use>0)$total_daily_fludro_dose_with_zero_carried_to_use, 0.25, na.rm=T),
  digits=2)
)
cat(" to ")
cat(
  round(
    quantile(subset(bp_data_under_twenty, 
       total_daily_fludro_dose_with_zero_carried_to_use>0)$total_daily_fludro_dose_with_zero_carried_to_use, 0.75, na.rm=T),
  digits=2)
)
cat(")")

```

```{r, doses of fludrocortisone absolute in those prescribed it in male patients}
nrow(subset(bp_data_under_twenty_male, 
       total_daily_fludro_dose_with_zero>0))

cat("Complete case absolute total daily fludrocortisone in those taking it\n")
cat("all patient cohort\n")
cat(
  paste0(
  round(
    mean(subset(bp_data_under_twenty_male, 
       total_daily_fludro_dose_with_zero>0)$total_daily_fludro_dose_with_zero) ,
  digits=2)
))
cat (" (n= ")
cat(nrow(subset(bp_data_under_twenty_male, 
       total_daily_fludro_dose_with_zero>0)))
cat(")\n")
cat("(")
cat(
  round(
    quantile(subset(bp_data_under_twenty_male, 
       total_daily_fludro_dose_with_zero>0)$total_daily_fludro_dose_with_zero, 0.25, na.rm=T),
  digits=2)
)
cat(" to ")
cat(
  round(
    quantile(subset(bp_data_under_twenty_male, 
       total_daily_fludro_dose_with_zero>0)$total_daily_fludro_dose_with_zero, 0.75, na.rm=T),
  digits=2)
)
cat(")")

cat("\n")
cat("\n")
cat("Imputed absolute total daily fludrocortisone in those who are taking it\n")
cat("male patients\n")
cat(
  paste0(
  round(
    mean(subset(bp_data_under_twenty_male, 
       total_daily_fludro_dose_with_zero_carried_to_use>0)$total_daily_fludro_dose_with_zero_carried_to_use) ,
  digits=2)
))
cat (" (n= ")
cat(nrow(subset(bp_data_under_twenty_male, 
       total_daily_fludro_dose_with_zero_carried_to_use>0)))
cat(")\n")
cat("(")
cat(
  round(
    quantile(subset(bp_data_under_twenty_male, 
       total_daily_fludro_dose_with_zero_carried_to_use>0)$total_daily_fludro_dose_with_zero_carried_to_use, 0.25, na.rm=T),
  digits=2)
)
cat(" to ")
cat(
  round(
    quantile(subset(bp_data_under_twenty_male, 
       total_daily_fludro_dose_with_zero_carried_to_use>0)$total_daily_fludro_dose_with_zero_carried_to_use, 0.75, na.rm=T),
  digits=2)
)
cat(")")

```

```{r, doses of fludrocortisone absolute in those prescribed it in fema patients}
nrow(subset(bp_data_under_twenty_fema, 
       total_daily_fludro_dose_with_zero>0))

cat("Complete case absolute total daily fludrocortisone in those taking it\n")
cat("all patient cohort\n")
cat(
  paste0(
  round(
    mean(subset(bp_data_under_twenty_fema, 
       total_daily_fludro_dose_with_zero>0)$total_daily_fludro_dose_with_zero) ,
  digits=2)
))
cat (" (n= ")
cat(nrow(subset(bp_data_under_twenty_fema, 
       total_daily_fludro_dose_with_zero>0)))
cat(")\n")
cat("(")
cat(
  round(
    quantile(subset(bp_data_under_twenty_fema, 
       total_daily_fludro_dose_with_zero>0)$total_daily_fludro_dose_with_zero, 0.25, na.rm=T),
  digits=2)
)
cat(" to ")
cat(
  round(
    quantile(subset(bp_data_under_twenty_fema, 
       total_daily_fludro_dose_with_zero>0)$total_daily_fludro_dose_with_zero, 0.75, na.rm=T),
  digits=2)
)
cat(")")

cat("\n")
cat("\n")
cat("Imputed absolute total daily fludrocortisone in those who are taking it\n")
cat("fema patients\n")
cat(
  paste0(
  round(
    mean(subset(bp_data_under_twenty_fema, 
       total_daily_fludro_dose_with_zero_carried_to_use>0)$total_daily_fludro_dose_with_zero_carried_to_use) ,
  digits=2)
))
cat (" (n= ")
cat(nrow(subset(bp_data_under_twenty_fema, 
       total_daily_fludro_dose_with_zero_carried_to_use>0)))
cat(")\n")
cat("(")
cat(
  round(
    quantile(subset(bp_data_under_twenty_fema, 
       total_daily_fludro_dose_with_zero_carried_to_use>0)$total_daily_fludro_dose_with_zero_carried_to_use, 0.25, na.rm=T),
  digits=2)
)
cat(" to ")
cat(
  round(
    quantile(subset(bp_data_under_twenty_fema, 
       total_daily_fludro_dose_with_zero_carried_to_use>0)$total_daily_fludro_dose_with_zero_carried_to_use, 0.75, na.rm=T),
  digits=2)
)
cat(")")

```

```{r, doses of fludrocortisone absolute in those prescribed it in not_assigned patients}

nrow(subset(bp_data_under_twenty_not_assigned, 
       total_daily_fludro_dose_with_zero>0))

cat("Complete case absolute total daily fludrocortisone in those taking it\n")
cat("all patient cohort\n")
cat(
  paste0(
  round(
    mean(subset(bp_data_under_twenty_not_assigned, 
       total_daily_fludro_dose_with_zero>0)$total_daily_fludro_dose_with_zero) ,
  digits=2)
))
cat (" (n= ")
cat(nrow(subset(bp_data_under_twenty_not_assigned, 
       total_daily_fludro_dose_with_zero>0)))
cat(")\n")
cat("(")
cat(
  round(
    quantile(subset(bp_data_under_twenty_not_assigned, 
       total_daily_fludro_dose_with_zero>0)$total_daily_fludro_dose_with_zero, 0.25, na.rm=T),
  digits=2)
)
cat(" to ")
cat(
  round(
    quantile(subset(bp_data_under_twenty_not_assigned, 
       total_daily_fludro_dose_with_zero>0)$total_daily_fludro_dose_with_zero, 0.75, na.rm=T),
  digits=2)
)
cat(")")

cat("\n")
cat("\n")
cat("Imputed absolute total daily fludrocortisone in those who are taking it\n")
cat("not_assigned patients\n")
cat(
  paste0(
  round(
    mean(subset(bp_data_under_twenty_not_assigned, 
       total_daily_fludro_dose_with_zero_carried_to_use>0)$total_daily_fludro_dose_with_zero_carried_to_use) ,
  digits=2)
))
cat (" (n= ")
cat(nrow(subset(bp_data_under_twenty_not_assigned, 
       total_daily_fludro_dose_with_zero_carried_to_use>0)))
cat(")\n")
cat("(")
cat(
  round(
    quantile(subset(bp_data_under_twenty_not_assigned, 
       total_daily_fludro_dose_with_zero_carried_to_use>0)$total_daily_fludro_dose_with_zero_carried_to_use, 0.25, na.rm=T),
  digits=2)
)
cat(" to ")
cat(
  round(
    quantile(subset(bp_data_under_twenty_not_assigned, 
       total_daily_fludro_dose_with_zero_carried_to_use>0)$total_daily_fludro_dose_with_zero_carried_to_use, 0.75, na.rm=T),
  digits=2)
)
cat(")")

```



##############################################
mineralocorticoid dosing per bsa amounts prescribed
##############################################

```{r, define decimal places}
#redefine the decimal places you want for the rest of the numbers 
decimal_places <- 1
```

```{r, doses of fludrocortisone absolute in those prescribed it in all patients}

cat("Complete case absolute total daily fludrocortisone in those taking it\n")
cat("all patient cohort\n")
cat(
  paste0(
  round(
    mean(subset(bp_data_under_twenty, 
       complete_case_total_daily_fludrocortisone_per_bsa>0)$complete_case_total_daily_fludrocortisone_per_bsa) ,
  digits=2)
))
cat (" (n= ")
cat(nrow(subset(bp_data_under_twenty, 
       complete_case_total_daily_fludrocortisone_per_bsa>0)))
cat(")\n")
cat("(")
cat(
  round(
    quantile(subset(bp_data_under_twenty, 
       complete_case_total_daily_fludrocortisone_per_bsa>0)$complete_case_total_daily_fludrocortisone_per_bsa, 0.25, na.rm=T),
  digits=2)
)
cat(" to ")
cat(
  round(
    quantile(subset(bp_data_under_twenty, 
       complete_case_total_daily_fludrocortisone_per_bsa>0)$complete_case_total_daily_fludrocortisone_per_bsa, 0.75, na.rm=T),
  digits=2)
)
cat(")")

cat("\n")
cat("\n")
cat("Imputed absolute total daily fludrocortisone in those who are taking it\n")
cat("all patients\n")
cat(
  paste0(
  round(
    mean(subset(bp_data_under_twenty, 
       imputed_total_daily_fludrocortisone_per_bsa>0)$imputed_total_daily_fludrocortisone_per_bsa) ,
  digits=2)
))
cat (" (n= ")
cat(nrow(subset(bp_data_under_twenty, 
       imputed_total_daily_fludrocortisone_per_bsa>0)))
cat(")\n")
cat("(")
cat(
  round(
    quantile(subset(bp_data_under_twenty, 
       imputed_total_daily_fludrocortisone_per_bsa>0)$imputed_total_daily_fludrocortisone_per_bsa, 0.25, na.rm=T),
  digits=2)
)
cat(" to ")
cat(
  round(
    quantile(subset(bp_data_under_twenty, 
       imputed_total_daily_fludrocortisone_per_bsa>0)$imputed_total_daily_fludrocortisone_per_bsa, 0.75, na.rm=T),
  digits=2)
)
cat(")")

```

```{r, doses of fludrocortisone absolute in those prescribed it in male patients}

cat("Complete case absolute total daily fludrocortisone in those taking it\n")
cat("all patient cohort\n")
cat(
  paste0(
  round(
    mean(subset(bp_data_under_twenty_male, 
       complete_case_total_daily_fludrocortisone_per_bsa>0)$complete_case_total_daily_fludrocortisone_per_bsa) ,
  digits=2)
))
cat (" (n= ")
cat(nrow(subset(bp_data_under_twenty_male, 
       complete_case_total_daily_fludrocortisone_per_bsa>0)))
cat(")\n")
cat("(")
cat(
  round(
    quantile(subset(bp_data_under_twenty_male, 
       complete_case_total_daily_fludrocortisone_per_bsa>0)$complete_case_total_daily_fludrocortisone_per_bsa, 0.25, na.rm=T),
  digits=2)
)
cat(" to ")
cat(
  round(
    quantile(subset(bp_data_under_twenty_male, 
       complete_case_total_daily_fludrocortisone_per_bsa>0)$complete_case_total_daily_fludrocortisone_per_bsa, 0.75, na.rm=T),
  digits=2)
)
cat(")")

cat("\n")
cat("\n")
cat("Imputed absolute total daily fludrocortisone in those who are taking it\n")
cat("male patients\n")
cat(
  paste0(
  round(
    mean(subset(bp_data_under_twenty_male, 
       imputed_total_daily_fludrocortisone_per_bsa>0)$imputed_total_daily_fludrocortisone_per_bsa) ,
  digits=2)
))
cat (" (n= ")
cat(nrow(subset(bp_data_under_twenty_male, 
       imputed_total_daily_fludrocortisone_per_bsa>0)))
cat(")\n")
cat("(")
cat(
  round(
    quantile(subset(bp_data_under_twenty_male, 
       imputed_total_daily_fludrocortisone_per_bsa>0)$imputed_total_daily_fludrocortisone_per_bsa, 0.25, na.rm=T),
  digits=2)
)
cat(" to ")
cat(
  round(
    quantile(subset(bp_data_under_twenty_male, 
       imputed_total_daily_fludrocortisone_per_bsa>0)$imputed_total_daily_fludrocortisone_per_bsa, 0.75, na.rm=T),
  digits=2)
)
cat(")")

```

```{r, doses of fludrocortisone absolute in those prescribed it in fema patients}

cat("Complete case absolute total daily fludrocortisone in those taking it\n")
cat("all patient cohort\n")
cat(
  paste0(
  round(
    mean(subset(bp_data_under_twenty_fema, 
       complete_case_total_daily_fludrocortisone_per_bsa>0)$complete_case_total_daily_fludrocortisone_per_bsa) ,
  digits=2)
))
cat (" (n= ")
cat(nrow(subset(bp_data_under_twenty_fema, 
       complete_case_total_daily_fludrocortisone_per_bsa>0)))
cat(")\n")
cat("(")
cat(
  round(
    quantile(subset(bp_data_under_twenty_fema, 
       complete_case_total_daily_fludrocortisone_per_bsa>0)$complete_case_total_daily_fludrocortisone_per_bsa, 0.25, na.rm=T),
  digits=2)
)
cat(" to ")
cat(
  round(
    quantile(subset(bp_data_under_twenty_fema, 
       complete_case_total_daily_fludrocortisone_per_bsa>0)$complete_case_total_daily_fludrocortisone_per_bsa, 0.75, na.rm=T),
  digits=2)
)
cat(")")

cat("\n")
cat("\n")
cat("Imputed absolute total daily fludrocortisone in those who are taking it\n")
cat("fema patients\n")
cat(
  paste0(
  round(
    mean(subset(bp_data_under_twenty_fema, 
       imputed_total_daily_fludrocortisone_per_bsa>0)$imputed_total_daily_fludrocortisone_per_bsa) ,
  digits=2)
))
cat (" (n= ")
cat(nrow(subset(bp_data_under_twenty_fema, 
       imputed_total_daily_fludrocortisone_per_bsa>0)))
cat(")\n")
cat("(")
cat(
  round(
    quantile(subset(bp_data_under_twenty_fema, 
       imputed_total_daily_fludrocortisone_per_bsa>0)$imputed_total_daily_fludrocortisone_per_bsa, 0.25, na.rm=T),
  digits=2)
)
cat(" to ")
cat(
  round(
    quantile(subset(bp_data_under_twenty_fema, 
       imputed_total_daily_fludrocortisone_per_bsa>0)$imputed_total_daily_fludrocortisone_per_bsa, 0.75, na.rm=T),
  digits=2)
)
cat(")")

```

```{r, doses of fludrocortisone absolute in those prescribed it in not_assigned patients}

cat("Complete case absolute total daily fludrocortisone in those taking it\n")
cat("all patient cohort\n")
cat(
  paste0(
  round(
    mean(subset(bp_data_under_twenty_not_assigned, 
       complete_case_total_daily_fludrocortisone_per_bsa>0)$complete_case_total_daily_fludrocortisone_per_bsa) ,
  digits=2)
))
cat (" (n= ")
cat(nrow(subset(bp_data_under_twenty_not_assigned, 
       complete_case_total_daily_fludrocortisone_per_bsa>0)))
cat(")\n")
cat("(")
cat(
  round(
    quantile(subset(bp_data_under_twenty_not_assigned, 
       complete_case_total_daily_fludrocortisone_per_bsa>0)$complete_case_total_daily_fludrocortisone_per_bsa, 0.25, na.rm=T),
  digits=2)
)
cat(" to ")
cat(
  round(
    quantile(subset(bp_data_under_twenty_not_assigned, 
       complete_case_total_daily_fludrocortisone_per_bsa>0)$complete_case_total_daily_fludrocortisone_per_bsa, 0.75, na.rm=T),
  digits=2)
)
cat(")")

cat("\n")
cat("\n")
cat("Imputed absolute total daily fludrocortisone in those who are taking it\n")
cat("not_assigned patients\n")
cat(
  paste0(
  round(
    mean(subset(bp_data_under_twenty_not_assigned, 
       imputed_total_daily_fludrocortisone_per_bsa>0)$imputed_total_daily_fludrocortisone_per_bsa) ,
  digits=2)
))
cat (" (n= ")
cat(nrow(subset(bp_data_under_twenty_not_assigned, 
       imputed_total_daily_fludrocortisone_per_bsa>0)))
cat(")\n")
cat("(")
cat(
  round(
    quantile(subset(bp_data_under_twenty_not_assigned, 
       imputed_total_daily_fludrocortisone_per_bsa>0)$imputed_total_daily_fludrocortisone_per_bsa, 0.25, na.rm=T),
  digits=2)
)
cat(" to ")
cat(
  round(
    quantile(subset(bp_data_under_twenty_not_assigned, 
       imputed_total_daily_fludrocortisone_per_bsa>0)$imputed_total_daily_fludrocortisone_per_bsa, 0.75, na.rm=T),
  digits=2)
)
cat(")")

```


```{r, define decimal places}
#redefine the decimal places you want for the rest of the numbers 
decimal_places <- 1
```

```{r, frequency of visits with reported salt prescription All patients although some dont have a known dose}
cat("Please note, I recommend reporting those with a known dose in table 1, but these are calculated here for completeness")

cat("All patients\n")

cat("Complete case visits reported as prescribed salt:\n")

#absolute number prescribed
cat(sum(bp_data_under_twenty$Salt.replacement...Current.Medication=="Yes", na.rm=T))
#percentage of those prescribed
cat(paste0(" (",
    round(
      100 * sum(bp_data_under_twenty$Salt.replacement...Current.Medication=="Yes", na.rm=T) /
             nrow(bp_data_under_twenty),
      digits=2),
"%)\n"))

#absolute number unknown whether prescribed
cat("[")
cat(sum(is.na(bp_data_under_twenty$Salt.replacement...Current.Medication) |
                bp_data_under_twenty$Salt.replacement...Current.Medication=="Not known"))
#percentage unknown whether prescribed
cat(paste0(", ",
    round(
      100 * sum(is.na(bp_data_under_twenty$Salt.replacement...Current.Medication) |
                bp_data_under_twenty$Salt.replacement...Current.Medication=="Not known") /
             nrow(bp_data_under_twenty),
      digits=2),
"%]\n"))

cat("Imputed visits reported as prescribed salt:\n")

#absolute number prescribed
cat(sum(bp_data_under_twenty$Salt.replacement...Current.Medication_carried_to_use=="Yes", na.rm=T))
#percentage of those prescribed
cat(paste0(" (",
    round(
      100 * sum(bp_data_under_twenty$Salt.replacement...Current.Medication_carried_to_use=="Yes", na.rm=T) /
             nrow(bp_data_under_twenty),
      digits=2),
"%)\n"))

#absolute number unknown whether prescribed
cat("[")
cat(sum(is.na(bp_data_under_twenty$Salt.replacement...Current.Medication_carried_to_use) |
                bp_data_under_twenty$Salt.replacement...Current.Medication_carried_to_use=="Not known"))
#percentage unknown whether prescribed
cat(paste0(", ",
    round(
      100 * sum(is.na(bp_data_under_twenty$Salt.replacement...Current.Medication_carried_to_use) |
                bp_data_under_twenty$Salt.replacement...Current.Medication_carried_to_use=="Not known") /
             nrow(bp_data_under_twenty),
      digits=2),
"%]\n"))


```


```{r, frequency of visits with reported salt prescription male patients although some dont have a known dose}
cat("Please note, I recommend reporting those with a known dose in table 1, but these are calculated here for completeness")

cat("male patients\n")

cat("Complete case visits reported as prescribed salt:\n")

#absolute number prescribed
cat(sum(bp_data_under_twenty_male$Salt.replacement...Current.Medication=="Yes", na.rm=T))
#percentage of those prescribed
cat(paste0(" (",
    round(
      100 * sum(bp_data_under_twenty_male$Salt.replacement...Current.Medication=="Yes", na.rm=T) /
             nrow(bp_data_under_twenty_male),
      digits=2),
"%)\n"))

#absolute number unknown whether prescribed
cat("[")
cat(sum(is.na(bp_data_under_twenty_male$Salt.replacement...Current.Medication) |
                bp_data_under_twenty_male$Salt.replacement...Current.Medication=="Not known"))
#percentage unknown whether prescribed
cat(paste0(", ",
    round(
      100 * sum(is.na(bp_data_under_twenty_male$Salt.replacement...Current.Medication) |
                bp_data_under_twenty_male$Salt.replacement...Current.Medication=="Not known") /
             nrow(bp_data_under_twenty_male),
      digits=2),
"%]\n"))

cat("Imputed visits reported as prescribed salt:\n")

#absolute number prescribed
cat(sum(bp_data_under_twenty_male$Salt.replacement...Current.Medication_carried_to_use=="Yes", na.rm=T))
#percentage of those prescribed
cat(paste0(" (",
    round(
      100 * sum(bp_data_under_twenty_male$Salt.replacement...Current.Medication_carried_to_use=="Yes", na.rm=T) /
             nrow(bp_data_under_twenty_male),
      digits=2),
"%)\n"))

#absolute number unknown whether prescribed
cat("[")
cat(sum(is.na(bp_data_under_twenty_male$Salt.replacement...Current.Medication_carried_to_use) |
                bp_data_under_twenty_male$Salt.replacement...Current.Medication_carried_to_use=="Not known"))
#percentage unknown whether prescribed
cat(paste0(", ",
    round(
      100 * sum(is.na(bp_data_under_twenty_male$Salt.replacement...Current.Medication_carried_to_use) |
                bp_data_under_twenty_male$Salt.replacement...Current.Medication_carried_to_use=="Not known") /
             nrow(bp_data_under_twenty_male),
      digits=2),
"%]\n"))


```



```{r, frequency of visits with reported salt prescription fema patients although some dont have a known dose}
cat("Please note, I recommend reporting those with a known dose in table 1, but these are calculated here for completeness")

cat("fema patients\n")

cat("Complete case visits reported as prescribed salt:\n")

#absolute number prescribed
cat(sum(bp_data_under_twenty_fema$Salt.replacement...Current.Medication=="Yes", na.rm=T))
#percentage of those prescribed
cat(paste0(" (",
    round(
      100 * sum(bp_data_under_twenty_fema$Salt.replacement...Current.Medication=="Yes", na.rm=T) /
             nrow(bp_data_under_twenty_fema),
      digits=2),
"%)\n"))

#absolute number unknown whether prescribed
cat("[")
cat(sum(is.na(bp_data_under_twenty_fema$Salt.replacement...Current.Medication) |
                bp_data_under_twenty_fema$Salt.replacement...Current.Medication=="Not known"))
#percentage unknown whether prescribed
cat(paste0(", ",
    round(
      100 * sum(is.na(bp_data_under_twenty_fema$Salt.replacement...Current.Medication) |
                bp_data_under_twenty_fema$Salt.replacement...Current.Medication=="Not known") /
             nrow(bp_data_under_twenty_fema),
      digits=2),
"%]\n"))

cat("Imputed visits reported as prescribed salt:\n")

#absolute number prescribed
cat(sum(bp_data_under_twenty_fema$Salt.replacement...Current.Medication_carried_to_use=="Yes", na.rm=T))
#percentage of those prescribed
cat(paste0(" (",
    round(
      100 * sum(bp_data_under_twenty_fema$Salt.replacement...Current.Medication_carried_to_use=="Yes", na.rm=T) /
             nrow(bp_data_under_twenty_fema),
      digits=2),
"%)\n"))

#absolute number unknown whether prescribed
cat("[")
cat(sum(is.na(bp_data_under_twenty_fema$Salt.replacement...Current.Medication_carried_to_use) |
                bp_data_under_twenty_fema$Salt.replacement...Current.Medication_carried_to_use=="Not known"))
#percentage unknown whether prescribed
cat(paste0(", ",
    round(
      100 * sum(is.na(bp_data_under_twenty_fema$Salt.replacement...Current.Medication_carried_to_use) |
                bp_data_under_twenty_fema$Salt.replacement...Current.Medication_carried_to_use=="Not known") /
             nrow(bp_data_under_twenty_fema),
      digits=2),
"%]\n"))


```



```{r, frequency of visits with reported salt prescription not_assigned patients although some dont have a known dose}
cat("Please note, I recommend reporting those with a known dose in table 1, but these are calculated here for completeness")

cat("not_assigned patients\n")

cat("Complete case visits reported as prescribed salt:\n")

#absolute number prescribed
cat(sum(bp_data_under_twenty_not_assigned$Salt.replacement...Current.Medication=="Yes", na.rm=T))
#percentage of those prescribed
cat(paste0(" (",
    round(
      100 * sum(bp_data_under_twenty_not_assigned$Salt.replacement...Current.Medication=="Yes", na.rm=T) /
             nrow(bp_data_under_twenty_not_assigned),
      digits=2),
"%)\n"))

#absolute number unknown whether prescribed
cat("[")
cat(sum(is.na(bp_data_under_twenty_not_assigned$Salt.replacement...Current.Medication) |
                bp_data_under_twenty_not_assigned$Salt.replacement...Current.Medication=="Not known"))
#percentage unknown whether prescribed
cat(paste0(", ",
    round(
      100 * sum(is.na(bp_data_under_twenty_not_assigned$Salt.replacement...Current.Medication) |
                bp_data_under_twenty_not_assigned$Salt.replacement...Current.Medication=="Not known") /
             nrow(bp_data_under_twenty_not_assigned),
      digits=2),
"%]\n"))

cat("Imputed visits reported as prescribed salt:\n")

#absolute number prescribed
cat(sum(bp_data_under_twenty_not_assigned$Salt.replacement...Current.Medication_carried_to_use=="Yes", na.rm=T))
#percentage of those prescribed
cat(paste0(" (",
    round(
      100 * sum(bp_data_under_twenty_not_assigned$Salt.replacement...Current.Medication_carried_to_use=="Yes", na.rm=T) /
             nrow(bp_data_under_twenty_not_assigned),
      digits=2),
"%)\n"))

#absolute number unknown whether prescribed
cat("[")
cat(sum(is.na(bp_data_under_twenty_not_assigned$Salt.replacement...Current.Medication_carried_to_use) |
                bp_data_under_twenty_not_assigned$Salt.replacement...Current.Medication_carried_to_use=="Not known"))
#percentage unknown whether prescribed
cat(paste0(", ",
    round(
      100 * sum(is.na(bp_data_under_twenty_not_assigned$Salt.replacement...Current.Medication_carried_to_use) |
                bp_data_under_twenty_not_assigned$Salt.replacement...Current.Medication_carried_to_use=="Not known") /
             nrow(bp_data_under_twenty_not_assigned),
      digits=2),
"%]\n"))


```


##############################################
Reported as taking salt, with a precise dose
##############################################

```{r, define decimal places}
#redefine the decimal places you want for the rest of the numbers 
decimal_places <- 1
```


```{r, frequency of visits prescribed salt with a known dose All patients}
cat("All patients\n")

cat("Complete case visits prescribed salt with a known dose:\n")

#absolute number prescribed
cat(sum(bp_data_under_twenty$total_daily_salt_dose_with_zero >0, na.rm=T))
#percentage of those prescribed
cat(paste0(" (",
    round(
      100 *sum(bp_data_under_twenty$total_daily_salt_dose_with_zero>0, na.rm=T) /
             nrow(bp_data_under_twenty),
      digits=2),
"%)\n"))

#absolute number unknown whether prescribed
cat("[")
cat(sum(is.na(bp_data_under_twenty$total_daily_salt_dose_with_zero)))
#percentage unknown whether prescribed
cat(paste0(", ",
    round(
      100 * sum(is.na(bp_data_under_twenty$total_daily_salt_dose_with_zero)) /
             nrow(bp_data_under_twenty),
      digits=2),
"%]\n"))

cat("Imputed visits prescribed salt with a known dose:\n")

#absolute number prescribed
cat(sum(bp_data_under_twenty$total_daily_salt_dose_with_zero_carried_to_use>0, na.rm=T))
#percentage of those prescribed
cat(paste0(" (",
    round(
      100 *sum(bp_data_under_twenty$total_daily_salt_dose_with_zero_carried_to_use>0, na.rm=T) /
             nrow(bp_data_under_twenty),
      digits=2),
"%)\n"))

#absolute number unknown whether prescribed
cat("[")
cat(sum(is.na(bp_data_under_twenty$total_daily_salt_dose_with_zero_carried_to_use)))
#percentage unknown whether prescribed
cat(paste0(", ",
    round(
      100 * sum(is.na(bp_data_under_twenty$total_daily_salt_dose_with_zero_carried_to_use)) /
             nrow(bp_data_under_twenty),
      digits=2),
"%]\n"))


```


```{r, frequency of visits prescribed salt with a known dose male patients}
cat("male patients\n")

cat("Complete case visits prescribed salt with a known dose:\n")

#absolute number prescribed
cat(sum(bp_data_under_twenty_male$total_daily_salt_dose_with_zero >0, na.rm=T))
#percentage of those prescribed
cat(paste0(" (",
    round(
      100 *sum(bp_data_under_twenty_male$total_daily_salt_dose_with_zero>0, na.rm=T) /
             nrow(bp_data_under_twenty_male),
      digits=2),
"%)\n"))

#absolute number unknown whether prescribed
cat("[")
cat(sum(is.na(bp_data_under_twenty_male$total_daily_salt_dose_with_zero)))
#percentage unknown whether prescribed
cat(paste0(", ",
    round(
      100 * sum(is.na(bp_data_under_twenty_male$total_daily_salt_dose_with_zero)) /
             nrow(bp_data_under_twenty_male),
      digits=2),
"%]\n"))

cat("Imputed visits prescribed salt with a known dose:\n")

#absolute number prescribed
cat(sum(bp_data_under_twenty_male$total_daily_salt_dose_with_zero_carried_to_use>0, na.rm=T))
#percentage of those prescribed
cat(paste0(" (",
    round(
      100 *sum(bp_data_under_twenty_male$total_daily_salt_dose_with_zero_carried_to_use>0, na.rm=T) /
             nrow(bp_data_under_twenty_male),
      digits=2),
"%)\n"))

#absolute number unknown whether prescribed
cat("[")
cat(sum(is.na(bp_data_under_twenty_male$total_daily_salt_dose_with_zero_carried_to_use)))
#percentage unknown whether prescribed
cat(paste0(", ",
    round(
      100 * sum(is.na(bp_data_under_twenty_male$total_daily_salt_dose_with_zero_carried_to_use)) /
             nrow(bp_data_under_twenty_male),
      digits=2),
"%]\n"))


```


```{r, frequency of visits prescribed salt with a known dose fema patients}
cat("fema patients\n")

cat("Complete case visits prescribed salt with a known dose:\n")

#absolute number prescribed
cat(sum(bp_data_under_twenty_fema$total_daily_salt_dose_with_zero >0, na.rm=T))
#percentage of those prescribed
cat(paste0(" (",
    round(
      100 *sum(bp_data_under_twenty_fema$total_daily_salt_dose_with_zero>0, na.rm=T) /
             nrow(bp_data_under_twenty_fema),
      digits=2),
"%)\n"))

#absolute number unknown whether prescribed
cat("[")
cat(sum(is.na(bp_data_under_twenty_fema$total_daily_salt_dose_with_zero)))
#percentage unknown whether prescribed
cat(paste0(", ",
    round(
      100 * sum(is.na(bp_data_under_twenty_fema$total_daily_salt_dose_with_zero)) /
             nrow(bp_data_under_twenty_fema),
      digits=2),
"%]\n"))

cat("Imputed visits prescribed salt with a known dose:\n")

#absolute number prescribed
cat(sum(bp_data_under_twenty_fema$total_daily_salt_dose_with_zero_carried_to_use>0, na.rm=T))
#percentage of those prescribed
cat(paste0(" (",
    round(
      100 *sum(bp_data_under_twenty_fema$total_daily_salt_dose_with_zero_carried_to_use>0, na.rm=T) /
             nrow(bp_data_under_twenty_fema),
      digits=2),
"%)\n"))

#absolute number unknown whether prescribed
cat("[")
cat(sum(is.na(bp_data_under_twenty_fema$total_daily_salt_dose_with_zero_carried_to_use)))
#percentage unknown whether prescribed
cat(paste0(", ",
    round(
      100 * sum(is.na(bp_data_under_twenty_fema$total_daily_salt_dose_with_zero_carried_to_use)) /
             nrow(bp_data_under_twenty_fema),
      digits=2),
"%]\n"))


```


```{r, frequency of visits prescribed salt with a known dose not_assigned patients}
cat("not_assigned patients\n")

cat("Complete case visits prescribed salt with a known dose:\n")

#absolute number prescribed
cat(sum(bp_data_under_twenty_not_assigned$total_daily_salt_dose_with_zero >0, na.rm=T))
#percentage of those prescribed
cat(paste0(" (",
    round(
      100 * sum(bp_data_under_twenty_not_assigned$total_daily_salt_dose_with_zero>0, na.rm=T) /
             nrow(bp_data_under_twenty_not_assigned),
      digits=2),
"%)\n"))

#absolute number unknown whether prescribed
cat("[")
cat(sum(is.na(bp_data_under_twenty_not_assigned$total_daily_salt_dose_with_zero)))
#percentage unknown whether prescribed
cat(paste0(", ",
    round(
      100 * sum(is.na(bp_data_under_twenty_not_assigned$total_daily_salt_dose_with_zero)) /
             nrow(bp_data_under_twenty_not_assigned),
      digits=2),
"%]\n"))

cat("Imputed visits prescribed salt with a known dose:\n")

#absolute number prescribed
cat(sum(bp_data_under_twenty_not_assigned$total_daily_salt_dose_with_zero_carried_to_use>0, na.rm=T))
#percentage of those prescribed
cat(paste0(" (",
    round(
      100 * sum(bp_data_under_twenty_not_assigned$total_daily_salt_dose_with_zero_carried_to_use>0, na.rm=T) /
             nrow(bp_data_under_twenty_not_assigned),
      digits=2),
"%)\n"))

#absolute number unknown whether prescribed
cat("[")
cat(sum(is.na(bp_data_under_twenty_not_assigned$total_daily_salt_dose_with_zero_carried_to_use)))
#percentage unknown whether prescribed
cat(paste0(", ",
    round(
      100 * sum(is.na(bp_data_under_twenty_not_assigned$total_daily_salt_dose_with_zero_carried_to_use)) /
             nrow(bp_data_under_twenty_not_assigned),
      digits=2),
"%]\n"))


```








```{r, if you wanted you could report dose of salt per bsa i havent yet run that}
descr(bp_data_under_twenty$complete_case_total_daily_salt_per_bsa)
descr(bp_data_under_twenty$imputed_total_daily_salt_per_bsa)
```


##############################################
Renin median and interquartile range statistics
##############################################

```{r, define decimal places}
#redefine the decimal places you want for the rest of the numbers 
decimal_places <- 1
```

```{r, rough descriptions of complete case converted biomarkers}
descr(bp_data_under_twenty_male$converted_17OHP_nmol_l_imputation_0)
descr(bp_data_under_twenty_male$converted_androstenedione_nmol_l_imputation_0)
descr(bp_data_under_twenty_male$converted_renin_µIU_ml_imputation_0)
```

```{r, example of when calculating mean and standard deviation of imputed skewed variables results in difficulties done by calculating renin mean and sd across all imputations for all patients}
cat("renin in all patients summary statistics from imputed values and original")
#now things get slightly trickier as we have to calculate pooled estimates across our imputations
#create a frame to bind to

means_of_renin_imputations <- 
  data.frame(renin_mean = NULL)

variance_of_renin_imputations <- 
  data.frame(renin_mean = NULL)

#1) Calculate the mean of the renin for each of the 10 imputed datasets

#cat("All of the means of the renin imputation sets are:\n")

for (imputation_number in 1:number_of_imputations){

  column_name <- paste0("converted_renin_µIU_ml_imputation_", imputation_number)

  mean_of_this_imputation <- 
    mean(bp_data_under_twenty[,column_name][[1]], na.rm=T)

  variance_of_this_imputation <- 
    var(bp_data_under_twenty[,column_name][[1]], na.rm=T)


  #take the mean and variance and bind it to a frame outside the loop

  means_of_renin_imputations <-
    rbind(means_of_renin_imputations,
          mean_of_this_imputation)

  variance_of_renin_imputations <-
    rbind(variance_of_renin_imputations,
          variance_of_this_imputation)
  
}

#rename the column so that it makes sense

names(means_of_renin_imputations)[1] <- 
  "means_of_renin_imputations"

names(variance_of_renin_imputations)[1] <- 
  "variance_of_renin_imputations"

cat("Number of readings of all imputed renins is:\n")
sum(!is.na(bp_data_under_twenty$converted_renin_µIU_ml_imputation_1))

cat("The pooled mean of the renins is simply the mean of the means:\n")
mean(means_of_renin_imputations$means_of_renin_imputations)

cat("The within imputation variance of the renins is simply the mean of the variances from each dataset:\n")
within_imputation_variance <-
  mean(variance_of_renin_imputations$variance_of_renin_imputations)
within_imputation_variance

cat("The between imputation variance of the renins is the variance of the means from each dataset:\n")

between_imputation_variance <-
  var(variance_of_renin_imputations$variance_of_renin_imputations)
between_imputation_variance

cat("The total variance is calculated by combining the within imputation and between imputation variances by adding the within imputation to the (between imputation variance multiplied by 1 + reciprocal of the number of imputations)")

total_variance <-
  within_imputation_variance +
  ( 1 + 1/number_of_imputations ) * between_imputation_variance

total_variance

cat("The pooled standard deviation is then the square root of the total variance")

pooled_sd <-
  total_variance ^ 0.5
pooled_sd
cat("***Original Data***")
cat("Number of readings of original renins is:\n")
sum(!is.na(bp_data_under_twenty$converted_renin_µIU_ml_imputation_0))
cat("We then compare this to the mean of the original values:\n")
mean(bp_data_under_twenty$converted_renin_µIU_ml_imputation_1, na.rm=T)
cat("And the standard deviation of the original values:\n")
sd(bp_data_under_twenty$converted_renin_µIU_ml_imputation_1, na.rm=T)
cat("********************")
cat("*********Overall renin summary statistics all patients******")
cat("********************")
cat("DO NOT USE THESE FIGURES, THIS CHUNK HAS JUST BEEN RETAINED TO SHOW WHAT HAPPENS WHEN YOU TRY AND DO THAT FOR A HIGHLY SKEWED VARIABLE. PROBLEMS IN BOTH ORIGINAL AND IMPUTED DATA. INSTEAD LOOK AT THE CHUNK BELOW, WHERE YOU CALCULATE THE MEDIAN AND IQR FOR EACH DATASET THEN TAKE THE MEAN OF THOSE")
cat("Original patient data:\n")
cat(paste0("n = ", 
             sum(!is.na(bp_data_under_twenty$converted_renin_µIU_ml_imputation_1))))
cat(paste0("mean = ",
             round(mean(bp_data_under_twenty$converted_renin_µIU_ml_imputation_1, na.rm=T), digits=2)))
cat(paste0("confidence_interval = ",
             round(
               mean(bp_data_under_twenty$converted_renin_µIU_ml_imputation_1, na.rm=T) - 
                 1.96 * sd(bp_data_under_twenty$converted_renin_µIU_ml_imputation_1, na.rm=T) , 
               digits=2), 
             " to ", 
             round(
               mean(bp_data_under_twenty$converted_renin_µIU_ml_imputation_1, na.rm=T) +
                 1.96 * sd(bp_data_under_twenty$converted_renin_µIU_ml_imputation_1, na.rm=T) , 
               digits=2)))
cat("********************")
cat("Imputed patient data:\n")
cat(paste0("n = ", 
             sum(!is.na(bp_data_under_twenty$renin_imputation_1))))
cat(paste0("mean = ",
             round(mean(means_of_renin_imputations$means_of_renin_imputations), 
                   digits=2)))
cat(paste0("confidence_interval = ",
             round(
               mean(means_of_renin_imputations$means_of_renin_imputations) - 
                 1.96 * pooled_sd , 
               digits=2), 
             " to ", 
             round(
               mean(means_of_renin_imputations$means_of_renin_imputations) +
                 1.96 * pooled_sd , 
               digits=2)))
```

```{r, reporting median and interquartile range of original and imputed renin in all patients}

medians_of_renin_imputations <- 
  data.frame(renin_median = NULL)
n_of_renin_imputations <- 
  data.frame(renin_median = NULL)
q1_of_renin_imputations <- 
  data.frame(renin_q1 = NULL)
q3_of_renin_imputations <- 
  data.frame(renin_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("converted_renin_µIU_ml_imputation_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_twenty[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_twenty[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_twenty[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_renin_imputations <-
    rbind(medians_of_renin_imputations,
          median_of_this_imputation)
  
  n_of_renin_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_renin_imputations,
          n_of_this_imputation)

  q1_of_renin_imputations <-
    rbind(q1_of_renin_imputations,
          q1_of_this_imputation)

  q3_of_renin_imputations <-
    rbind(q3_of_renin_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data Renin:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_twenty$converted_renin_µIU_ml_imputation_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_twenty$converted_renin_µIU_ml_imputation_0)),
  ") [",
  round(
  quantile(bp_data_under_twenty$converted_renin_µIU_ml_imputation_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_twenty$converted_renin_µIU_ml_imputation_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))
cat(
  
  "  \n  "
)
cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of renin:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_renin_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_renin_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_renin_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_renin_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```

```{r, reporting median and interquartile range of original and imputed renin in male patients}

medians_of_renin_imputations_male <- 
  data.frame(renin_median = NULL)
n_of_renin_imputations_male <- 
  data.frame(renin_median = NULL)
q1_of_renin_imputations_male <- 
  data.frame(renin_q1 = NULL)
q3_of_renin_imputations_male <- 
  data.frame(renin_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("converted_renin_µIU_ml_imputation_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_twenty_male[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty_male[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_twenty_male[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_twenty_male[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_renin_imputations_male <-
    rbind(medians_of_renin_imputations_male,
          median_of_this_imputation)
  
  n_of_renin_imputations_male <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_renin_imputations_male,
          n_of_this_imputation)

  q1_of_renin_imputations_male <-
    rbind(q1_of_renin_imputations_male,
          q1_of_this_imputation)

  q3_of_renin_imputations_male <-
    rbind(q3_of_renin_imputations_male,
          q3_of_this_imputation)
  
}
cat("Original patient data male Renin:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_twenty_male$converted_renin_µIU_ml_imputation_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_twenty_male$converted_renin_µIU_ml_imputation_0)),
  ") [",
  round(
  quantile(bp_data_under_twenty_male$converted_renin_µIU_ml_imputation_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_twenty_male$converted_renin_µIU_ml_imputation_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]\n"
))
cat(
  
  "  \n  "
)
cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of renin:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_renin_imputations_male[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_renin_imputations_male[[1]]),
  ") [",
  round(
  mean(q1_of_renin_imputations_male[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_renin_imputations_male[[1]]),
  digits=decimal_places),
  "]"
))
```

```{r, reporting median and interquartile range of original and imputed renin in fema patients}

medians_of_renin_imputations_fema <- 
  data.frame(renin_median = NULL)
n_of_renin_imputations_fema <- 
  data.frame(renin_median = NULL)
q1_of_renin_imputations_fema <- 
  data.frame(renin_q1 = NULL)
q3_of_renin_imputations_fema <- 
  data.frame(renin_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("converted_renin_µIU_ml_imputation_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_twenty_fema[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty_fema[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_twenty_fema[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_twenty_fema[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_renin_imputations_fema <-
    rbind(medians_of_renin_imputations_fema,
          median_of_this_imputation)
  
  n_of_renin_imputations_fema <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_renin_imputations_fema,
          n_of_this_imputation)

  q1_of_renin_imputations_fema <-
    rbind(q1_of_renin_imputations_fema,
          q1_of_this_imputation)

  q3_of_renin_imputations_fema <-
    rbind(q3_of_renin_imputations_fema,
          q3_of_this_imputation)
  
}
cat("Original patient data fema Renin:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_twenty_fema$converted_renin_µIU_ml_imputation_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_twenty_fema$converted_renin_µIU_ml_imputation_0)),
  ") [",
  round(
  quantile(bp_data_under_twenty_fema$converted_renin_µIU_ml_imputation_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_twenty_fema$converted_renin_µIU_ml_imputation_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]\n"
))
cat(
  
  "  \n  "
)
cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of renin:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_renin_imputations_fema[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_renin_imputations_fema[[1]]),
  ") [",
  round(
  mean(q1_of_renin_imputations_fema[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_renin_imputations_fema[[1]]),
  digits=decimal_places),
  "]"
))
```

```{r, reporting median and interquartile range of original and imputed renin in not_assigned patients}

medians_of_renin_imputations_not_assigned <- 
  data.frame(renin_median = NULL)
n_of_renin_imputations_not_assigned <- 
  data.frame(renin_median = NULL)
q1_of_renin_imputations_not_assigned <- 
  data.frame(renin_q1 = NULL)
q3_of_renin_imputations_not_assigned <- 
  data.frame(renin_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("converted_renin_µIU_ml_imputation_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_twenty_not_assigned[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty_not_assigned[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_twenty_not_assigned[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_twenty_not_assigned[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_renin_imputations_not_assigned <-
    rbind(medians_of_renin_imputations_not_assigned,
          median_of_this_imputation)
  
  n_of_renin_imputations_not_assigned <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_renin_imputations_not_assigned,
          n_of_this_imputation)

  q1_of_renin_imputations_not_assigned <-
    rbind(q1_of_renin_imputations_not_assigned,
          q1_of_this_imputation)

  q3_of_renin_imputations_not_assigned <-
    rbind(q3_of_renin_imputations_not_assigned,
          q3_of_this_imputation)
  
}
cat("Original patient data not_assigned Renin:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_twenty_not_assigned$converted_renin_µIU_ml_imputation_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_twenty_not_assigned$converted_renin_µIU_ml_imputation_0)),
  ") [",
  round(
  quantile(bp_data_under_twenty_not_assigned$converted_renin_µIU_ml_imputation_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_twenty_not_assigned$converted_renin_µIU_ml_imputation_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]\n"
))
cat(
  
  "  \n  "
)
cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of renin:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_renin_imputations_not_assigned[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_renin_imputations_not_assigned[[1]]),
  ") [",
  round(
  mean(q1_of_renin_imputations_not_assigned[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_renin_imputations_not_assigned[[1]]),
  digits=decimal_places),
  "]"
))
```







################
17OHP median and interquartile range statistics
#################

```{r, define decimal places}
#redefine the decimal places you want for the rest of the numbers 
decimal_places <- 1
```

```{r, reporting median and interquartile range of original and imputed 17OHP in all patients}

medians_of_17OHP_imputations <- 
  data.frame(result_17OHP_median = NULL)
n_of_17OHP_imputations <- 
  data.frame(result_17OHP_median = NULL)
q1_of_17OHP_imputations <- 
  data.frame(result_17OHP_q1 = NULL)
q3_of_17OHP_imputations <- 
  data.frame(result_17OHP_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("converted_17OHP_nmol_l_imputation_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_twenty[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_twenty[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_twenty[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_17OHP_imputations <-
    rbind(medians_of_17OHP_imputations,
          median_of_this_imputation)
  
  n_of_17OHP_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_17OHP_imputations,
          n_of_this_imputation)

  q1_of_17OHP_imputations <-
    rbind(q1_of_17OHP_imputations,
          q1_of_this_imputation)

  q3_of_17OHP_imputations <-
    rbind(q3_of_17OHP_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data 17OHP:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_twenty$converted_17OHP_nmol_l_imputation_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_twenty$converted_17OHP_nmol_l_imputation_0)),
  ") [",
  round(
  quantile(bp_data_under_twenty$converted_17OHP_nmol_l_imputation_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_twenty$converted_17OHP_nmol_l_imputation_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))
cat(
  
  "  \n  "
)
cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of 17OHP:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_17OHP_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_17OHP_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_17OHP_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_17OHP_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```

```{r, reporting median and interquartile range of original and imputed 17OHP in male patients}

medians_of_17OHP_imputations <- 
  data.frame(result_17OHP_median = NULL)
n_of_17OHP_imputations <- 
  data.frame(result_17OHP_median = NULL)
q1_of_17OHP_imputations <- 
  data.frame(result_17OHP_q1 = NULL)
q3_of_17OHP_imputations <- 
  data.frame(result_17OHP_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("converted_17OHP_nmol_l_imputation_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_twenty_male[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty_male[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_twenty_male[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_twenty_male[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_17OHP_imputations <-
    rbind(medians_of_17OHP_imputations,
          median_of_this_imputation)
  
  n_of_17OHP_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_17OHP_imputations,
          n_of_this_imputation)

  q1_of_17OHP_imputations <-
    rbind(q1_of_17OHP_imputations,
          q1_of_this_imputation)

  q3_of_17OHP_imputations <-
    rbind(q3_of_17OHP_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data 17OHP:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_twenty_male$converted_17OHP_nmol_l_imputation_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_twenty_male$converted_17OHP_nmol_l_imputation_0)),
  ") [",
  round(
  quantile(bp_data_under_twenty_male$converted_17OHP_nmol_l_imputation_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_twenty_male$converted_17OHP_nmol_l_imputation_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))
cat(
  
  "  \n  "
)
cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of 17OHP:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_17OHP_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_17OHP_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_17OHP_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_17OHP_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```

```{r, reporting median and interquartile range of original and imputed 17OHP in fema patients}

medians_of_17OHP_imputations <- 
  data.frame(result_17OHP_median = NULL)
n_of_17OHP_imputations <- 
  data.frame(result_17OHP_median = NULL)
q1_of_17OHP_imputations <- 
  data.frame(result_17OHP_q1 = NULL)
q3_of_17OHP_imputations <- 
  data.frame(result_17OHP_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("converted_17OHP_nmol_l_imputation_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_twenty_fema[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty_fema[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_twenty_fema[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_twenty_fema[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_17OHP_imputations <-
    rbind(medians_of_17OHP_imputations,
          median_of_this_imputation)
  
  n_of_17OHP_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_17OHP_imputations,
          n_of_this_imputation)

  q1_of_17OHP_imputations <-
    rbind(q1_of_17OHP_imputations,
          q1_of_this_imputation)

  q3_of_17OHP_imputations <-
    rbind(q3_of_17OHP_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data 17OHP:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_twenty_fema$converted_17OHP_nmol_l_imputation_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_twenty_fema$converted_17OHP_nmol_l_imputation_0)),
  ") [",
  round(
  quantile(bp_data_under_twenty_fema$converted_17OHP_nmol_l_imputation_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_twenty_fema$converted_17OHP_nmol_l_imputation_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))
cat(
  
  "  \n  "
)
cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of 17OHP:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_17OHP_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_17OHP_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_17OHP_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_17OHP_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```

```{r, reporting median and interquartile range of original and imputed 17OHP in not_assigned patients}

medians_of_17OHP_imputations <- 
  data.frame(result_17OHP_median = NULL)
n_of_17OHP_imputations <- 
  data.frame(result_17OHP_median = NULL)
q1_of_17OHP_imputations <- 
  data.frame(result_17OHP_q1 = NULL)
q3_of_17OHP_imputations <- 
  data.frame(result_17OHP_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("converted_17OHP_nmol_l_imputation_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_twenty_not_assigned[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty_not_assigned[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_twenty_not_assigned[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_twenty_not_assigned[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_17OHP_imputations <-
    rbind(medians_of_17OHP_imputations,
          median_of_this_imputation)
  
  n_of_17OHP_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_17OHP_imputations,
          n_of_this_imputation)

  q1_of_17OHP_imputations <-
    rbind(q1_of_17OHP_imputations,
          q1_of_this_imputation)

  q3_of_17OHP_imputations <-
    rbind(q3_of_17OHP_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data 17OHP:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_twenty_not_assigned$converted_17OHP_nmol_l_imputation_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_twenty_not_assigned$converted_17OHP_nmol_l_imputation_0)),
  ") [",
  round(
  quantile(bp_data_under_twenty_not_assigned$converted_17OHP_nmol_l_imputation_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_twenty_not_assigned$converted_17OHP_nmol_l_imputation_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))
cat(
  
  "  \n  "
)
cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of 17OHP:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_17OHP_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_17OHP_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_17OHP_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_17OHP_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```



################
androstenedione median and interquartile range statistics
#################

```{r, define decimal places}
#redefine the decimal places you want for the rest of the numbers 
decimal_places <- 1
```

```{r, reporting median and interquartile range of original and imputed androstenedione in all patients}

medians_of_androstenedione_imputations <- 
  data.frame(result_androstenedione_median = NULL)
n_of_androstenedione_imputations <- 
  data.frame(result_androstenedione_median = NULL)
q1_of_androstenedione_imputations <- 
  data.frame(result_androstenedione_q1 = NULL)
q3_of_androstenedione_imputations <- 
  data.frame(result_androstenedione_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("converted_androstenedione_nmol_l_imputation_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_twenty[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_twenty[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_twenty[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_androstenedione_imputations <-
    rbind(medians_of_androstenedione_imputations,
          median_of_this_imputation)
  
  n_of_androstenedione_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_androstenedione_imputations,
          n_of_this_imputation)

  q1_of_androstenedione_imputations <-
    rbind(q1_of_androstenedione_imputations,
          q1_of_this_imputation)

  q3_of_androstenedione_imputations <-
    rbind(q3_of_androstenedione_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data androstenedione:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_twenty$converted_androstenedione_nmol_l_imputation_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_twenty$converted_androstenedione_nmol_l_imputation_0)),
  ") [",
  round(
  quantile(bp_data_under_twenty$converted_androstenedione_nmol_l_imputation_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_twenty$converted_androstenedione_nmol_l_imputation_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))
cat(
  
  "  \n  "
)
cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of androstenedione:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_androstenedione_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_androstenedione_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_androstenedione_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_androstenedione_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```

```{r, reporting median and interquartile range of original and imputed androstenedione in male patients}

medians_of_androstenedione_imputations <- 
  data.frame(result_androstenedione_median = NULL)
n_of_androstenedione_imputations <- 
  data.frame(result_androstenedione_median = NULL)
q1_of_androstenedione_imputations <- 
  data.frame(result_androstenedione_q1 = NULL)
q3_of_androstenedione_imputations <- 
  data.frame(result_androstenedione_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("converted_androstenedione_nmol_l_imputation_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_twenty_male[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty_male[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_twenty_male[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_twenty_male[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_androstenedione_imputations <-
    rbind(medians_of_androstenedione_imputations,
          median_of_this_imputation)
  
  n_of_androstenedione_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_androstenedione_imputations,
          n_of_this_imputation)

  q1_of_androstenedione_imputations <-
    rbind(q1_of_androstenedione_imputations,
          q1_of_this_imputation)

  q3_of_androstenedione_imputations <-
    rbind(q3_of_androstenedione_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data androstenedione:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_twenty_male$converted_androstenedione_nmol_l_imputation_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_twenty_male$converted_androstenedione_nmol_l_imputation_0)),
  ") [",
  round(
  quantile(bp_data_under_twenty_male$converted_androstenedione_nmol_l_imputation_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_twenty_male$converted_androstenedione_nmol_l_imputation_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))
cat(
  
  "  \n  "
)
cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of androstenedione:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_androstenedione_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_androstenedione_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_androstenedione_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_androstenedione_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```

```{r, reporting median and interquartile range of original and imputed androstenedione in fema patients}

medians_of_androstenedione_imputations <- 
  data.frame(result_androstenedione_median = NULL)
n_of_androstenedione_imputations <- 
  data.frame(result_androstenedione_median = NULL)
q1_of_androstenedione_imputations <- 
  data.frame(result_androstenedione_q1 = NULL)
q3_of_androstenedione_imputations <- 
  data.frame(result_androstenedione_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("converted_androstenedione_nmol_l_imputation_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_twenty_fema[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty_fema[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_twenty_fema[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_twenty_fema[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_androstenedione_imputations <-
    rbind(medians_of_androstenedione_imputations,
          median_of_this_imputation)
  
  n_of_androstenedione_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_androstenedione_imputations,
          n_of_this_imputation)

  q1_of_androstenedione_imputations <-
    rbind(q1_of_androstenedione_imputations,
          q1_of_this_imputation)

  q3_of_androstenedione_imputations <-
    rbind(q3_of_androstenedione_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data androstenedione:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_twenty_fema$converted_androstenedione_nmol_l_imputation_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_twenty_fema$converted_androstenedione_nmol_l_imputation_0)),
  ") [",
  round(
  quantile(bp_data_under_twenty_fema$converted_androstenedione_nmol_l_imputation_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_twenty_fema$converted_androstenedione_nmol_l_imputation_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))
cat(
  
  "  \n  "
)
cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of androstenedione:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_androstenedione_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_androstenedione_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_androstenedione_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_androstenedione_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```

```{r, reporting median and interquartile range of original and imputed androstenedione in not_assigned patients}

medians_of_androstenedione_imputations <- 
  data.frame(result_androstenedione_median = NULL)
n_of_androstenedione_imputations <- 
  data.frame(result_androstenedione_median = NULL)
q1_of_androstenedione_imputations <- 
  data.frame(result_androstenedione_q1 = NULL)
q3_of_androstenedione_imputations <- 
  data.frame(result_androstenedione_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("converted_androstenedione_nmol_l_imputation_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_twenty_not_assigned[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty_not_assigned[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_twenty_not_assigned[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_twenty_not_assigned[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_androstenedione_imputations <-
    rbind(medians_of_androstenedione_imputations,
          median_of_this_imputation)
  
  n_of_androstenedione_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_androstenedione_imputations,
          n_of_this_imputation)

  q1_of_androstenedione_imputations <-
    rbind(q1_of_androstenedione_imputations,
          q1_of_this_imputation)

  q3_of_androstenedione_imputations <-
    rbind(q3_of_androstenedione_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data androstenedione:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_twenty_not_assigned$converted_androstenedione_nmol_l_imputation_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_twenty_not_assigned$converted_androstenedione_nmol_l_imputation_0)),
  ") [",
  round(
  quantile(bp_data_under_twenty_not_assigned$converted_androstenedione_nmol_l_imputation_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_twenty_not_assigned$converted_androstenedione_nmol_l_imputation_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))
cat(
  
  "  \n  "
)
cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of androstenedione:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_androstenedione_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_androstenedione_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_androstenedione_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_androstenedione_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```

################
systolic median and interquartile range statistics
#################

```{r, define decimal places}
#redefine the decimal places you want for the rest of the numbers 
decimal_places <- 1
```

```{r, reporting median and interquartile range of original and imputed systolic in all patients}

medians_of_systolic_imputations <- 
  data.frame(result_systolic_median = NULL)
n_of_systolic_imputations <- 
  data.frame(result_systolic_median = NULL)
q1_of_systolic_imputations <- 
  data.frame(result_systolic_q1 = NULL)
q3_of_systolic_imputations <- 
  data.frame(result_systolic_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("systolic_imputation_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_twenty[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_twenty[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_twenty[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_systolic_imputations <-
    rbind(medians_of_systolic_imputations,
          median_of_this_imputation)
  
  n_of_systolic_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_systolic_imputations,
          n_of_this_imputation)

  q1_of_systolic_imputations <-
    rbind(q1_of_systolic_imputations,
          q1_of_this_imputation)

  q3_of_systolic_imputations <-
    rbind(q3_of_systolic_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data systolic:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_twenty$systolic_imputation_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_twenty$systolic_imputation_0)),
  ") [",
  round(
  quantile(bp_data_under_twenty$systolic_imputation_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_twenty$systolic_imputation_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))
cat(
  
  "  \n  "
)
cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of systolic:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_systolic_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_systolic_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_systolic_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_systolic_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```

```{r, reporting median and interquartile range of original and imputed systolic in male patients}

medians_of_systolic_imputations <- 
  data.frame(result_systolic_median = NULL)
n_of_systolic_imputations <- 
  data.frame(result_systolic_median = NULL)
q1_of_systolic_imputations <- 
  data.frame(result_systolic_q1 = NULL)
q3_of_systolic_imputations <- 
  data.frame(result_systolic_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("systolic_imputation_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_twenty_male[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty_male[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_twenty_male[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_twenty_male[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_systolic_imputations <-
    rbind(medians_of_systolic_imputations,
          median_of_this_imputation)
  
  n_of_systolic_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_systolic_imputations,
          n_of_this_imputation)

  q1_of_systolic_imputations <-
    rbind(q1_of_systolic_imputations,
          q1_of_this_imputation)

  q3_of_systolic_imputations <-
    rbind(q3_of_systolic_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data male patients systolic:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_twenty_male$systolic_imputation_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_twenty_male$systolic_imputation_0)),
  ") [",
  round(
  quantile(bp_data_under_twenty_male$systolic_imputation_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_twenty_male$systolic_imputation_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))
cat(
  
  "  \n  "
)
cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of systolic:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_systolic_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_systolic_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_systolic_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_systolic_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```

```{r, reporting median and interquartile range of original and imputed systolic in fema patients}

medians_of_systolic_imputations <- 
  data.frame(result_systolic_median = NULL)
n_of_systolic_imputations <- 
  data.frame(result_systolic_median = NULL)
q1_of_systolic_imputations <- 
  data.frame(result_systolic_q1 = NULL)
q3_of_systolic_imputations <- 
  data.frame(result_systolic_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("systolic_imputation_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_twenty_fema[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty_fema[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_twenty_fema[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_twenty_fema[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_systolic_imputations <-
    rbind(medians_of_systolic_imputations,
          median_of_this_imputation)
  
  n_of_systolic_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_systolic_imputations,
          n_of_this_imputation)

  q1_of_systolic_imputations <-
    rbind(q1_of_systolic_imputations,
          q1_of_this_imputation)

  q3_of_systolic_imputations <-
    rbind(q3_of_systolic_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data fema patients  systolic:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_twenty_fema$systolic_imputation_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_twenty_fema$systolic_imputation_0)),
  ") [",
  round(
  quantile(bp_data_under_twenty_fema$systolic_imputation_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_twenty_fema$systolic_imputation_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))
cat(
  
  "  \n  "
)
cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of systolic:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_systolic_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_systolic_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_systolic_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_systolic_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```

```{r, reporting median and interquartile range of original and imputed systolic in not_assigned patients}

medians_of_systolic_imputations <- 
  data.frame(result_systolic_median = NULL)
n_of_systolic_imputations <- 
  data.frame(result_systolic_median = NULL)
q1_of_systolic_imputations <- 
  data.frame(result_systolic_q1 = NULL)
q3_of_systolic_imputations <- 
  data.frame(result_systolic_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("systolic_imputation_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_twenty_not_assigned[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty_not_assigned[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_twenty_not_assigned[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_twenty_not_assigned[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_systolic_imputations <-
    rbind(medians_of_systolic_imputations,
          median_of_this_imputation)
  
  n_of_systolic_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_systolic_imputations,
          n_of_this_imputation)

  q1_of_systolic_imputations <-
    rbind(q1_of_systolic_imputations,
          q1_of_this_imputation)

  q3_of_systolic_imputations <-
    rbind(q3_of_systolic_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data not assigned sex patients  systolic:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_twenty_not_assigned$systolic_imputation_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_twenty_not_assigned$systolic_imputation_0)),
  ") [",
  round(
  quantile(bp_data_under_twenty_not_assigned$systolic_imputation_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_twenty_not_assigned$systolic_imputation_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))
cat(
  
  "  \n  "
)
cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of systolic:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_systolic_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_systolic_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_systolic_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_systolic_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```



################
diastolic median and interquartile range statistics
#################

```{r, define decimal places}
#redefine the decimal places you want for the rest of the numbers 
decimal_places <- 1
```

```{r, reporting median and interquartile range of original and imputed diastolic in all patients}

medians_of_diastolic_imputations <- 
  data.frame(result_diastolic_median = NULL)
n_of_diastolic_imputations <- 
  data.frame(result_diastolic_median = NULL)
q1_of_diastolic_imputations <- 
  data.frame(result_diastolic_q1 = NULL)
q3_of_diastolic_imputations <- 
  data.frame(result_diastolic_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("diastolic_imputation_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_twenty[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_twenty[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_twenty[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_diastolic_imputations <-
    rbind(medians_of_diastolic_imputations,
          median_of_this_imputation)
  
  n_of_diastolic_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_diastolic_imputations,
          n_of_this_imputation)

  q1_of_diastolic_imputations <-
    rbind(q1_of_diastolic_imputations,
          q1_of_this_imputation)

  q3_of_diastolic_imputations <-
    rbind(q3_of_diastolic_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data all patients diastolic:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_twenty$diastolic_imputation_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_twenty$diastolic_imputation_0)),
  ") [",
  round(
  quantile(bp_data_under_twenty$diastolic_imputation_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_twenty$diastolic_imputation_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))
cat(
  
  "  \n  "
)
cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of diastolic:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_diastolic_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_diastolic_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_diastolic_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_diastolic_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```

```{r, reporting median and interquartile range of original and imputed diastolic in male patients}

medians_of_diastolic_imputations <- 
  data.frame(result_diastolic_median = NULL)
n_of_diastolic_imputations <- 
  data.frame(result_diastolic_median = NULL)
q1_of_diastolic_imputations <- 
  data.frame(result_diastolic_q1 = NULL)
q3_of_diastolic_imputations <- 
  data.frame(result_diastolic_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("diastolic_imputation_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_twenty_male[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty_male[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_twenty_male[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_twenty_male[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_diastolic_imputations <-
    rbind(medians_of_diastolic_imputations,
          median_of_this_imputation)
  
  n_of_diastolic_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_diastolic_imputations,
          n_of_this_imputation)

  q1_of_diastolic_imputations <-
    rbind(q1_of_diastolic_imputations,
          q1_of_this_imputation)

  q3_of_diastolic_imputations <-
    rbind(q3_of_diastolic_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data male patients diastolic:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_twenty_male$diastolic_imputation_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_twenty_male$diastolic_imputation_0)),
  ") [",
  round(
  quantile(bp_data_under_twenty_male$diastolic_imputation_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_twenty_male$diastolic_imputation_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))
cat(
  
  "  \n  "
)
cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of diastolic:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_diastolic_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_diastolic_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_diastolic_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_diastolic_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```

```{r, reporting median and interquartile range of original and imputed diastolic in fema patients}

medians_of_diastolic_imputations <- 
  data.frame(result_diastolic_median = NULL)
n_of_diastolic_imputations <- 
  data.frame(result_diastolic_median = NULL)
q1_of_diastolic_imputations <- 
  data.frame(result_diastolic_q1 = NULL)
q3_of_diastolic_imputations <- 
  data.frame(result_diastolic_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("diastolic_imputation_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_twenty_fema[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty_fema[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_twenty_fema[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_twenty_fema[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_diastolic_imputations <-
    rbind(medians_of_diastolic_imputations,
          median_of_this_imputation)
  
  n_of_diastolic_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_diastolic_imputations,
          n_of_this_imputation)

  q1_of_diastolic_imputations <-
    rbind(q1_of_diastolic_imputations,
          q1_of_this_imputation)

  q3_of_diastolic_imputations <-
    rbind(q3_of_diastolic_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data fema patients diastolic:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_twenty_fema$diastolic_imputation_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_twenty_fema$diastolic_imputation_0)),
  ") [",
  round(
  quantile(bp_data_under_twenty_fema$diastolic_imputation_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_twenty_fema$diastolic_imputation_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))
cat(
  
  "  \n  "
)
cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of diastolic:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_diastolic_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_diastolic_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_diastolic_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_diastolic_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```

```{r, reporting median and interquartile range of original and imputed diastolic in not_assigned patients}

medians_of_diastolic_imputations <- 
  data.frame(result_diastolic_median = NULL)
n_of_diastolic_imputations <- 
  data.frame(result_diastolic_median = NULL)
q1_of_diastolic_imputations <- 
  data.frame(result_diastolic_q1 = NULL)
q3_of_diastolic_imputations <- 
  data.frame(result_diastolic_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("diastolic_imputation_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_twenty_not_assigned[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty_not_assigned[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_twenty_not_assigned[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_twenty_not_assigned[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_diastolic_imputations <-
    rbind(medians_of_diastolic_imputations,
          median_of_this_imputation)
  
  n_of_diastolic_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_diastolic_imputations,
          n_of_this_imputation)

  q1_of_diastolic_imputations <-
    rbind(q1_of_diastolic_imputations,
          q1_of_this_imputation)

  q3_of_diastolic_imputations <-
    rbind(q3_of_diastolic_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data not assigned patients diastolic:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_twenty_not_assigned$diastolic_imputation_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_twenty_not_assigned$diastolic_imputation_0)),
  ") [",
  round(
  quantile(bp_data_under_twenty_not_assigned$diastolic_imputation_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_twenty_not_assigned$diastolic_imputation_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))
cat(
  
  "  \n  "
)
cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of diastolic:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_diastolic_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_diastolic_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_diastolic_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_diastolic_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```



#################
systolic SDS statistics all under twenty
#################

```{r, reporting median and interquartile range of original and imputed systolic SDS in all patients under twenty}
decimal_places <- 1

medians_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_median = NULL)

n_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_median = NULL)

q1_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_q1 = NULL)

q3_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("systolic_imp_z_score_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_twenty[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_twenty[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_twenty[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_systolic_SDS_imputations <-
    rbind(medians_of_systolic_SDS_imputations,
          median_of_this_imputation)
  
  n_of_systolic_SDS_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_systolic_SDS_imputations,
          n_of_this_imputation)

  q1_of_systolic_SDS_imputations <-
    rbind(q1_of_systolic_SDS_imputations,
          q1_of_this_imputation)

  q3_of_systolic_SDS_imputations <-
    rbind(q3_of_systolic_SDS_imputations,
          q3_of_this_imputation)
  
}

cat("Original patient data systolic SDS:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_twenty$systolic_imp_z_score_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_twenty$systolic_imp_z_score_0)),
  ") [",
  round(
  quantile(bp_data_under_twenty$systolic_imp_z_score_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_twenty$systolic_imp_z_score_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))

cat(
  
  "  \n  "
)

cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of systolic SDS:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_systolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_systolic_SDS_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_systolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_systolic_SDS_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```

```{r, reporting median and interquartile range of original and imputed systolic SDS in male patients under twenty}

medians_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_median = NULL)
n_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_median = NULL)
q1_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_q1 = NULL)
q3_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("systolic_imp_z_score_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_twenty_male[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty_male[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_twenty_male[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_twenty_male[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_systolic_SDS_imputations <-
    rbind(medians_of_systolic_SDS_imputations,
          median_of_this_imputation)
  
  n_of_systolic_SDS_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_systolic_SDS_imputations,
          n_of_this_imputation)

  q1_of_systolic_SDS_imputations <-
    rbind(q1_of_systolic_SDS_imputations,
          q1_of_this_imputation)

  q3_of_systolic_SDS_imputations <-
    rbind(q3_of_systolic_SDS_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data systolic SDS male under twenty:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_twenty_male$systolic_imp_z_score_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_twenty_male$systolic_imp_z_score_0)),
  ") [",
  round(
  quantile(bp_data_under_twenty_male$systolic_imp_z_score_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_twenty_male$systolic_imp_z_score_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))

cat(
  
  "  \n  "
)

cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of systolic SDS in male under twenty:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_systolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_systolic_SDS_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_systolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_systolic_SDS_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```

```{r, reporting median and interquartile range of original and imputed systolic SDS in fema patients under twenty}

medians_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_median = NULL)
n_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_median = NULL)
q1_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_q1 = NULL)
q3_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("systolic_imp_z_score_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_twenty_fema[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty_fema[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_twenty_fema[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_twenty_fema[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_systolic_SDS_imputations <-
    rbind(medians_of_systolic_SDS_imputations,
          median_of_this_imputation)
  
  n_of_systolic_SDS_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_systolic_SDS_imputations,
          n_of_this_imputation)

  q1_of_systolic_SDS_imputations <-
    rbind(q1_of_systolic_SDS_imputations,
          q1_of_this_imputation)

  q3_of_systolic_SDS_imputations <-
    rbind(q3_of_systolic_SDS_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data systolic SDS fema under twenty:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_twenty_fema$systolic_imp_z_score_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_twenty_fema$systolic_imp_z_score_0)),
  ") [",
  round(
  quantile(bp_data_under_twenty_fema$systolic_imp_z_score_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_twenty_fema$systolic_imp_z_score_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))

cat(
  
  "  \n  "
)

cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of systolic SDS in fema under twenty:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_systolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_systolic_SDS_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_systolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_systolic_SDS_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```


#################
diastolic SDS statistics all under twenty
#################

```{r, reporting median and interquartile range of original and imputed diastolic SDS in all patients under twenty}

medians_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_median = NULL)
n_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_median = NULL)
q1_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_q1 = NULL)
q3_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("diastolic_imp_z_score_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_twenty[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_twenty[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_twenty[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_diastolic_SDS_imputations <-
    rbind(medians_of_diastolic_SDS_imputations,
          median_of_this_imputation)
  
  n_of_diastolic_SDS_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_diastolic_SDS_imputations,
          n_of_this_imputation)

  q1_of_diastolic_SDS_imputations <-
    rbind(q1_of_diastolic_SDS_imputations,
          q1_of_this_imputation)

  q3_of_diastolic_SDS_imputations <-
    rbind(q3_of_diastolic_SDS_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data diastolic SDS:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_twenty$diastolic_imp_z_score_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_twenty$diastolic_imp_z_score_0)),
  ") [",
  round(
  quantile(bp_data_under_twenty$diastolic_imp_z_score_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_twenty$diastolic_imp_z_score_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))

cat(
  
  "  \n  "
)

cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of diastolic SDS:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_diastolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_diastolic_SDS_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_diastolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_diastolic_SDS_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```

```{r, reporting median and interquartile range of original and imputed diastolic SDS in male patients under twenty}

medians_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_median = NULL)
n_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_median = NULL)
q1_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_q1 = NULL)
q3_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("diastolic_imp_z_score_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_twenty_male[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty_male[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_twenty_male[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_twenty_male[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_diastolic_SDS_imputations <-
    rbind(medians_of_diastolic_SDS_imputations,
          median_of_this_imputation)
  
  n_of_diastolic_SDS_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_diastolic_SDS_imputations,
          n_of_this_imputation)

  q1_of_diastolic_SDS_imputations <-
    rbind(q1_of_diastolic_SDS_imputations,
          q1_of_this_imputation)

  q3_of_diastolic_SDS_imputations <-
    rbind(q3_of_diastolic_SDS_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data diastolic SDS male under twenty:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_twenty_male$diastolic_imp_z_score_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_twenty_male$diastolic_imp_z_score_0)),
  ") [",
  round(
  quantile(bp_data_under_twenty_male$diastolic_imp_z_score_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_twenty_male$diastolic_imp_z_score_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))

cat(
  
  "  \n  "
)

cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of diastolic SDS in male under twenty:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_diastolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_diastolic_SDS_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_diastolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_diastolic_SDS_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```

```{r, reporting median and interquartile range of original and imputed diastolic SDS in fema patients under twenty}

medians_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_median = NULL)
n_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_median = NULL)
q1_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_q1 = NULL)
q3_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("diastolic_imp_z_score_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_twenty_fema[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty_fema[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_twenty_fema[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_twenty_fema[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_diastolic_SDS_imputations <-
    rbind(medians_of_diastolic_SDS_imputations,
          median_of_this_imputation)
  
  n_of_diastolic_SDS_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_diastolic_SDS_imputations,
          n_of_this_imputation)

  q1_of_diastolic_SDS_imputations <-
    rbind(q1_of_diastolic_SDS_imputations,
          q1_of_this_imputation)

  q3_of_diastolic_SDS_imputations <-
    rbind(q3_of_diastolic_SDS_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data diastolic SDS fema under twenty:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_twenty_fema$diastolic_imp_z_score_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_twenty_fema$diastolic_imp_z_score_0)),
  ") [",
  round(
  quantile(bp_data_under_twenty_fema$diastolic_imp_z_score_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_twenty_fema$diastolic_imp_z_score_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))

cat(
  
  "  \n  "
)

cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of diastolic SDS in fema under twenty:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_diastolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_diastolic_SDS_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_diastolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_diastolic_SDS_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```



#################
systolic SDS statistics all under five
#################

```{r, reporting median and interquartile range of original and imputed systolic SDS in all patients under five}

medians_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_median = NULL)

n_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_median = NULL)

q1_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_q1 = NULL)

q3_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("systolic_imp_z_score_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_five[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_five[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_five[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_five[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_systolic_SDS_imputations <-
    rbind(medians_of_systolic_SDS_imputations,
          median_of_this_imputation)
  
  n_of_systolic_SDS_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_systolic_SDS_imputations,
          n_of_this_imputation)

  q1_of_systolic_SDS_imputations <-
    rbind(q1_of_systolic_SDS_imputations,
          q1_of_this_imputation)

  q3_of_systolic_SDS_imputations <-
    rbind(q3_of_systolic_SDS_imputations,
          q3_of_this_imputation)
  
}

cat("Original patient data systolic SDS for all patients under five:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_five$systolic_imp_z_score_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_five$systolic_imp_z_score_0)),
  ") [",
  round(
  quantile(bp_data_under_five$systolic_imp_z_score_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_five$systolic_imp_z_score_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))

cat(
  
  "  \n  "
)

cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of systolic SDS for all patients under five:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_systolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_systolic_SDS_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_systolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_systolic_SDS_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```

```{r, reporting median and interquartile range of original and imputed systolic SDS in male patients under five}

medians_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_median = NULL)
n_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_median = NULL)
q1_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_q1 = NULL)
q3_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("systolic_imp_z_score_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_five_male[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_five_male[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_five_male[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_five_male[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_systolic_SDS_imputations <-
    rbind(medians_of_systolic_SDS_imputations,
          median_of_this_imputation)
  
  n_of_systolic_SDS_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_systolic_SDS_imputations,
          n_of_this_imputation)

  q1_of_systolic_SDS_imputations <-
    rbind(q1_of_systolic_SDS_imputations,
          q1_of_this_imputation)

  q3_of_systolic_SDS_imputations <-
    rbind(q3_of_systolic_SDS_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data systolic SDS male under five:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_five_male$systolic_imp_z_score_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_five_male$systolic_imp_z_score_0)),
  ") [",
  round(
  quantile(bp_data_under_five_male$systolic_imp_z_score_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_five_male$systolic_imp_z_score_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))

cat(
  
  "  \n  "
)

cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of systolic SDS in male under five:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_systolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_systolic_SDS_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_systolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_systolic_SDS_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```

```{r, reporting median and interquartile range of original and imputed systolic SDS in fema patients under five}

medians_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_median = NULL)
n_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_median = NULL)
q1_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_q1 = NULL)
q3_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("systolic_imp_z_score_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_five_fema[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_five_fema[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_five_fema[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_five_fema[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_systolic_SDS_imputations <-
    rbind(medians_of_systolic_SDS_imputations,
          median_of_this_imputation)
  
  n_of_systolic_SDS_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_systolic_SDS_imputations,
          n_of_this_imputation)

  q1_of_systolic_SDS_imputations <-
    rbind(q1_of_systolic_SDS_imputations,
          q1_of_this_imputation)

  q3_of_systolic_SDS_imputations <-
    rbind(q3_of_systolic_SDS_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data systolic SDS fema under five:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_five_fema$systolic_imp_z_score_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_five_fema$systolic_imp_z_score_0)),
  ") [",
  round(
  quantile(bp_data_under_five_fema$systolic_imp_z_score_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_five_fema$systolic_imp_z_score_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))

cat(
  
  "  \n  "
)

cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of systolic SDS in fema under five:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_systolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_systolic_SDS_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_systolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_systolic_SDS_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```


#################
diastolic SDS statistics all under five
#################

```{r, reporting median and interquartile range of original and imputed diastolic SDS in all patients under five}

medians_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_median = NULL)
n_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_median = NULL)
q1_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_q1 = NULL)
q3_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("diastolic_imp_z_score_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_five[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_five[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_five[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_five[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_diastolic_SDS_imputations <-
    rbind(medians_of_diastolic_SDS_imputations,
          median_of_this_imputation)
  
  n_of_diastolic_SDS_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_diastolic_SDS_imputations,
          n_of_this_imputation)

  q1_of_diastolic_SDS_imputations <-
    rbind(q1_of_diastolic_SDS_imputations,
          q1_of_this_imputation)

  q3_of_diastolic_SDS_imputations <-
    rbind(q3_of_diastolic_SDS_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data diastolic SDS under five:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_five$diastolic_imp_z_score_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_five$diastolic_imp_z_score_0)),
  ") [",
  round(
  quantile(bp_data_under_five$diastolic_imp_z_score_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_five$diastolic_imp_z_score_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))

cat(
  
  "  \n  "
)

cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of diastolic SDS under five:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_diastolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_diastolic_SDS_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_diastolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_diastolic_SDS_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```

```{r, reporting median and interquartile range of original and imputed diastolic SDS in male patients under five}

medians_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_median = NULL)
n_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_median = NULL)
q1_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_q1 = NULL)
q3_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("diastolic_imp_z_score_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_five_male[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_five_male[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_five_male[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_five_male[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_diastolic_SDS_imputations <-
    rbind(medians_of_diastolic_SDS_imputations,
          median_of_this_imputation)
  
  n_of_diastolic_SDS_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_diastolic_SDS_imputations,
          n_of_this_imputation)

  q1_of_diastolic_SDS_imputations <-
    rbind(q1_of_diastolic_SDS_imputations,
          q1_of_this_imputation)

  q3_of_diastolic_SDS_imputations <-
    rbind(q3_of_diastolic_SDS_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data diastolic SDS male under five:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_five_male$diastolic_imp_z_score_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_five_male$diastolic_imp_z_score_0)),
  ") [",
  round(
  quantile(bp_data_under_five_male$diastolic_imp_z_score_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_five_male$diastolic_imp_z_score_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))

cat(
  
  "  \n  "
)

cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of diastolic SDS in male under five:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_diastolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_diastolic_SDS_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_diastolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_diastolic_SDS_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```

```{r, reporting median and interquartile range of original and imputed diastolic SDS in fema patients under five}

medians_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_median = NULL)
n_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_median = NULL)
q1_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_q1 = NULL)
q3_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("diastolic_imp_z_score_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_under_five_fema[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_five_fema[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_under_five_fema[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_under_five_fema[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_diastolic_SDS_imputations <-
    rbind(medians_of_diastolic_SDS_imputations,
          median_of_this_imputation)
  
  n_of_diastolic_SDS_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_diastolic_SDS_imputations,
          n_of_this_imputation)

  q1_of_diastolic_SDS_imputations <-
    rbind(q1_of_diastolic_SDS_imputations,
          q1_of_this_imputation)

  q3_of_diastolic_SDS_imputations <-
    rbind(q3_of_diastolic_SDS_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data diastolic SDS fema under five:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_under_five_fema$diastolic_imp_z_score_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_under_five_fema$diastolic_imp_z_score_0)),
  ") [",
  round(
  quantile(bp_data_under_five_fema$diastolic_imp_z_score_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_under_five_fema$diastolic_imp_z_score_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))

cat(
  
  "  \n  "
)

cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of diastolic SDS in fema under five:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_diastolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_diastolic_SDS_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_diastolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_diastolic_SDS_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```


#################
systolic SDS statistics five to twenty
#################

```{r, reporting median and interquartile range of original and imputed systolic SDS in all patients five to twenty}

medians_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_median = NULL)

n_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_median = NULL)

q1_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_q1 = NULL)

q3_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("systolic_imp_z_score_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_five_to_twenty[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_five_to_twenty[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_five_to_twenty[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_five_to_twenty[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_systolic_SDS_imputations <-
    rbind(medians_of_systolic_SDS_imputations,
          median_of_this_imputation)
  
  n_of_systolic_SDS_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_systolic_SDS_imputations,
          n_of_this_imputation)

  q1_of_systolic_SDS_imputations <-
    rbind(q1_of_systolic_SDS_imputations,
          q1_of_this_imputation)

  q3_of_systolic_SDS_imputations <-
    rbind(q3_of_systolic_SDS_imputations,
          q3_of_this_imputation)
  
}

cat("Original patient data systolic SDS for patients five to twenty:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_five_to_twenty$systolic_imp_z_score_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_five_to_twenty$systolic_imp_z_score_0)),
  ") [",
  round(
  quantile(bp_data_five_to_twenty$systolic_imp_z_score_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_five_to_twenty$systolic_imp_z_score_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))

cat(
  
  "  \n  "
)

cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of systolic SDS for patients 5 to 20:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_systolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_systolic_SDS_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_systolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_systolic_SDS_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```

```{r, reporting median and interquartile range of original and imputed systolic SDS in male patients five to twenty}

medians_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_median = NULL)
n_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_median = NULL)
q1_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_q1 = NULL)
q3_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("systolic_imp_z_score_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_five_to_twenty_male[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_five_to_twenty_male[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_five_to_twenty_male[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_five_to_twenty_male[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_systolic_SDS_imputations <-
    rbind(medians_of_systolic_SDS_imputations,
          median_of_this_imputation)
  
  n_of_systolic_SDS_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_systolic_SDS_imputations,
          n_of_this_imputation)

  q1_of_systolic_SDS_imputations <-
    rbind(q1_of_systolic_SDS_imputations,
          q1_of_this_imputation)

  q3_of_systolic_SDS_imputations <-
    rbind(q3_of_systolic_SDS_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data systolic SDS male five to twenty:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_five_to_twenty_male$systolic_imp_z_score_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_five_to_twenty_male$systolic_imp_z_score_0)),
  ") [",
  round(
  quantile(bp_data_five_to_twenty_male$systolic_imp_z_score_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_five_to_twenty_male$systolic_imp_z_score_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))

cat(
  
  "  \n  "
)

cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of systolic SDS in male five to twenty:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_systolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_systolic_SDS_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_systolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_systolic_SDS_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```

```{r, reporting median and interquartile range of original and imputed systolic SDS in fema patients five to twenty}

medians_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_median = NULL)
n_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_median = NULL)
q1_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_q1 = NULL)
q3_of_systolic_SDS_imputations <- 
  data.frame(result_systolic_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("systolic_imp_z_score_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_five_to_twenty_fema[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_five_to_twenty_fema[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_five_to_twenty_fema[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_five_to_twenty_fema[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_systolic_SDS_imputations <-
    rbind(medians_of_systolic_SDS_imputations,
          median_of_this_imputation)
  
  n_of_systolic_SDS_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_systolic_SDS_imputations,
          n_of_this_imputation)

  q1_of_systolic_SDS_imputations <-
    rbind(q1_of_systolic_SDS_imputations,
          q1_of_this_imputation)

  q3_of_systolic_SDS_imputations <-
    rbind(q3_of_systolic_SDS_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data systolic SDS fema five to twenty:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_five_to_twenty_fema$systolic_imp_z_score_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_five_to_twenty_fema$systolic_imp_z_score_0)),
  ") [",
  round(
  quantile(bp_data_five_to_twenty_fema$systolic_imp_z_score_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_five_to_twenty_fema$systolic_imp_z_score_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))

cat(
  
  "  \n  "
)

cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of systolic SDS in fema five to twenty:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_systolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_systolic_SDS_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_systolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_systolic_SDS_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```


#################
diastolic SDS statistics all five to twenty
#################

```{r, reporting median and interquartile range of original and imputed diastolic SDS in all patients five to twenty}

medians_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_median = NULL)
n_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_median = NULL)
q1_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_q1 = NULL)
q3_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("diastolic_imp_z_score_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_five_to_twenty[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_five_to_twenty[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_five_to_twenty[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_five_to_twenty[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_diastolic_SDS_imputations <-
    rbind(medians_of_diastolic_SDS_imputations,
          median_of_this_imputation)
  
  n_of_diastolic_SDS_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_diastolic_SDS_imputations,
          n_of_this_imputation)

  q1_of_diastolic_SDS_imputations <-
    rbind(q1_of_diastolic_SDS_imputations,
          q1_of_this_imputation)

  q3_of_diastolic_SDS_imputations <-
    rbind(q3_of_diastolic_SDS_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data diastolic SDS for patients five to twenty:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_five_to_twenty$diastolic_imp_z_score_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_five_to_twenty$diastolic_imp_z_score_0)),
  ") [",
  round(
  quantile(bp_data_five_to_twenty$diastolic_imp_z_score_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_five_to_twenty$diastolic_imp_z_score_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))

cat(
  
  "  \n  "
)

cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of diastolic SDS for patients five to twenty:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_diastolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_diastolic_SDS_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_diastolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_diastolic_SDS_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```

```{r, reporting median and interquartile range of original and imputed diastolic SDS in male patients five to twenty}

medians_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_median = NULL)
n_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_median = NULL)
q1_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_q1 = NULL)
q3_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("diastolic_imp_z_score_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_five_to_twenty_male[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_five_to_twenty_male[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_five_to_twenty_male[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_five_to_twenty_male[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_diastolic_SDS_imputations <-
    rbind(medians_of_diastolic_SDS_imputations,
          median_of_this_imputation)
  
  n_of_diastolic_SDS_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_diastolic_SDS_imputations,
          n_of_this_imputation)

  q1_of_diastolic_SDS_imputations <-
    rbind(q1_of_diastolic_SDS_imputations,
          q1_of_this_imputation)

  q3_of_diastolic_SDS_imputations <-
    rbind(q3_of_diastolic_SDS_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data diastolic SDS male five to twenty:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_five_to_twenty_male$diastolic_imp_z_score_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_five_to_twenty_male$diastolic_imp_z_score_0)),
  ") [",
  round(
  quantile(bp_data_five_to_twenty_male$diastolic_imp_z_score_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_five_to_twenty_male$diastolic_imp_z_score_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))

cat(
  
  "  \n  "
)

cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of diastolic SDS in male five to twenty:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_diastolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_diastolic_SDS_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_diastolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_diastolic_SDS_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```

```{r, reporting median and interquartile range of original and imputed diastolic SDS in fema patients five to twenty}

medians_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_median = NULL)
n_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_median = NULL)
q1_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_q1 = NULL)
q3_of_diastolic_SDS_imputations <- 
  data.frame(result_diastolic_q3 = NULL)

#loop through imputations, calculating median Q1 and Q3 each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("diastolic_imp_z_score_", imputation_number)

  median_of_this_imputation <- 
    median(bp_data_five_to_twenty_fema[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_five_to_twenty_fema[,column_name][[1]]))

  q1_of_this_imputation <- 
    quantile(bp_data_five_to_twenty_fema[,column_name][[1]], na.rm=T, 0.25)

  q3_of_this_imputation <- 
    quantile(bp_data_five_to_twenty_fema[,column_name][[1]], na.rm=T, 0.75)

  #take the median and quantiles and bind it to a frame outside the loop

  medians_of_diastolic_SDS_imputations <-
    rbind(medians_of_diastolic_SDS_imputations,
          median_of_this_imputation)
  
  n_of_diastolic_SDS_imputations <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(n_of_diastolic_SDS_imputations,
          n_of_this_imputation)

  q1_of_diastolic_SDS_imputations <-
    rbind(q1_of_diastolic_SDS_imputations,
          q1_of_this_imputation)

  q3_of_diastolic_SDS_imputations <-
    rbind(q3_of_diastolic_SDS_imputations,
          q3_of_this_imputation)
  
}
cat("Original patient data diastolic SDS fema five to twenty:\n")
cat(paste0("Median (n) [Q1 to Q3] = ",
             round(
  median(bp_data_five_to_twenty_fema$diastolic_imp_z_score_0, na.rm=T),
  digits=decimal_places),
  " (n=",
  sum(!is.na(bp_data_five_to_twenty_fema$diastolic_imp_z_score_0)),
  ") [",
  round(
  quantile(bp_data_five_to_twenty_fema$diastolic_imp_z_score_0, na.rm=T, 0.25),
  digits=decimal_places),
  " to ",
  round(
  quantile(bp_data_five_to_twenty_fema$diastolic_imp_z_score_0, na.rm=T, 0.75),
  digits=decimal_places),
  "]"
))

cat(
  
  "  \n  "
)

cat("we then take the means of the medians and quartiles across imputed datasets to present the summary statistics for imputed values of diastolic SDS in fema five to twenty:\n")
cat(paste0("Median (n) (Q1 to Q3) = ",
             round(
  mean(medians_of_diastolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " (n=",
  mean(n_of_diastolic_SDS_imputations[[1]]),
  ") [",
  round(
  mean(q1_of_diastolic_SDS_imputations[[1]]),
  digits=decimal_places),
  " to ",
  round(
  mean(q3_of_diastolic_SDS_imputations[[1]]),
  digits=decimal_places),
  "]"
))
```



########################
systolic proportion of visits over pre defined centile threshold
########################


```{r, reporting proportion systolic above threshold in all patients under twenty}
#define decimal places as zero for this one as we're reporting numbers of visits:
visit_decimal_places <- 0
proportion_decimal_places <- 1

cat("This is a reminder of our centile threshold for hypertension, which is defined at the top of the file:\n")
centile_threshold

cat(
  "  \n\n  "
  )

number_with_centile_threshold_systolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_systolic_for_each_imputation = NULL)

number_above_centile_threshold_systolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_systolic_for_each_imputation = NULL)

proportion_above_systolic_threshold_for_each_imputation <- 
  data.frame(proportion_above_systolic_threshold_for_each_imputation = NULL)

#loop through imputations, calculating number above threshold and proportion above threshold each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("systolic_imp_centile_above_", 
           centile_threshold,
           "th_",
           imputation_number)

  number_above_threshold_of_this_imputation <- 
    sum(bp_data_under_twenty[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty[,column_name][[1]]))

  proportion_above_threshold_of_this_imputation <- 
    number_above_threshold_of_this_imputation / n_of_this_imputation

  #take the number above threshold and proportion above threshold and bind it to a frame outside the loop
  number_with_centile_threshold_systolic_for_each_imputation <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(number_with_centile_threshold_systolic_for_each_imputation,
          n_of_this_imputation)

  number_above_centile_threshold_systolic_for_each_imputation <-
    rbind(number_above_centile_threshold_systolic_for_each_imputation,
          number_above_threshold_of_this_imputation)

  proportion_above_systolic_threshold_for_each_imputation <-
    rbind(proportion_above_systolic_threshold_for_each_imputation,
          proportion_above_threshold_of_this_imputation)
  
}

#to report patient data, we can create the column name with our threshold and use the zero imputation
threshold_column_name <-
  paste0("systolic_imp_centile_above_", 
           centile_threshold,
           "th_0")

cat("Original patient data under twenty years number and proportion of systolic over threshold:\n")
cat(paste0("Number / total (%) = ",
             round(
  sum(bp_data_under_twenty[,threshold_column_name][[1]], na.rm=T),
                   digits=visit_decimal_places),
  " / ",
  sum(!is.na(bp_data_under_twenty[,threshold_column_name][[1]])),
  " (",
  round(
  100 * 
  sum(bp_data_under_twenty[,threshold_column_name][[1]], na.rm=T) /
    sum(!is.na(bp_data_under_twenty[,threshold_column_name][[1]])),
  digits=proportion_decimal_places),
  "%)"
))

cat(
  "  \n\n  "
)

cat("we then take the means of the number and proportions above the threshold across imputed datasets to present the summary statistics for imputed values of visits under twenty years with systolic hypertension:\n\n")
cat(paste0("Imputed data number and proportion of systolic visit data over threshold:\n",
           "Number / total (%) = ",
             round(
  mean(number_above_centile_threshold_systolic_for_each_imputation[[1]]), 
  digits=visit_decimal_places),
  " / ",
  mean(number_with_centile_threshold_systolic_for_each_imputation[[1]]),
  " (",
  round(
    100 * 
  mean(proportion_above_systolic_threshold_for_each_imputation[[1]]),
  digits=proportion_decimal_places),
  "%)"
))
```

```{r, reporting proportion systolic above threshold in male patients under twenty}
#define decimal places as zero for this one as we're reporting numbers of visits:
visit_decimal_places <- 0
proportion_decimal_places <- 1

cat("This is a reminder of our centile threshold for hypertension, which is defined at the top of the file:\n")
centile_threshold

cat(
  "  \n\n  "
  )

number_with_centile_threshold_systolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_systolic_for_each_imputation = NULL)

number_above_centile_threshold_systolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_systolic_for_each_imputation = NULL)

proportion_above_systolic_threshold_for_each_imputation <- 
  data.frame(proportion_above_systolic_threshold_for_each_imputation = NULL)

#loop through imputations, calculating number above threshold and proportion above threshold each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("systolic_imp_centile_above_", 
           centile_threshold,
           "th_",
           imputation_number)

  number_above_threshold_of_this_imputation <- 
    sum(bp_data_under_twenty_male[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty_male[,column_name][[1]]))

  proportion_above_threshold_of_this_imputation <- 
    number_above_threshold_of_this_imputation / n_of_this_imputation

  #take the number above threshold and proportion above threshold and bind it to a frame outside the loop
  number_with_centile_threshold_systolic_for_each_imputation <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(number_with_centile_threshold_systolic_for_each_imputation,
          n_of_this_imputation)

  number_above_centile_threshold_systolic_for_each_imputation <-
    rbind(number_above_centile_threshold_systolic_for_each_imputation,
          number_above_threshold_of_this_imputation)

  proportion_above_systolic_threshold_for_each_imputation <-
    rbind(proportion_above_systolic_threshold_for_each_imputation,
          proportion_above_threshold_of_this_imputation)
  
}

#to report patient data, we can create the column name with our threshold and use the zero imputation
threshold_column_name <-
  paste0("systolic_imp_centile_above_", 
           centile_threshold,
           "th_0")

cat("Original male patient data under twenty years number and proportion of systolic over threshold:\n")
cat(paste0("Number / total (%) = ",
             round(
  sum(bp_data_under_twenty_male[,threshold_column_name][[1]], na.rm=T),
                   digits=visit_decimal_places),
  " / ",
  sum(!is.na(bp_data_under_twenty_male[,threshold_column_name][[1]])),
  " (",
  round(
  100 * 
  sum(bp_data_under_twenty_male[,threshold_column_name][[1]], na.rm=T) /
    sum(!is.na(bp_data_under_twenty_male[,threshold_column_name][[1]])),
  digits=proportion_decimal_places),
  "%)"
))

cat(
  "  \n\n  "
)

cat("we then take the means of the number and proportions above the threshold across imputed datasets to present the summary statistics for imputed values of visits under twenty years with systolic hypertension:\n\n")
cat(paste0("Imputed male data number and proportion of systolic visit data over threshold:\n",
           "Number / total (%) = ",
             round(
  mean(number_above_centile_threshold_systolic_for_each_imputation[[1]]), 
  digits=visit_decimal_places),
  " / ",
  mean(number_with_centile_threshold_systolic_for_each_imputation[[1]]),
  " (",
  round(
    100 * 
  mean(proportion_above_systolic_threshold_for_each_imputation[[1]]),
  digits=proportion_decimal_places),
  "%)"
))
```

```{r, reporting proportion systolic above threshold in fema patients under twenty}
#define decimal places as zero for this one as we're reporting numbers of visits:
visit_decimal_places <- 0
proportion_decimal_places <- 1

cat("This is a reminder of our centile threshold for hypertension, which is defined at the top of the file:\n")
centile_threshold

cat(
  "  \n\n  "
  )

number_with_centile_threshold_systolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_systolic_for_each_imputation = NULL)

number_above_centile_threshold_systolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_systolic_for_each_imputation = NULL)

proportion_above_systolic_threshold_for_each_imputation <- 
  data.frame(proportion_above_systolic_threshold_for_each_imputation = NULL)

#loop through imputations, calculating number above threshold and proportion above threshold each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("systolic_imp_centile_above_", 
           centile_threshold,
           "th_",
           imputation_number)

  number_above_threshold_of_this_imputation <- 
    sum(bp_data_under_twenty_fema[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty_fema[,column_name][[1]]))

  proportion_above_threshold_of_this_imputation <- 
    number_above_threshold_of_this_imputation / n_of_this_imputation

  #take the number above threshold and proportion above threshold and bind it to a frame outside the loop
  number_with_centile_threshold_systolic_for_each_imputation <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(number_with_centile_threshold_systolic_for_each_imputation,
          n_of_this_imputation)

  number_above_centile_threshold_systolic_for_each_imputation <-
    rbind(number_above_centile_threshold_systolic_for_each_imputation,
          number_above_threshold_of_this_imputation)

  proportion_above_systolic_threshold_for_each_imputation <-
    rbind(proportion_above_systolic_threshold_for_each_imputation,
          proportion_above_threshold_of_this_imputation)
  
}

#to report patient data, we can create the column name with our threshold and use the zero imputation
threshold_column_name <-
  paste0("systolic_imp_centile_above_", 
           centile_threshold,
           "th_0")

cat("Original fema patient data under twenty years number and proportion of systolic over threshold:\n")
cat(paste0("Number / total (%) = ",
             round(
  sum(bp_data_under_twenty_fema[,threshold_column_name][[1]], na.rm=T),
                   digits=visit_decimal_places),
  " / ",
  sum(!is.na(bp_data_under_twenty_fema[,threshold_column_name][[1]])),
  " (",
  round(
  100 * 
  sum(bp_data_under_twenty_fema[,threshold_column_name][[1]], na.rm=T) /
    sum(!is.na(bp_data_under_twenty_fema[,threshold_column_name][[1]])),
  digits=proportion_decimal_places),
  "%)"
))

cat(
  "  \n\n  "
)

cat("we then take the means of the number and proportions above the threshold across imputed datasets to present the summary statistics for imputed values of visits under twenty years with systolic hypertension:\n\n")
cat(paste0("Imputed fema data number and proportion of systolic visit data over threshold:\n",
           "Number / total (%) = ",
             round(
  mean(number_above_centile_threshold_systolic_for_each_imputation[[1]]), 
  digits=visit_decimal_places),
  " / ",
  mean(number_with_centile_threshold_systolic_for_each_imputation[[1]]),
  " (",
  round(
    100 * 
  mean(proportion_above_systolic_threshold_for_each_imputation[[1]]),
  digits=proportion_decimal_places),
  "%)"
))
```

```{r, reporting proportion systolic above threshold in all patients under five}
#define decimal places as zero for this one as we're reporting numbers of visits:
visit_decimal_places <- 0
proportion_decimal_places <- 1

cat("This is a reminder of our centile threshold for hypertension, which is defined at the top of the file:\n")
centile_threshold

cat(
  "  \n\n  "
  )

number_with_centile_threshold_systolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_systolic_for_each_imputation = NULL)

number_above_centile_threshold_systolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_systolic_for_each_imputation = NULL)

proportion_above_systolic_threshold_for_each_imputation <- 
  data.frame(proportion_above_systolic_threshold_for_each_imputation = NULL)

#loop through imputations, calculating number above threshold and proportion above threshold each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("systolic_imp_centile_above_", 
           centile_threshold,
           "th_",
           imputation_number)

  number_above_threshold_of_this_imputation <- 
    sum(bp_data_under_five[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_five[,column_name][[1]]))

  proportion_above_threshold_of_this_imputation <- 
    number_above_threshold_of_this_imputation / n_of_this_imputation

  #take the number above threshold and proportion above threshold and bind it to a frame outside the loop
  number_with_centile_threshold_systolic_for_each_imputation <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(number_with_centile_threshold_systolic_for_each_imputation,
          n_of_this_imputation)

  number_above_centile_threshold_systolic_for_each_imputation <-
    rbind(number_above_centile_threshold_systolic_for_each_imputation,
          number_above_threshold_of_this_imputation)

  proportion_above_systolic_threshold_for_each_imputation <-
    rbind(proportion_above_systolic_threshold_for_each_imputation,
          proportion_above_threshold_of_this_imputation)
  
}

#to report patient data, we can create the column name with our threshold and use the zero imputation
threshold_column_name <-
  paste0("systolic_imp_centile_above_", 
           centile_threshold,
           "th_0")

cat("Original patient data under five years number and proportion of systolic over threshold:\n")
cat(paste0("Number / total (%) = ",
             round(
  sum(bp_data_under_five[,threshold_column_name][[1]], na.rm=T),
                   digits=visit_decimal_places),
  " / ",
  sum(!is.na(bp_data_under_five[,threshold_column_name][[1]])),
  " (",
  round(
  100 * 
  sum(bp_data_under_five[,threshold_column_name][[1]], na.rm=T) /
    sum(!is.na(bp_data_under_five[,threshold_column_name][[1]])),
  digits=proportion_decimal_places),
  "%)"
))

cat(
  "  \n\n  "
)

cat("we then take the means of the number and proportions above the threshold across imputed datasets to present the summary statistics for imputed values of visits under five years with systolic hypertension:\n\n")
cat(paste0("Imputed data number and proportion of systolic visit data over threshold:\n",
           "Number / total (%) = ",
             round(
  mean(number_above_centile_threshold_systolic_for_each_imputation[[1]]), 
  digits=visit_decimal_places),
  " / ",
  mean(number_with_centile_threshold_systolic_for_each_imputation[[1]]),
  " (",
  round(
    100 * 
  mean(proportion_above_systolic_threshold_for_each_imputation[[1]]),
  digits=proportion_decimal_places),
  "%)"
))
```

```{r, reporting proportion systolic above threshold in male patients under five}
#define decimal places as zero for this one as we're reporting numbers of visits:
visit_decimal_places <- 0
proportion_decimal_places <- 1

cat("This is a reminder of our centile threshold for hypertension, which is defined at the top of the file:\n")
centile_threshold

cat(
  "  \n\n  "
  )

number_with_centile_threshold_systolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_systolic_for_each_imputation = NULL)

number_above_centile_threshold_systolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_systolic_for_each_imputation = NULL)

proportion_above_systolic_threshold_for_each_imputation <- 
  data.frame(proportion_above_systolic_threshold_for_each_imputation = NULL)

#loop through imputations, calculating number above threshold and proportion above threshold each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("systolic_imp_centile_above_", 
           centile_threshold,
           "th_",
           imputation_number)

  number_above_threshold_of_this_imputation <- 
    sum(bp_data_under_five_male[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_five_male[,column_name][[1]]))

  proportion_above_threshold_of_this_imputation <- 
    number_above_threshold_of_this_imputation / n_of_this_imputation

  #take the number above threshold and proportion above threshold and bind it to a frame outside the loop
  number_with_centile_threshold_systolic_for_each_imputation <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(number_with_centile_threshold_systolic_for_each_imputation,
          n_of_this_imputation)

  number_above_centile_threshold_systolic_for_each_imputation <-
    rbind(number_above_centile_threshold_systolic_for_each_imputation,
          number_above_threshold_of_this_imputation)

  proportion_above_systolic_threshold_for_each_imputation <-
    rbind(proportion_above_systolic_threshold_for_each_imputation,
          proportion_above_threshold_of_this_imputation)
  
}

#to report patient data, we can create the column name with our threshold and use the zero imputation
threshold_column_name <-
  paste0("systolic_imp_centile_above_", 
           centile_threshold,
           "th_0")

cat("Original male patient data under five years number and proportion of systolic over threshold:\n")
cat(paste0("Number / total (%) = ",
             round(
  sum(bp_data_under_five_male[,threshold_column_name][[1]], na.rm=T),
                   digits=visit_decimal_places),
  " / ",
  sum(!is.na(bp_data_under_five_male[,threshold_column_name][[1]])),
  " (",
  round(
  100 * 
  sum(bp_data_under_five_male[,threshold_column_name][[1]], na.rm=T) /
    sum(!is.na(bp_data_under_five_male[,threshold_column_name][[1]])),
  digits=proportion_decimal_places),
  "%)"
))

cat(
  "  \n\n  "
)

cat("we then take the means of the number and proportions above the threshold across imputed datasets to present the summary statistics for imputed values of visits under five years with systolic hypertension:\n\n")
cat(paste0("Imputed male data number and proportion of systolic visit data over threshold:\n",
           "Number / total (%) = ",
             round(
  mean(number_above_centile_threshold_systolic_for_each_imputation[[1]]), 
  digits=visit_decimal_places),
  " / ",
  mean(number_with_centile_threshold_systolic_for_each_imputation[[1]]),
  " (",
  round(
    100 * 
  mean(proportion_above_systolic_threshold_for_each_imputation[[1]]),
  digits=proportion_decimal_places),
  "%)"
))
```

```{r, reporting proportion systolic above threshold in fema patients under five}
#define decimal places as zero for this one as we're reporting numbers of visits:
visit_decimal_places <- 0
proportion_decimal_places <- 1

cat("This is a reminder of our centile threshold for hypertension, which is defined at the top of the file:\n")
centile_threshold

cat(
  "  \n\n  "
  )

number_with_centile_threshold_systolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_systolic_for_each_imputation = NULL)

number_above_centile_threshold_systolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_systolic_for_each_imputation = NULL)

proportion_above_systolic_threshold_for_each_imputation <- 
  data.frame(proportion_above_systolic_threshold_for_each_imputation = NULL)

#loop through imputations, calculating number above threshold and proportion above threshold each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("systolic_imp_centile_above_", 
           centile_threshold,
           "th_",
           imputation_number)

  number_above_threshold_of_this_imputation <- 
    sum(bp_data_under_five_fema[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_five_fema[,column_name][[1]]))

  proportion_above_threshold_of_this_imputation <- 
    number_above_threshold_of_this_imputation / n_of_this_imputation

  #take the number above threshold and proportion above threshold and bind it to a frame outside the loop
  number_with_centile_threshold_systolic_for_each_imputation <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(number_with_centile_threshold_systolic_for_each_imputation,
          n_of_this_imputation)

  number_above_centile_threshold_systolic_for_each_imputation <-
    rbind(number_above_centile_threshold_systolic_for_each_imputation,
          number_above_threshold_of_this_imputation)

  proportion_above_systolic_threshold_for_each_imputation <-
    rbind(proportion_above_systolic_threshold_for_each_imputation,
          proportion_above_threshold_of_this_imputation)
  
}

#to report patient data, we can create the column name with our threshold and use the zero imputation
threshold_column_name <-
  paste0("systolic_imp_centile_above_", 
           centile_threshold,
           "th_0")

cat("Original fema patient data under five years number and proportion of systolic over threshold:\n")
cat(paste0("Number / total (%) = ",
             round(
  sum(bp_data_under_five_fema[,threshold_column_name][[1]], na.rm=T),
                   digits=visit_decimal_places),
  " / ",
  sum(!is.na(bp_data_under_five_fema[,threshold_column_name][[1]])),
  " (",
  round(
  100 * 
  sum(bp_data_under_five_fema[,threshold_column_name][[1]], na.rm=T) /
    sum(!is.na(bp_data_under_five_fema[,threshold_column_name][[1]])),
  digits=proportion_decimal_places),
  "%)"
))

cat(
  "  \n\n  "
)

cat("we then take the means of the number and proportions above the threshold across imputed datasets to present the summary statistics for imputed values of visits under five years with systolic hypertension:\n\n")
cat(paste0("Imputed fema data number and proportion of systolic visit data over threshold:\n",
           "Number / total (%) = ",
             round(
  mean(number_above_centile_threshold_systolic_for_each_imputation[[1]]), 
  digits=visit_decimal_places),
  " / ",
  mean(number_with_centile_threshold_systolic_for_each_imputation[[1]]),
  " (",
  round(
    100 * 
  mean(proportion_above_systolic_threshold_for_each_imputation[[1]]),
  digits=proportion_decimal_places),
  "%)"
))
```

```{r, reporting proportion systolic above threshold in all patients five to twenty}
#define decimal places as zero for this one as we're reporting numbers of visits:
visit_decimal_places <- 0
proportion_decimal_places <- 1

cat("This is a reminder of our centile threshold for hypertension, which is defined at the top of the file:\n")
centile_threshold

cat(
  "  \n\n  "
  )

number_with_centile_threshold_systolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_systolic_for_each_imputation = NULL)

number_above_centile_threshold_systolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_systolic_for_each_imputation = NULL)

proportion_above_systolic_threshold_for_each_imputation <- 
  data.frame(proportion_above_systolic_threshold_for_each_imputation = NULL)

#loop through imputations, calculating number above threshold and proportion above threshold each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("systolic_imp_centile_above_", 
           centile_threshold,
           "th_",
           imputation_number)

  number_above_threshold_of_this_imputation <- 
    sum(bp_data_five_to_twenty[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_five_to_twenty[,column_name][[1]]))

  proportion_above_threshold_of_this_imputation <- 
    number_above_threshold_of_this_imputation / n_of_this_imputation

  #take the number above threshold and proportion above threshold and bind it to a frame outside the loop
  number_with_centile_threshold_systolic_for_each_imputation <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(number_with_centile_threshold_systolic_for_each_imputation,
          n_of_this_imputation)

  number_above_centile_threshold_systolic_for_each_imputation <-
    rbind(number_above_centile_threshold_systolic_for_each_imputation,
          number_above_threshold_of_this_imputation)

  proportion_above_systolic_threshold_for_each_imputation <-
    rbind(proportion_above_systolic_threshold_for_each_imputation,
          proportion_above_threshold_of_this_imputation)
  
}

#to report patient data, we can create the column name with our threshold and use the zero imputation
threshold_column_name <-
  paste0("systolic_imp_centile_above_", 
           centile_threshold,
           "th_0")

cat("Original patient data five to twenty years number and proportion of systolic over threshold:\n")
cat(paste0("Number / total (%) = ",
             round(
  sum(bp_data_five_to_twenty[,threshold_column_name][[1]], na.rm=T),
                   digits=visit_decimal_places),
  " / ",
  sum(!is.na(bp_data_five_to_twenty[,threshold_column_name][[1]])),
  " (",
  round(
  100 * 
  sum(bp_data_five_to_twenty[,threshold_column_name][[1]], na.rm=T) /
    sum(!is.na(bp_data_five_to_twenty[,threshold_column_name][[1]])),
  digits=proportion_decimal_places),
  "%)"
))

cat(
  "  \n\n  "
)

cat("we then take the means of the number and proportions above the threshold across imputed datasets to present the summary statistics for imputed values of visits five to twenty years with systolic hypertension:\n\n")
cat(paste0("Imputed data number and proportion of systolic visit data over threshold:\n",
           "Number / total (%) = ",
             round(
  mean(number_above_centile_threshold_systolic_for_each_imputation[[1]]), 
  digits=visit_decimal_places),
  " / ",
  mean(number_with_centile_threshold_systolic_for_each_imputation[[1]]),
  " (",
  round(
    100 * 
  mean(proportion_above_systolic_threshold_for_each_imputation[[1]]),
  digits=proportion_decimal_places),
  "%)"
))
```

```{r, reporting proportion systolic above threshold in male patients five to twenty}
#define decimal places as zero for this one as we're reporting numbers of visits:
visit_decimal_places <- 0
proportion_decimal_places <- 1

cat("This is a reminder of our centile threshold for hypertension, which is defined at the top of the file:\n")
centile_threshold

cat(
  "  \n\n  "
  )

number_with_centile_threshold_systolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_systolic_for_each_imputation = NULL)

number_above_centile_threshold_systolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_systolic_for_each_imputation = NULL)

proportion_above_systolic_threshold_for_each_imputation <- 
  data.frame(proportion_above_systolic_threshold_for_each_imputation = NULL)

#loop through imputations, calculating number above threshold and proportion above threshold each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("systolic_imp_centile_above_", 
           centile_threshold,
           "th_",
           imputation_number)

  number_above_threshold_of_this_imputation <- 
    sum(bp_data_five_to_twenty_male[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_five_to_twenty_male[,column_name][[1]]))

  proportion_above_threshold_of_this_imputation <- 
    number_above_threshold_of_this_imputation / n_of_this_imputation

  #take the number above threshold and proportion above threshold and bind it to a frame outside the loop
  number_with_centile_threshold_systolic_for_each_imputation <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(number_with_centile_threshold_systolic_for_each_imputation,
          n_of_this_imputation)

  number_above_centile_threshold_systolic_for_each_imputation <-
    rbind(number_above_centile_threshold_systolic_for_each_imputation,
          number_above_threshold_of_this_imputation)

  proportion_above_systolic_threshold_for_each_imputation <-
    rbind(proportion_above_systolic_threshold_for_each_imputation,
          proportion_above_threshold_of_this_imputation)
  
}

#to report patient data, we can create the column name with our threshold and use the zero imputation
threshold_column_name <-
  paste0("systolic_imp_centile_above_", 
           centile_threshold,
           "th_0")

cat("Original male patient data five to twenty years number and proportion of systolic over threshold:\n")
cat(paste0("Number / total (%) = ",
             round(
  sum(bp_data_five_to_twenty_male[,threshold_column_name][[1]], na.rm=T),
                   digits=visit_decimal_places),
  " / ",
  sum(!is.na(bp_data_five_to_twenty_male[,threshold_column_name][[1]])),
  " (",
  round(
  100 * 
  sum(bp_data_five_to_twenty_male[,threshold_column_name][[1]], na.rm=T) /
    sum(!is.na(bp_data_five_to_twenty_male[,threshold_column_name][[1]])),
  digits=proportion_decimal_places),
  "%)"
))

cat(
  "  \n\n  "
)

cat("we then take the means of the number and proportions above the threshold across imputed datasets to present the summary statistics for imputed values of visits five to twenty years with systolic hypertension:\n\n")
cat(paste0("Imputed male data number and proportion of systolic visit data over threshold:\n",
           "Number / total (%) = ",
             round(
  mean(number_above_centile_threshold_systolic_for_each_imputation[[1]]), 
  digits=visit_decimal_places),
  " / ",
  mean(number_with_centile_threshold_systolic_for_each_imputation[[1]]),
  " (",
  round(
    100 * 
  mean(proportion_above_systolic_threshold_for_each_imputation[[1]]),
  digits=proportion_decimal_places),
  "%)"
))
```

```{r, reporting proportion systolic above threshold in fema patients five to twenty}
#define decimal places as zero for this one as we're reporting numbers of visits:
visit_decimal_places <- 0
proportion_decimal_places <- 1

cat("This is a reminder of our centile threshold for hypertension, which is defined at the top of the file:\n")
centile_threshold

cat(
  "  \n\n  "
  )

number_with_centile_threshold_systolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_systolic_for_each_imputation = NULL)

number_above_centile_threshold_systolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_systolic_for_each_imputation = NULL)

proportion_above_systolic_threshold_for_each_imputation <- 
  data.frame(proportion_above_systolic_threshold_for_each_imputation = NULL)

#loop through imputations, calculating number above threshold and proportion above threshold each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("systolic_imp_centile_above_", 
           centile_threshold,
           "th_",
           imputation_number)

  number_above_threshold_of_this_imputation <- 
    sum(bp_data_five_to_twenty_fema[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_five_to_twenty_fema[,column_name][[1]]))

  proportion_above_threshold_of_this_imputation <- 
    number_above_threshold_of_this_imputation / n_of_this_imputation

  #take the number above threshold and proportion above threshold and bind it to a frame outside the loop
  number_with_centile_threshold_systolic_for_each_imputation <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(number_with_centile_threshold_systolic_for_each_imputation,
          n_of_this_imputation)

  number_above_centile_threshold_systolic_for_each_imputation <-
    rbind(number_above_centile_threshold_systolic_for_each_imputation,
          number_above_threshold_of_this_imputation)

  proportion_above_systolic_threshold_for_each_imputation <-
    rbind(proportion_above_systolic_threshold_for_each_imputation,
          proportion_above_threshold_of_this_imputation)
  
}

#to report patient data, we can create the column name with our threshold and use the zero imputation
threshold_column_name <-
  paste0("systolic_imp_centile_above_", 
           centile_threshold,
           "th_0")

cat("Original fema patient data five to twenty years number and proportion of systolic over threshold:\n")
cat(paste0("Number / total (%) = ",
             round(
  sum(bp_data_five_to_twenty_fema[,threshold_column_name][[1]], na.rm=T),
                   digits=visit_decimal_places),
  " / ",
  sum(!is.na(bp_data_five_to_twenty_fema[,threshold_column_name][[1]])),
  " (",
  round(
  100 * 
  sum(bp_data_five_to_twenty_fema[,threshold_column_name][[1]], na.rm=T) /
    sum(!is.na(bp_data_five_to_twenty_fema[,threshold_column_name][[1]])),
  digits=proportion_decimal_places),
  "%)"
))

cat(
  "  \n\n  "
)

cat("we then take the means of the number and proportions above the threshold across imputed datasets to present the summary statistics for imputed values of visits five to twenty years with systolic hypertension:\n\n")
cat(paste0("Imputed fema data number and proportion of systolic visit data over threshold:\n",
           "Number / total (%) = ",
             round(
  mean(number_above_centile_threshold_systolic_for_each_imputation[[1]]), 
  digits=visit_decimal_places),
  " / ",
  mean(number_with_centile_threshold_systolic_for_each_imputation[[1]]),
  " (",
  round(
    100 * 
  mean(proportion_above_systolic_threshold_for_each_imputation[[1]]),
  digits=proportion_decimal_places),
  "%)"
))
```


########################
diastolic proportion of visits over pre defined centile threshold
########################


```{r, reporting proportion diastolic above threshold in all patients under twenty}
#define decimal places as zero for this one as we're reporting numbers of visits:
visit_decimal_places <- 0
proportion_decimal_places <- 1

cat("This is a reminder of our centile threshold for hypertension, which is defined at the top of the file:\n")
centile_threshold

cat(
  "  \n\n  "
  )

number_with_centile_threshold_diastolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_diastolic_for_each_imputation = NULL)

number_above_centile_threshold_diastolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_diastolic_for_each_imputation = NULL)

proportion_above_diastolic_threshold_for_each_imputation <- 
  data.frame(proportion_above_diastolic_threshold_for_each_imputation = NULL)

#loop through imputations, calculating number above threshold and proportion above threshold each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("diastolic_imp_centile_above_", 
           centile_threshold,
           "th_",
           imputation_number)

  number_above_threshold_of_this_imputation <- 
    sum(bp_data_under_twenty[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty[,column_name][[1]]))

  proportion_above_threshold_of_this_imputation <- 
    number_above_threshold_of_this_imputation / n_of_this_imputation

  #take the number above threshold and proportion above threshold and bind it to a frame outside the loop
  number_with_centile_threshold_diastolic_for_each_imputation <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(number_with_centile_threshold_diastolic_for_each_imputation,
          n_of_this_imputation)

  number_above_centile_threshold_diastolic_for_each_imputation <-
    rbind(number_above_centile_threshold_diastolic_for_each_imputation,
          number_above_threshold_of_this_imputation)

  proportion_above_diastolic_threshold_for_each_imputation <-
    rbind(proportion_above_diastolic_threshold_for_each_imputation,
          proportion_above_threshold_of_this_imputation)
  
}

#to report patient data, we can create the column name with our threshold and use the zero imputation
threshold_column_name <-
  paste0("diastolic_imp_centile_above_", 
           centile_threshold,
           "th_0")

cat("Original patient data under twenty years number and proportion of diastolic over threshold:\n")
cat(paste0("Number / total (%) = ",
             round(
  sum(bp_data_under_twenty[,threshold_column_name][[1]], na.rm=T),
                   digits=visit_decimal_places),
  " / ",
  sum(!is.na(bp_data_under_twenty[,threshold_column_name][[1]])),
  " (",
  round(
  100 * 
  sum(bp_data_under_twenty[,threshold_column_name][[1]], na.rm=T) /
    sum(!is.na(bp_data_under_twenty[,threshold_column_name][[1]])),
  digits=proportion_decimal_places),
  "%)"
))

cat(
  "  \n\n  "
)

cat("we then take the means of the number and proportions above the threshold across imputed datasets to present the summary statistics for imputed values of visits under twenty years with diastolic hypertension:\n\n")
cat(paste0("Imputed data number and proportion of diastolic visit data over threshold:\n",
           "Number / total (%) = ",
             round(
  mean(number_above_centile_threshold_diastolic_for_each_imputation[[1]]), 
  digits=visit_decimal_places),
  " / ",
  mean(number_with_centile_threshold_diastolic_for_each_imputation[[1]]),
  " (",
  round(
    100 * 
  mean(proportion_above_diastolic_threshold_for_each_imputation[[1]]),
  digits=proportion_decimal_places),
  "%)"
))
```

```{r, reporting proportion diastolic above threshold in male patients under twenty}
#define decimal places as zero for this one as we're reporting numbers of visits:
visit_decimal_places <- 0
proportion_decimal_places <- 1

cat("This is a reminder of our centile threshold for hypertension, which is defined at the top of the file:\n")
centile_threshold

cat(
  "  \n\n  "
  )

number_with_centile_threshold_diastolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_diastolic_for_each_imputation = NULL)

number_above_centile_threshold_diastolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_diastolic_for_each_imputation = NULL)

proportion_above_diastolic_threshold_for_each_imputation <- 
  data.frame(proportion_above_diastolic_threshold_for_each_imputation = NULL)

#loop through imputations, calculating number above threshold and proportion above threshold each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("diastolic_imp_centile_above_", 
           centile_threshold,
           "th_",
           imputation_number)

  number_above_threshold_of_this_imputation <- 
    sum(bp_data_under_twenty_male[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty_male[,column_name][[1]]))

  proportion_above_threshold_of_this_imputation <- 
    number_above_threshold_of_this_imputation / n_of_this_imputation

  #take the number above threshold and proportion above threshold and bind it to a frame outside the loop
  number_with_centile_threshold_diastolic_for_each_imputation <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(number_with_centile_threshold_diastolic_for_each_imputation,
          n_of_this_imputation)

  number_above_centile_threshold_diastolic_for_each_imputation <-
    rbind(number_above_centile_threshold_diastolic_for_each_imputation,
          number_above_threshold_of_this_imputation)

  proportion_above_diastolic_threshold_for_each_imputation <-
    rbind(proportion_above_diastolic_threshold_for_each_imputation,
          proportion_above_threshold_of_this_imputation)
  
}

#to report patient data, we can create the column name with our threshold and use the zero imputation
threshold_column_name <-
  paste0("diastolic_imp_centile_above_", 
           centile_threshold,
           "th_0")

cat("Original male patient data under twenty years number and proportion of diastolic over threshold:\n")
cat(paste0("Number / total (%) = ",
             round(
  sum(bp_data_under_twenty_male[,threshold_column_name][[1]], na.rm=T),
                   digits=visit_decimal_places),
  " / ",
  sum(!is.na(bp_data_under_twenty_male[,threshold_column_name][[1]])),
  " (",
  round(
  100 * 
  sum(bp_data_under_twenty_male[,threshold_column_name][[1]], na.rm=T) /
    sum(!is.na(bp_data_under_twenty_male[,threshold_column_name][[1]])),
  digits=proportion_decimal_places),
  "%)"
))

cat(
  "  \n\n  "
)

cat("we then take the means of the number and proportions above the threshold across imputed datasets to present the summary statistics for imputed values of visits under twenty years with diastolic hypertension:\n\n")
cat(paste0("Imputed male data number and proportion of diastolic visit data over threshold:\n",
           "Number / total (%) = ",
             round(
  mean(number_above_centile_threshold_diastolic_for_each_imputation[[1]]), 
  digits=visit_decimal_places),
  " / ",
  mean(number_with_centile_threshold_diastolic_for_each_imputation[[1]]),
  " (",
  round(
    100 * 
  mean(proportion_above_diastolic_threshold_for_each_imputation[[1]]),
  digits=proportion_decimal_places),
  "%)"
))
```

```{r, reporting proportion diastolic above threshold in fema patients under twenty}
#define decimal places as zero for this one as we're reporting numbers of visits:
visit_decimal_places <- 0
proportion_decimal_places <- 1

cat("This is a reminder of our centile threshold for hypertension, which is defined at the top of the file:\n")
centile_threshold

cat(
  "  \n\n  "
  )

number_with_centile_threshold_diastolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_diastolic_for_each_imputation = NULL)

number_above_centile_threshold_diastolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_diastolic_for_each_imputation = NULL)

proportion_above_diastolic_threshold_for_each_imputation <- 
  data.frame(proportion_above_diastolic_threshold_for_each_imputation = NULL)

#loop through imputations, calculating number above threshold and proportion above threshold each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("diastolic_imp_centile_above_", 
           centile_threshold,
           "th_",
           imputation_number)

  number_above_threshold_of_this_imputation <- 
    sum(bp_data_under_twenty_fema[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_twenty_fema[,column_name][[1]]))

  proportion_above_threshold_of_this_imputation <- 
    number_above_threshold_of_this_imputation / n_of_this_imputation

  #take the number above threshold and proportion above threshold and bind it to a frame outside the loop
  number_with_centile_threshold_diastolic_for_each_imputation <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(number_with_centile_threshold_diastolic_for_each_imputation,
          n_of_this_imputation)

  number_above_centile_threshold_diastolic_for_each_imputation <-
    rbind(number_above_centile_threshold_diastolic_for_each_imputation,
          number_above_threshold_of_this_imputation)

  proportion_above_diastolic_threshold_for_each_imputation <-
    rbind(proportion_above_diastolic_threshold_for_each_imputation,
          proportion_above_threshold_of_this_imputation)
  
}

#to report patient data, we can create the column name with our threshold and use the zero imputation
threshold_column_name <-
  paste0("diastolic_imp_centile_above_", 
           centile_threshold,
           "th_0")

cat("Original fema patient data under twenty years number and proportion of diastolic over threshold:\n")
cat(paste0("Number / total (%) = ",
             round(
  sum(bp_data_under_twenty_fema[,threshold_column_name][[1]], na.rm=T),
                   digits=visit_decimal_places),
  " / ",
  sum(!is.na(bp_data_under_twenty_fema[,threshold_column_name][[1]])),
  " (",
  round(
  100 * 
  sum(bp_data_under_twenty_fema[,threshold_column_name][[1]], na.rm=T) /
    sum(!is.na(bp_data_under_twenty_fema[,threshold_column_name][[1]])),
  digits=proportion_decimal_places),
  "%)"
))

cat(
  "  \n\n  "
)

cat("we then take the means of the number and proportions above the threshold across imputed datasets to present the summary statistics for imputed values of visits under twenty years with diastolic hypertension:\n\n")
cat(paste0("Imputed fema data number and proportion of diastolic visit data over threshold:\n",
           "Number / total (%) = ",
             round(
  mean(number_above_centile_threshold_diastolic_for_each_imputation[[1]]), 
  digits=visit_decimal_places),
  " / ",
  mean(number_with_centile_threshold_diastolic_for_each_imputation[[1]]),
  " (",
  round(
    100 * 
  mean(proportion_above_diastolic_threshold_for_each_imputation[[1]]),
  digits=proportion_decimal_places),
  "%)"
))
```

```{r, reporting proportion diastolic above threshold in all patients under five}
#define decimal places as zero for this one as we're reporting numbers of visits:
visit_decimal_places <- 0
proportion_decimal_places <- 1

cat("This is a reminder of our centile threshold for hypertension, which is defined at the top of the file:\n")
centile_threshold

cat(
  "  \n\n  "
  )

number_with_centile_threshold_diastolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_diastolic_for_each_imputation = NULL)

number_above_centile_threshold_diastolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_diastolic_for_each_imputation = NULL)

proportion_above_diastolic_threshold_for_each_imputation <- 
  data.frame(proportion_above_diastolic_threshold_for_each_imputation = NULL)

#loop through imputations, calculating number above threshold and proportion above threshold each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("diastolic_imp_centile_above_", 
           centile_threshold,
           "th_",
           imputation_number)

  number_above_threshold_of_this_imputation <- 
    sum(bp_data_under_five[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_five[,column_name][[1]]))

  proportion_above_threshold_of_this_imputation <- 
    number_above_threshold_of_this_imputation / n_of_this_imputation

  #take the number above threshold and proportion above threshold and bind it to a frame outside the loop
  number_with_centile_threshold_diastolic_for_each_imputation <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(number_with_centile_threshold_diastolic_for_each_imputation,
          n_of_this_imputation)

  number_above_centile_threshold_diastolic_for_each_imputation <-
    rbind(number_above_centile_threshold_diastolic_for_each_imputation,
          number_above_threshold_of_this_imputation)

  proportion_above_diastolic_threshold_for_each_imputation <-
    rbind(proportion_above_diastolic_threshold_for_each_imputation,
          proportion_above_threshold_of_this_imputation)
  
}

#to report patient data, we can create the column name with our threshold and use the zero imputation
threshold_column_name <-
  paste0("diastolic_imp_centile_above_", 
           centile_threshold,
           "th_0")

cat("Original patient data under five years number and proportion of diastolic over threshold:\n")
cat(paste0("Number / total (%) = ",
             round(
  sum(bp_data_under_five[,threshold_column_name][[1]], na.rm=T),
                   digits=visit_decimal_places),
  " / ",
  sum(!is.na(bp_data_under_five[,threshold_column_name][[1]])),
  " (",
  round(
  100 * 
  sum(bp_data_under_five[,threshold_column_name][[1]], na.rm=T) /
    sum(!is.na(bp_data_under_five[,threshold_column_name][[1]])),
  digits=proportion_decimal_places),
  "%)"
))

cat(
  "  \n\n  "
)

cat("we then take the means of the number and proportions above the threshold across imputed datasets to present the summary statistics for imputed values of visits under five years with diastolic hypertension:\n\n")
cat(paste0("Imputed data number and proportion of diastolic visit data over threshold:\n",
           "Number / total (%) = ",
             round(
  mean(number_above_centile_threshold_diastolic_for_each_imputation[[1]]), 
  digits=visit_decimal_places),
  " / ",
  mean(number_with_centile_threshold_diastolic_for_each_imputation[[1]]),
  " (",
  round(
    100 * 
  mean(proportion_above_diastolic_threshold_for_each_imputation[[1]]),
  digits=proportion_decimal_places),
  "%)"
))
```

```{r, reporting proportion diastolic above threshold in male patients under five}
#define decimal places as zero for this one as we're reporting numbers of visits:
visit_decimal_places <- 0
proportion_decimal_places <- 1

cat("This is a reminder of our centile threshold for hypertension, which is defined at the top of the file:\n")
centile_threshold

cat(
  "  \n\n  "
  )

number_with_centile_threshold_diastolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_diastolic_for_each_imputation = NULL)

number_above_centile_threshold_diastolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_diastolic_for_each_imputation = NULL)

proportion_above_diastolic_threshold_for_each_imputation <- 
  data.frame(proportion_above_diastolic_threshold_for_each_imputation = NULL)

#loop through imputations, calculating number above threshold and proportion above threshold each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("diastolic_imp_centile_above_", 
           centile_threshold,
           "th_",
           imputation_number)

  number_above_threshold_of_this_imputation <- 
    sum(bp_data_under_five_male[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_five_male[,column_name][[1]]))

  proportion_above_threshold_of_this_imputation <- 
    number_above_threshold_of_this_imputation / n_of_this_imputation

  #take the number above threshold and proportion above threshold and bind it to a frame outside the loop
  number_with_centile_threshold_diastolic_for_each_imputation <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(number_with_centile_threshold_diastolic_for_each_imputation,
          n_of_this_imputation)

  number_above_centile_threshold_diastolic_for_each_imputation <-
    rbind(number_above_centile_threshold_diastolic_for_each_imputation,
          number_above_threshold_of_this_imputation)

  proportion_above_diastolic_threshold_for_each_imputation <-
    rbind(proportion_above_diastolic_threshold_for_each_imputation,
          proportion_above_threshold_of_this_imputation)
  
}

#to report patient data, we can create the column name with our threshold and use the zero imputation
threshold_column_name <-
  paste0("diastolic_imp_centile_above_", 
           centile_threshold,
           "th_0")

cat("Original male patient data under five years number and proportion of diastolic over threshold:\n")
cat(paste0("Number / total (%) = ",
             round(
  sum(bp_data_under_five_male[,threshold_column_name][[1]], na.rm=T),
                   digits=visit_decimal_places),
  " / ",
  sum(!is.na(bp_data_under_five_male[,threshold_column_name][[1]])),
  " (",
  round(
  100 * 
  sum(bp_data_under_five_male[,threshold_column_name][[1]], na.rm=T) /
    sum(!is.na(bp_data_under_five_male[,threshold_column_name][[1]])),
  digits=proportion_decimal_places),
  "%)"
))

cat(
  "  \n\n  "
)

cat("we then take the means of the number and proportions above the threshold across imputed datasets to present the summary statistics for imputed values of visits under five years with diastolic hypertension:\n\n")
cat(paste0("Imputed male data number and proportion of diastolic visit data over threshold:\n",
           "Number / total (%) = ",
             round(
  mean(number_above_centile_threshold_diastolic_for_each_imputation[[1]]), 
  digits=visit_decimal_places),
  " / ",
  mean(number_with_centile_threshold_diastolic_for_each_imputation[[1]]),
  " (",
  round(
    100 * 
  mean(proportion_above_diastolic_threshold_for_each_imputation[[1]]),
  digits=proportion_decimal_places),
  "%)"
))
```

```{r, reporting proportion diastolic above threshold in fema patients under five}
#define decimal places as zero for this one as we're reporting numbers of visits:
visit_decimal_places <- 0
proportion_decimal_places <- 1

cat("This is a reminder of our centile threshold for hypertension, which is defined at the top of the file:\n")
centile_threshold

cat(
  "  \n\n  "
  )

number_with_centile_threshold_diastolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_diastolic_for_each_imputation = NULL)

number_above_centile_threshold_diastolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_diastolic_for_each_imputation = NULL)

proportion_above_diastolic_threshold_for_each_imputation <- 
  data.frame(proportion_above_diastolic_threshold_for_each_imputation = NULL)

#loop through imputations, calculating number above threshold and proportion above threshold each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("diastolic_imp_centile_above_", 
           centile_threshold,
           "th_",
           imputation_number)

  number_above_threshold_of_this_imputation <- 
    sum(bp_data_under_five_fema[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_under_five_fema[,column_name][[1]]))

  proportion_above_threshold_of_this_imputation <- 
    number_above_threshold_of_this_imputation / n_of_this_imputation

  #take the number above threshold and proportion above threshold and bind it to a frame outside the loop
  number_with_centile_threshold_diastolic_for_each_imputation <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(number_with_centile_threshold_diastolic_for_each_imputation,
          n_of_this_imputation)

  number_above_centile_threshold_diastolic_for_each_imputation <-
    rbind(number_above_centile_threshold_diastolic_for_each_imputation,
          number_above_threshold_of_this_imputation)

  proportion_above_diastolic_threshold_for_each_imputation <-
    rbind(proportion_above_diastolic_threshold_for_each_imputation,
          proportion_above_threshold_of_this_imputation)
  
}

#to report patient data, we can create the column name with our threshold and use the zero imputation
threshold_column_name <-
  paste0("diastolic_imp_centile_above_", 
           centile_threshold,
           "th_0")

cat("Original fema patient data under five years number and proportion of diastolic over threshold:\n")
cat(paste0("Number / total (%) = ",
             round(
  sum(bp_data_under_five_fema[,threshold_column_name][[1]], na.rm=T),
                   digits=visit_decimal_places),
  " / ",
  sum(!is.na(bp_data_under_five_fema[,threshold_column_name][[1]])),
  " (",
  round(
  100 * 
  sum(bp_data_under_five_fema[,threshold_column_name][[1]], na.rm=T) /
    sum(!is.na(bp_data_under_five_fema[,threshold_column_name][[1]])),
  digits=proportion_decimal_places),
  "%)"
))

cat(
  "  \n\n  "
)

cat("we then take the means of the number and proportions above the threshold across imputed datasets to present the summary statistics for imputed values of visits under five years with diastolic hypertension:\n\n")
cat(paste0("Imputed fema data number and proportion of diastolic visit data over threshold:\n",
           "Number / total (%) = ",
             round(
  mean(number_above_centile_threshold_diastolic_for_each_imputation[[1]]), 
  digits=visit_decimal_places),
  " / ",
  mean(number_with_centile_threshold_diastolic_for_each_imputation[[1]]),
  " (",
  round(
    100 * 
  mean(proportion_above_diastolic_threshold_for_each_imputation[[1]]),
  digits=proportion_decimal_places),
  "%)"
))
```

```{r, reporting proportion diastolic above threshold in all patients five to twenty}
#define decimal places as zero for this one as we're reporting numbers of visits:
visit_decimal_places <- 0
proportion_decimal_places <- 1

cat("This is a reminder of our centile threshold for hypertension, which is defined at the top of the file:\n")
centile_threshold

cat(
  "  \n\n  "
  )

number_with_centile_threshold_diastolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_diastolic_for_each_imputation = NULL)

number_above_centile_threshold_diastolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_diastolic_for_each_imputation = NULL)

proportion_above_diastolic_threshold_for_each_imputation <- 
  data.frame(proportion_above_diastolic_threshold_for_each_imputation = NULL)

#loop through imputations, calculating number above threshold and proportion above threshold each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("diastolic_imp_centile_above_", 
           centile_threshold,
           "th_",
           imputation_number)

  number_above_threshold_of_this_imputation <- 
    sum(bp_data_five_to_twenty[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_five_to_twenty[,column_name][[1]]))

  proportion_above_threshold_of_this_imputation <- 
    number_above_threshold_of_this_imputation / n_of_this_imputation

  #take the number above threshold and proportion above threshold and bind it to a frame outside the loop
  number_with_centile_threshold_diastolic_for_each_imputation <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(number_with_centile_threshold_diastolic_for_each_imputation,
          n_of_this_imputation)

  number_above_centile_threshold_diastolic_for_each_imputation <-
    rbind(number_above_centile_threshold_diastolic_for_each_imputation,
          number_above_threshold_of_this_imputation)

  proportion_above_diastolic_threshold_for_each_imputation <-
    rbind(proportion_above_diastolic_threshold_for_each_imputation,
          proportion_above_threshold_of_this_imputation)
  
}

#to report patient data, we can create the column name with our threshold and use the zero imputation
threshold_column_name <-
  paste0("diastolic_imp_centile_above_", 
           centile_threshold,
           "th_0")

cat("Original patient data five to twenty years number and proportion of diastolic over threshold:\n")
cat(paste0("Number / total (%) = ",
             round(
  sum(bp_data_five_to_twenty[,threshold_column_name][[1]], na.rm=T),
                   digits=visit_decimal_places),
  " / ",
  sum(!is.na(bp_data_five_to_twenty[,threshold_column_name][[1]])),
  " (",
  round(
  100 * 
  sum(bp_data_five_to_twenty[,threshold_column_name][[1]], na.rm=T) /
    sum(!is.na(bp_data_five_to_twenty[,threshold_column_name][[1]])),
  digits=proportion_decimal_places),
  "%)"
))

cat(
  "  \n\n  "
)

cat("we then take the means of the number and proportions above the threshold across imputed datasets to present the summary statistics for imputed values of visits five to twenty years with diastolic hypertension:\n\n")
cat(paste0("Imputed data number and proportion of diastolic visit data over threshold:\n",
           "Number / total (%) = ",
             round(
  mean(number_above_centile_threshold_diastolic_for_each_imputation[[1]]), 
  digits=visit_decimal_places),
  " / ",
  mean(number_with_centile_threshold_diastolic_for_each_imputation[[1]]),
  " (",
  round(
    100 * 
  mean(proportion_above_diastolic_threshold_for_each_imputation[[1]]),
  digits=proportion_decimal_places),
  "%)"
))
```

```{r, reporting proportion diastolic above threshold in male patients five to twenty}
#define decimal places as zero for this one as we're reporting numbers of visits:
visit_decimal_places <- 0
proportion_decimal_places <- 1

cat("This is a reminder of our centile threshold for hypertension, which is defined at the top of the file:\n")
centile_threshold

cat(
  "  \n\n  "
  )

number_with_centile_threshold_diastolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_diastolic_for_each_imputation = NULL)

number_above_centile_threshold_diastolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_diastolic_for_each_imputation = NULL)

proportion_above_diastolic_threshold_for_each_imputation <- 
  data.frame(proportion_above_diastolic_threshold_for_each_imputation = NULL)

#loop through imputations, calculating number above threshold and proportion above threshold each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("diastolic_imp_centile_above_", 
           centile_threshold,
           "th_",
           imputation_number)

  number_above_threshold_of_this_imputation <- 
    sum(bp_data_five_to_twenty_male[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_five_to_twenty_male[,column_name][[1]]))

  proportion_above_threshold_of_this_imputation <- 
    number_above_threshold_of_this_imputation / n_of_this_imputation

  #take the number above threshold and proportion above threshold and bind it to a frame outside the loop
  number_with_centile_threshold_diastolic_for_each_imputation <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(number_with_centile_threshold_diastolic_for_each_imputation,
          n_of_this_imputation)

  number_above_centile_threshold_diastolic_for_each_imputation <-
    rbind(number_above_centile_threshold_diastolic_for_each_imputation,
          number_above_threshold_of_this_imputation)

  proportion_above_diastolic_threshold_for_each_imputation <-
    rbind(proportion_above_diastolic_threshold_for_each_imputation,
          proportion_above_threshold_of_this_imputation)
  
}

#to report patient data, we can create the column name with our threshold and use the zero imputation
threshold_column_name <-
  paste0("diastolic_imp_centile_above_", 
           centile_threshold,
           "th_0")

cat("Original male patient data five to twenty years number and proportion of diastolic over threshold:\n")
cat(paste0("Number / total (%) = ",
             round(
  sum(bp_data_five_to_twenty_male[,threshold_column_name][[1]], na.rm=T),
                   digits=visit_decimal_places),
  " / ",
  sum(!is.na(bp_data_five_to_twenty_male[,threshold_column_name][[1]])),
  " (",
  round(
  100 * 
  sum(bp_data_five_to_twenty_male[,threshold_column_name][[1]], na.rm=T) /
    sum(!is.na(bp_data_five_to_twenty_male[,threshold_column_name][[1]])),
  digits=proportion_decimal_places),
  "%)"
))

cat(
  "  \n\n  "
)

cat("we then take the means of the number and proportions above the threshold across imputed datasets to present the summary statistics for imputed values of visits five to twenty years with diastolic hypertension:\n\n")
cat(paste0("Imputed male data number and proportion of diastolic visit data over threshold:\n",
           "Number / total (%) = ",
             round(
  mean(number_above_centile_threshold_diastolic_for_each_imputation[[1]]), 
  digits=visit_decimal_places),
  " / ",
  mean(number_with_centile_threshold_diastolic_for_each_imputation[[1]]),
  " (",
  round(
    100 * 
  mean(proportion_above_diastolic_threshold_for_each_imputation[[1]]),
  digits=proportion_decimal_places),
  "%)"
))
```

```{r, reporting proportion diastolic above threshold in fema patients five to twenty}
#define decimal places as zero for this one as we're reporting numbers of visits:
visit_decimal_places <- 0
proportion_decimal_places <- 1

cat("This is a reminder of our centile threshold for hypertension, which is defined at the top of the file:\n")
centile_threshold

cat(
  "  \n\n  "
  )

number_with_centile_threshold_diastolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_diastolic_for_each_imputation = NULL)

number_above_centile_threshold_diastolic_for_each_imputation <-
  data.frame(number_above_centile_threshold_diastolic_for_each_imputation = NULL)

proportion_above_diastolic_threshold_for_each_imputation <- 
  data.frame(proportion_above_diastolic_threshold_for_each_imputation = NULL)

#loop through imputations, calculating number above threshold and proportion above threshold each time
for (imputation_number in 1:number_of_imputations){

  column_name <- 
    paste0("diastolic_imp_centile_above_", 
           centile_threshold,
           "th_",
           imputation_number)

  number_above_threshold_of_this_imputation <- 
    sum(bp_data_five_to_twenty_fema[,column_name][[1]], na.rm=T)
  
  n_of_this_imputation <-
    sum(!is.na(bp_data_five_to_twenty_fema[,column_name][[1]]))

  proportion_above_threshold_of_this_imputation <- 
    number_above_threshold_of_this_imputation / n_of_this_imputation

  #take the number above threshold and proportion above threshold and bind it to a frame outside the loop
  number_with_centile_threshold_diastolic_for_each_imputation <- #note that this is just a double check, our imputation sets should all be the same length
    rbind(number_with_centile_threshold_diastolic_for_each_imputation,
          n_of_this_imputation)

  number_above_centile_threshold_diastolic_for_each_imputation <-
    rbind(number_above_centile_threshold_diastolic_for_each_imputation,
          number_above_threshold_of_this_imputation)

  proportion_above_diastolic_threshold_for_each_imputation <-
    rbind(proportion_above_diastolic_threshold_for_each_imputation,
          proportion_above_threshold_of_this_imputation)
  
}

#to report patient data, we can create the column name with our threshold and use the zero imputation
threshold_column_name <-
  paste0("diastolic_imp_centile_above_", 
           centile_threshold,
           "th_0")

cat("Original fema patient data five to twenty years number and proportion of diastolic over threshold:\n")
cat(paste0("Number / total (%) = ",
             round(
  sum(bp_data_five_to_twenty_fema[,threshold_column_name][[1]], na.rm=T),
                   digits=visit_decimal_places),
  " / ",
  sum(!is.na(bp_data_five_to_twenty_fema[,threshold_column_name][[1]])),
  " (",
  round(
  100 * 
  sum(bp_data_five_to_twenty_fema[,threshold_column_name][[1]], na.rm=T) /
    sum(!is.na(bp_data_five_to_twenty_fema[,threshold_column_name][[1]])),
  digits=proportion_decimal_places),
  "%)"
))

cat(
  "  \n\n  "
)

cat("we then take the means of the number and proportions above the threshold across imputed datasets to present the summary statistics for imputed values of visits five to twenty years with diastolic hypertension:\n\n")
cat(paste0("Imputed fema data number and proportion of diastolic visit data over threshold:\n",
           "Number / total (%) = ",
             round(
  mean(number_above_centile_threshold_diastolic_for_each_imputation[[1]]), 
  digits=visit_decimal_places),
  " / ",
  mean(number_with_centile_threshold_diastolic_for_each_imputation[[1]]),
  " (",
  round(
    100 * 
  mean(proportion_above_diastolic_threshold_for_each_imputation[[1]]),
  digits=proportion_decimal_places),
  "%)"
))
```






```{r, end of file so save all the listed dataframes into the parent directory}
rm(number_of_imputations) #we only want to save this once and load it once
rm(bp_data_under_five) #remove under five as we are not going to model those separately, we are going to subset after we model everyone under twenty. This frame was only created here for the purposes of summary statistics, but must be recreated later to get the LMS centiles within it
rm(bp_data_five_to_twenty)

save_bp_files_function(
  parent_directory=location_of_data_files,
  parent_file="file_23")
```
